\chapter{Theory}
\label{ch:theory}

\section{Mathematical Preliminaries}

The aim of the present section is, in first place, to provide a unified
treatment of major ideas and theorems which form the foundation of the study
of electromagnetic ware propagation in half-space environments and
multilayered media.
Secondly, important consequences for the topic at hand---namely the computation
of highly accurate reference results and the aspired combination of the \ac{FMM}
with the Sommerfeld problem's solution domain---are pointed out.

\subsection{Notation}

If not specifically marked, the notation in the present thesis follows the
textbook by \textcite{vanBladel2007}.
In particular, vectors in $\R^3$ which possess a physical meaning are denoted in
bold and italic serif font, \eg, the position vector $\pvec{r}$.
Source points are marked by a prime, observation points are unprimed.

Entities with reference to linear algebra, \ie, matrices and vectors are denoted
in bold, italic and sans-serif font. Matrices, \eg, $\mat{A}$, are distinguished
from column vectors, \eg, $\vec{v}$, by the use of upper and lower case symbols,
respectively.

The notation of special functions and related symbols is in accordance to the
NIST Handbook of Mathematical Functions \cite{Olver2010}.





\subsection{Basic Definitions and Terms}

The following discussions will deal with vectors in various forms therefore
it is adequate to be precise about
\begin{definition}[Vector space {\cite[p.~73]{heuser2006}}]
	Let $\F$ be a field (in particular $\F = \R,\C$). A \emph{vector space
	over} $\F$ (or $\F$-vector space) is a nonempty set $\mathcal{V}$, whose
	elements are called \emph{vectors} and in which the following two operations
	are defined:
	\begin{enumerate}
		\item Addition: To every pair of vectors $x, y \in \mathcal{V}$ there
		corresponds a vector $x + y$, in a way such that
		\begin{enumerate}[label=(\alph*)]
			\item $x + y = y + x$
			\item $x + \left(y + z\right) = \left(x + y\right) + z$
			\item $\mathcal{V}$ contains a unique \emph{zero vector} $0$ such
			that $x + 0 = x \forall x \in \mathcal{V}$
			\item To each $x \in \mathcal{V}$ there exists a unique
			$-x \in \mathcal{V}$ such that $x + \left(-x\right) = 0$
		\end{enumerate}
		\item Scalar multiplication: To every pair $(a, x)$ of a scalar
		$\alpha \in \F$ and a vector $x \in \mathcal{V}$ there corresponds a
		vector $\alpha x \in \mathcal{V}$, in such a way that
		\begin{enumerate}[label=(\alph*), start = 5]
			\item $\alpha \left(\beta\right) = \left(\alpha \beta\right) x$ for
			all $\beta \in \F$ 
			\item $1 x = x$
		\end{enumerate}
		These operations satisfy the distributive laws
		\begin{enumerate}[label=(\alph*), start = 7]
			\item $\alpha \left(x + y\right) = \alpha x + \alpha y$
			\item $\left(\alpha + \beta\right) x = \alpha x + \beta x$.
		\end{enumerate}
	\end{enumerate}
\end{definition}

In the geometrical context we have to express vectors by means of coordinates
and basis vectors in order to perform actual computations.
The definition of the three major orthonormal coordinate systems in which a
vector $\pvec{r} \in \R^3$ can be represented shall be based on 
\begin{definition}[Cartesian coordinate system]
	Let $\pvec{r}$ be an arbitrary vector in $\R$ and let that the
	basis vectors $\left\{\uv{x}, \uv{y}, \uv{z}\right\}$ be orthonormal and
	constant for all $\pvec{r} \in \R^3$.
	Then the representation of $\pvec{r}$ in the \emph{Cartesian coordinate
	system} is given by
	\begin{equation}
		\pvec{r} = \uv{x}x + \uv{y}y + \uv{z},
	\end{equation}
\end{definition}
The representation of a vector $\pvec{r} \in \R^3$ in Cartesian coordinates
relates to the common curvilinear systems according to the following two
definition.
\begin{definition}[Cylindrical coordinate system]
	\label{def:cyl_coords}
	Let a vector in $\R^3$ be given in Cartesian coordinates and unit vectors
	by $\uv{x}x + \uv{y}y + \uv{z}z$.
	The \emph{cylindrical coordinate system} is defined by 
	\begin{subequations}
		\begin{align}
			&x = \rho \cos \varphi
			\qquad
			&&\uv{x} = \uv{\rho} \cos \varphi - \uv{\varphi}\sin \varphi \\
			&y = \rho \sin \varphi 
			\qquad
			&&\uv{y} = \uv{\rho} \sin \varphi + \uv{\varphi} \cos \varphi\\
			&z = z 
			\qquad
			&&\uv{z} = \uv{z} 
		\end{align}
	\end{subequations}
	and
	\begin{subequations}
		\begin{align}
			&\rho = \sqrt{x^2 + y^2}
			\qquad
			&& \uv{\rho} = \uv{x} \cos \varphi + \uv{y} \sin \varphi \\
			&\varphi = \arctan \frac{y}{x}
			\qquad
			&&\uv{\varphi} = -\uv{x} \sin \varphi + \uv{y} \cos \varphi \\
			&z = z
			\qquad
			&&\uv{z} = \uv{z} \, .
		\end{align}
	\end{subequations}
\end{definition}

\begin{definition}[Spherical coordinate system]
	\label{def:sph_coords}
	Let a vector in $\R^3$ be given in Cartesian coordinates and unit vectors
	by $\uv{x}x + \uv{y}y + \uv{z}z$.
	The \emph{spherical coordinate system} is defined by 
	\begin{subequations}
		\begin{align}
			&x = r \sin \left(\vartheta\right) \cos \varphi
			\qquad
			&&\uv{x} = \uv{r} \sin\left(\vartheta\right) \cos \varphi +
			\uv{\vartheta} \cos\left(\vartheta\right) \cos \varphi -
			\uv{\varphi} \sin \varphi \\
			&y = r \sin \left(\vartheta\right) \sin \varphi
			\qquad
			&&\uv{y} = \uv{r} \sin\left(\vartheta\right) \sin \varphi +
			\uv{\vartheta} \cos\left(\vartheta\right) \sin \varphi +
			\uv{\varphi} \cos \varphi \\
			&z = r \cos \vartheta
			\qquad
			&&\uv{z} = \uv{r} \cos \vartheta - \uv{\vartheta} \sin \vartheta
		\end{align}
	\end{subequations}
	and
	\begin{subequations}
		\begin{align}
			&r = \sqrt{x^2 + y^2 + z^2}
			\qquad
			&&\uv{r} =
			\uv{x} \sin \left(\vartheta\right) \cos \varphi +
			\uv{y} \sin \left(\vartheta\right) \sin \varphi +
			\uv{z} \cos \vartheta \\
			&\vartheta = \arctan \frac{\sqrt{x^2 + y^2}}{z}
			\qquad
			&&\uv{\vartheta} = 
			\uv{x} \cos \left(\vartheta\right) \cos \varphi +
			\uv{y} \cos \left(\vartheta\right) \sin \varphi -
			\uv{z} \sin \vartheta \\
			&\varphi = \arctan \frac{y}{x}
			\qquad
			&&\uv{\varphi} = 
			-\uv{x} \sin \varphi +
			\uv{y} \cos \varphi \, .
		\end{align}
	\end{subequations}
\end{definition}

The notion of a \emph{distance} is familiar in Euclidean geometry,
\ie, in $\R2$ and
$\R3$.
As the term must be extended to complex space in the following, it shall be
pointed out that the usual concept of distance relies on
\begin{definition}[Metric and metric space]\label{def:metric}
	Let $\mathcal{X}$ be a set. A non-negative function
	$d: \mathcal{X} \times \mathcal{X} \mapsto \R$ is called a \emph{metric}
	on $\mathcal{X}$ if it fulfills the following four properties.
	\begin{enumerate}[label=(\alph*)]
		\item $0 \le d\left(x_1, x_2\right) < 0$ for all
		$x_1, x_2 \in \mathcal{X}$
		\item $d\left(x_1, x_2\right) = 0$ if and only if $x_1 = x_2$
		\item $d\left(x_1, x_2\right) = d\left(x_2, x_1\right)$ for all
		$x_1, x_2 \in \mathcal{X}$
		\item $d\left(x_1, x_3\right) \le d\left(x_1, x_2\right) + d\left(x_2, x_3\right)$
		for all $x_1, x_2, x_3 \in \mathcal{X}$
	\end{enumerate}
	A set $\mathcal{X}$ together with a metric $d$ defined on $\mathcal{X}$ is
	called a \emph{metric space} and denoted by $\left(\mathcal{X}, d\right)$.
\end{definition}

From a geometrical point of view the term distance is closely related to
\emph{length}.
Usual axioms regarding length are that a length should be real and non-negative.
These perceptions are predicated on
\begin{definition}[Norm and normed space]\label{def:norm}
	Let $\mathcal{V}$ be a $\F$-vector space.
	A non-negative real-valued functional $x \mapsto \left\Vert x \right\Vert$
	from $\mathcal{V}$ into $\R$ is called a \emph{norm} if
	\begin{enumerate}[label=(\alph*)]
		\item $\norm{x} = 0 \Leftrightarrow x = 0$ 
		\item $\norm{\alpha x} = \abs{\alpha} \norm{x}$ for every
		$x \in \mathcal{V}$ and $\alpha \in \F$
		\item $\norm{x_1 + x_2} \le \norm{x_1} + \norm{x_2}$ for every
		$x_1, x_2 \in \mathcal{V}$.
	\end{enumerate}
	A $\F$-vector space $\mathcal{V}$ together with a norm
	$\left\Vert . \right\Vert$ is called a \emph{normed space} and denoted by
	$\left( \mathcal{V}, \left\Vert . \right\Vert \right)$.
\end{definition}

As it is well known \cite{heuser2006}, vector spaces obtain a set of
mathematically advantageous properties if a metric and a norm can be defined on
them.
The essentially beneficial properties of a Hilbert space become available if,
in addition, an inner product can be defined.
A valid inner product for the Euclidean space is given by
\begin{definition}[Dot product]\label{def:dot_product}
	Let $\C^N$ be a finite-dimensional vector space and
	$\pvec{a}, \pvec{b} \in \C^N$.
	Assume that the coordinates of $\pvec{a}$ and $\pvec{b}$ are given in
	the Cartesian representation.
	Then the \emph{dot product}
	is defined as 
	\begin{equation}
		\pvec{a} \cdot \pvec{b} = \sum\limits_{n = 1}^{N} a_n \bar{b}_n \, ,
	\end{equation}
	where $\bar{b}_n$ denotes the complex conjugate of $b$.
\end{definition}

With \cref{def:dot_product} we also obtain a way to actually compute length
and distance according to the following two definitions.
\begin{definition}[Euclidean norm]\label{def:euclidean_norm}
	Let $\pvec{r} \in \C^3$ arbitrary. Then the \emph{Euclidean norm} of
	$\pvec{r}$ is defined as
	\begin{equation}
		r = \euclideanNorm{\pvec{r}} = \sqrt{\pvec{r} \cdot \pvec{r}} \, .
	\end{equation}
\end{definition}

\begin{definition}[Euclidean metric]\label{def:euclidean_metric}
	Let $\pvec{r}_1, \pvec{r}_2 \in \C^3$ arbitrary. Then the \emph{Euclidean
	metric} is defined as
	\begin{equation}
		d_E\left(\pvec{r}_1 , \pvec{r}_2\right) = 
		\sqrt{
			\left(\pvec{r}_1 - \pvec{r}_2\right)
			\cdot
			\left(\pvec{r}_1 - \pvec{r}_2\right)
		} \, .
	\end{equation}
\end{definition}

\begin{remark}[Euclidean norm notation]
	For the sake of simplicity in notation, and to be in accordance with
	common practice \cite{vanBladel2007}, $\euclideanNorm{\robs}$ is
	denoted as $\pvec \equiv \abs{\robs} \equiv \euclideanNorm{\robs}$
	whenever the length of a physical vector is meant
	and no other notation is clear from the context.
\end{remark}







\subsection{Fourier Transforms}

Although large portions of the study of electromagnetism heavily rely on the
decomposition of functions into---as well as on the composition of functions
from---spectra of different frequencies, no specific definition of the Fourier
transform prevails throughout the field.
For the ubiquitous Fourier transform with respect to time the present thesis
uses
\begin{definition}[Fourier transform with respect to time]
	\label{def:fourier_transfrom_temporal_forward}
	Let $f \in L^1\left( \R \right)$ be a function of a variable $t \in \R$
	which shall be called \emph{time}.
	Then the \emph{Fourier transform with respect to time} of $f$ is defined as 
	\begin{equation}\label{eq:fourier_transfrom_temporal_forward}
		\tilde{f} \left(\omega\right) = 
		\left( \fourierTransformTemporal f \right) \left(\omega\right) = 
		\tilde{f} \left( \omega \right) =
		\int\limits_{-\infty}^{\infty} \dd t \,
		\exp{-\im \omega t} 
		f\left( t \right)
		\qquad \omega \in \R
		\, ,
	\end{equation}
	where $\omega$ is a parameter called \emph{angular frequency}.
\end{definition}
Provided a transformed function possesses certain well-known properties
\cite{heuser2006, strichartz2003}, an inverse transform to
\eqref{eq:fourier_transfrom_temporal_forward} exists.
With \cref{def:fourier_transfrom_temporal_forward}  this inverse operation is
given by
\begin{lemma}[Inverse Fourier tansform with respect to time]
	Let $f \in L^1 \left(\R\right)$ such that
	$\tilde{f} \in L^1 \left(\R\right)$. Then the
	inverse Fourier transform with respect to time is given by
	\begin{equation}\label{eq:fourier_transform_temporal_backward}
		f \left(t\right) =
		\left( \fourierTransformTemporalInverse \tilde{f} \right)
		\left( t \right) = 
		\frac{1}{2\pi}
		\int\limits_{-\infty}^{\infty} \dd \omega \,
		\exp{\im \omega t} 
		\tilde{f} \left( \omega \right)
		\qquad t \in \R
		\, .
	\end{equation}
\end{lemma}

\begin{remark}[Time convention]\label{rem:time_convention}
	If the pair of transforms formed by
	\eqref{eq:fourier_transfrom_temporal_forward} and
	\eqref{eq:fourier_transform_temporal_backward} is applied to \acp{ODE}
	or \acp{PDE} containing a differentiation with respect to time, then
	\cref{def:fourier_transfrom_temporal_forward} is equivalent to the
	assumption a time dependency $\propto\exp{\im \omega t}$ for all
	functions of time in $\omega$-spectral domain\footnote{Within the course of
	the present thesis expressions taken from the literature are adapted to the
	$\exp{\im \omega t}$ convention. Some of these, \eg, the work of
	Sommerfeld, originally use the alternative $\exp{-\mathrm{i} \omega t}$
	time convention.
	The conversion to $\exp{\im \omega t}$ is done by the formal substitution
	$\mathrm{i} \to -\im$. In addition, the kinds of Hankel functions, \ie,
	of propagating cylindrical or spherical waves, must be changed.}.
\end{remark}

Formally, the extension of the concept of Fourier transforms to higher
dimensions is straightforward, as the scalars $t$ and $\omega$ simply become
vectors and their product is replaced by the dot product.
However, one has to take into account some physical reasoning in order to
combine the Fourier transform in with respect to time with corresponding spatial
transforms.
Namely, the spatial counterpart to
\cref{def:fourier_transfrom_temporal_forward} must be defined in the particular
way of
\begin{definition}[Fourier transform with respect to space]
	\label{def:fourier_transfrom_spatial_forward}
	Let $f: \R^3 \mapsto \C$ be a function of a variable $\pvec{r} \in \R^3$
	which shall be called \emph{position} and assume $\pvec{k} \in \C^3$.
	The \emph{Fourier transform with respect to space} is defined as
	\begin{equation}\label{eq:fourier_transform_3space_forward}
		\tilde{f} \left( \pvec{k} \right) = 
		\left( \fourierTransformSpatial f \right) \left( \pvec{k} \right) = 
		\iiint\limits_{\R^3} \dd \pvec{r} \,
		\exp{\im \pvec{k} \cdot \pvec{r}}
		f \left( \pvec{r} \right) \, ,
	\end{equation}
	where $\pvec{k}$ is called \emph{wavevector} and
	$k = \euclideanNorm{\pvec{k}}$ is called \emph{wavenumber}.
\end{definition}
The inverse transform to \eqref{eq:fourier_transform_3space_forward} becomes
\begin{equation}\label{eq:fourier_transform_3space_backward}
	f \left( \pvec{r} \right) = 
	\left( \fourierTransformSpatialInverse \tilde{f} \right) \left(\pvec{r}\right) = 
	\frac{1}{\left( 2\pi \right)^3}
	\iiint\limits_{\R^3} \dd \pvec{k} \,
	\exp{-\im \pvec{k} \cdot \pvec{r}}
	\tilde{f} \left( \pvec{k} \right) \, .
\end{equation}
Based on \cref{def:fourier_transfrom_temporal_forward} and
\cref{def:fourier_transfrom_spatial_forward} the combined four-dimensional pair
of transforms
\begin{equation}\label{eq:fourier_transform_4d_forward}
	\tilde{f} \left( \pvec{k}, \omega \right) = 
	\iiint\limits_{\R^3} \dd \robs
	\int\limits_{-\infty}^{\infty} \dd t \,
	\exp{\im \left( \pvec{k} \cdot \robs - \omega t \right)}
	f \left( \robs, t \right)
\end{equation}
and
\begin{equation}\label{eq:fourier_transform_4d_inverse}
	f \left( \robs, t \right) = 
	\frac{1}{\left(2\pi\right)^4}
	\iiint\limits_{\R^3} \dd \pvec{k}
	\int\limits_{-\infty}^{\infty} \dd \omega \,
	\exp{-\im \left( \pvec{k} \cdot \robs - \omega t \right)}
	\tilde{f} \left( \pvec{k}, \omega \right)
\end{equation}
can be constructed.
Note that the sense of rotation of the kernel phasors is opposing in the
temporal and the spatial parts.

A physical interpretation of \eqref{eq:fourier_transform_4d_inverse} is,
that an arbitrary field $f \left( \robs, t \right)$ can be decomposed 
into an infinite number of \emph{plane waves}---expressed by the
$\exp{-\im \left( \pvec{k} \cdot \robs - \omega t \right)}$ terms---where
the expansion coefficients are given by \eqref{eq:fourier_transform_4d_forward}.
Each one of these individual plane waves solves
the homogeneous scalar wave equation \cite[p.~32]{Sommerfeld1964}
\begin{equation}\label{eq:scalar_wave_equation_physical_domain}
	\left( \laplace - \frac{1}{c^2} \frac{\partial^2}{\partial t^2} \right)	
	\phi \left( \pvec{r}, t \right) = 0
\end{equation}
in the \enquote{physical} $\left(\pvec{r}, t\right)$-domain, where $c$ ist
the velocity of propagation.
However, if the same phasor convention of
\cref{def:fourier_transfrom_temporal_forward} would also be used in
\cref{def:fourier_transfrom_spatial_forward}, the kernel
$\exp{-\im \left( \pvec{k} \cdot \robs + \omega t \right)}$
of the resulting 4D inverse transform satisfies
\eqref{eq:scalar_wave_equation_physical_domain} as well.
The reason why the phasor convention of
\cref{def:fourier_transfrom_spatial_forward} is the physically reasonable choice
under the $\exp{\im \omega t}$ time convention
can be seen if we assume $\pvec{r} = \uv{x} x$ and $\pvec{k} = \uv{x} k_x$
with $x, k_x \in \R$ and $k_x > 0$, \ie, a lossless right-handed medium.
Then $\exp{-\im \left( \pvec{k} \cdot \robs - \omega t \right)}$ describes
a plane wave whose wave fronts propagate \emph{forward}, \ie, in positive
$x$-direction, as time evolves.
In contrast,
$\exp{-\im \left( \pvec{k} \cdot \robs + \omega t \right)}$
propagates in \emph{backwards}.
Even though a plane wave is not a physical entity in the sense that it carries
an infinite amount of energy, it is physically reasonable that it should
travel forward as time marches on.
Therefore, \cref{def:fourier_transfrom_temporal_forward} and
\cref{def:fourier_transfrom_spatial_forward} constitute a matching pair.

A deeper motivation for the interaction of
\cref{def:fourier_transfrom_temporal_forward} and 
\cref{def:fourier_transfrom_spatial_forward} can be drawn from special
relativity.
It turns out that opposing choices of phasor conventions in
\cref{def:fourier_transfrom_temporal_forward} and
\cref{def:fourier_transfrom_spatial_forward}, respectively, lead to the two
meaningful sign conventions of the metric tensor\footnote{
	$\left( + + + - \right)$ for $\exp{-\mathrm{i} \omega t}$
	and $\left( - - - + \right)$ for $\exp{\im \omega t}$}
describing the structure of the four-dimensional (Minkowski) space-time
continuum \cite[pp.~624]{Jackson2013}\cite{Kaiser2016}.







\subsection{Hankel Transform}

Planar Fourier-type expansion integrals play a predominant role in the study
of wave fields in solution domains with are inhomogeneous only in one
Cartesian direction.
Assume this direction to be the one of $\uv{z}$.
By this choice the expansion plane becomes the plane $z \equiv 0$ of the
Cartesian coordinate system.
Under these assumptions \eqref{eq:fourier_transform_3space_forward}
and \eqref{eq:fourier_transform_3space_backward} reduce to the pair
\begin{equation}\label{eq:fourier_transform_2space_forward}
	\tilde{f} \left(k_\rho, k_\varphi, z\right) = 
	\int\limits_{0}^{\infty} \dd \rho \, \rho
	\int\limits_{0}^{2\pi} \dd \varphi \, 
	\exp{\im k_\rho \rho \cos \left(k_\varphi - \varphi\right)}
	f \left(\rho, \varphi, z\right)
\end{equation}
and
\begin{equation}\label{eq:fourier_transform_2space_backward}
	f \left(\rho, \varphi, z\right) = 
	\frac{1}{\left(2\pi\right)^2}
	\int\limits_{0}^{\infty} \dd k_\rho \, k_\rho
	\int\limits_{0}^{2\pi} \dd k_\varphi \, 
	\exp{-\im k_\rho \rho \cos \left(k_\varphi - \varphi\right)}
	\tilde{f} \left(k_\rho, k_\varphi, z\right)
	\, ,
\end{equation}
where the geometrical meaning of the dot product is incorporated.
Note that $z = \uv{z} \cdot \pvec{r}$ is unaffected by the integral in
\eqref{eq:fourier_transform_2space_forward}.
It is therefore sufficient to consider only $f = f\left(\rho, \varphi\right)$
and $\tilde{f} \left(k_\rho, k_\varphi\right)$, \ie, to use planar polar
coordinates.

Assume further that both functions $f$ and $\tilde{f}$ possess---or
can be coordinate-transformed to obtain---azimuthal symmetry, \ie, the
functions do not depend on the coordinate $\varphi$ in \cref{def:cyl_coords}.
For such functions of azimuthal symmetry the 2D integrals in 

Under certain conditions the two-dimensional integrals in
\eqref{eq:fourier_transform_2space_forward} and 
\eqref{eq:fourier_transform_2space_backward} can be reduced to integral
transforms with cylinder function kernels and integration only over one
variable.
Such transforms are referred to as Hankel transforms or, synonymously,
Fourier-Bessel transforms in mathematical context.
As the Hankel transform is essentially a special case of a two-dimensional
Fourier transform, the specific shape of the former depends on the choice of
definition of the latter, \ie, on \cref{def:fourier_transfrom_temporal_forward}.

The following result gives the Hankel transform as it is obtained on the
basis of \cref{def:fourier_transfrom_temporal_forward} and
\cref{def:fourier_transfrom_spatial_forward} as well as a proof for this
connection\footnote{The proof treats the derivation of the inverse Hankel
transform. A corresponding approach for the forward transform can be found
in the book by \textcite[pp.~229]{Davies2002}}.
Details regarding the function spaces on which the Hankel transform pair is
defined can be found in specialized literature \cite{Patra2018,Davies2002}.

\begin{corollary}[Hankel transform and inverse Hankel transform]
	\label{coll:hankel_transform}
	The Hankel transform of order $\nu$ of a function $f\left(\rho\right)$ is
	given by
	\begin{equation}\label{eq:hankel_transform}
		\tilde{f}_\nu \left(k_\rho\right) =
		\left( \hankelTransform{\nu} f \right) \left(k_\rho\right) = 
		2\pi
		\int\limits_{0}^{\infty} \dd \rho \, \rho
		\besselj{\nu}\left(k_\rho \rho\right)
		f\left(\rho\right) \, ,
	\end{equation}
	where $\besselj{\nu}$ is the cylindrical Bessel function of first kind and
	of order $\nu$.
	The inverse Hankel transform is given by
	\begin{equation}\label{eq:hankel_transform_inverse}
		f\left(\rho\right) =
		\left( \hankelTransformInverse{\nu}\tilde{f}\right) \left(\rho\right) =
		\frac{1}{2\pi}
		\int\limits_{0}^{\infty} \dd k_\rho \, k_\rho
		\besselj{\nu}\left(k_\rho \rho\right)
		\tilde{f}_\nu\left(k_\rho\right) \, .
	\end{equation}
\end{corollary}
\begin{proof}
	Consider both $f = \left(\rho, \varphi\right)$ and
	$\tilde{f} \left(k_\rho, k_\varphi\right)$ in planer polar coordinates.
	With this, both functions are periodic with $2\pi$ in $\varphi$ and
	$k_\varphi$, respectively.
	Therefore, they can be expressed by Fourier series expansions
	\begin{equation}\label{eq:ht_proof_f_fourier_series}
		f \left(\rho,\varphi\right) =
		\sum_{\forall m \in \Z}
		f_m \left(\rho\right)
		\exp{\im m \varphi}
	\end{equation}
	and
	\begin{equation}\label{eq:ht_proof_f_tilde_fourier_series}
		\tilde{f} \left(k_\rho, k_\varphi\right) = 
		\sum_{\forall n \in \Z}
		\tilde{f}_n \left(k_\rho\right)
		\exp{\im n k_\varphi}
		\, ,
	\end{equation}
	in these arguments, where the expansion coefficients are determined by
	\begin{equation}\label{eq:ht_proof_f_fourier_coeffs}
		f_m\left(\rho\right) = \frac{1}{2\pi}
		\int\limits_{0}^{2\pi} \dd \varphi \,
		\exp{-\im m \varphi}
		f \left(\rho, \varphi\right)
	\end{equation}
	and
	\begin{equation}\label{eq:ht_proof_f_tilde_fourier_coeffs}
		\tilde{f}_n \left(k_\rho\right) = \frac{1}{2\pi}
		\int\limits_{0}^{2\pi} \dd k_\varphi \,
		\exp{-\im n k_\varphi}
		\tilde{f} \left(k_\rho, k_\varphi\right)
		\, ,
	\end{equation}
	respectively.
	The inverse transform \eqref{eq:hankel_transform_inverse} shall be derived
	first.
	To do so, \eqref{eq:fourier_transform_2space_backward} is substituted into
	\eqref{eq:ht_proof_f_fourier_coeffs} to obtain
	\begin{equation}\label{eq:ht_proof_triple_integral}
		f_m \left(\rho\right)  =
		\frac{1}{\left(2\pi\right)^3}
		\int\limits_{0}^{2\pi} \dd \varphi
		\exp{-\im m \varphi}
		\int\limits_{0}^{\infty} \dd k_\rho \, k_\rho
		\int\limits_{0}^{2\pi} \dd k_\varphi \, 
		\exp{-\im k_\rho \rho \cos \left(k_\varphi - \varphi\right)}
		\sum_{\forall n \in \Z}
		\tilde{f}_n \left(k_\rho\right) \exp{\im n k_\varphi}
		\, ,
	\end{equation}
	where $\tilde{f}$ is expressed by its Fourier series representation
	\eqref{eq:ht_proof_f_tilde_fourier_series}.
	Defining $\alpha \coloneqq k_\varphi - \varphi$ allows to express the
	two exponentials of $-\im m \varphi$ and $\im n k_\varphi$ as functions
	of the same variable.
	The orthogonality relations for trigonometric functions reveal that
	all terms but the one for $m = n$ in the sum in
	\eqref{eq:ht_proof_triple_integral} vanish.
	Hence, \eqref{eq:ht_proof_triple_integral} is essentially
	\begin{equation}\label{eq:ht_proof_after_orthogonality}
		f_m \left(\rho\right) = 
		\frac{1}{\left(2\pi\right)^2}
		\int\limits_{0}^{\infty} \dd k_\rho \, k_\rho
		\int\limits_{0}^{2\pi} \dd \alpha \,
		\exp{-\im k_\rho \rho \cos \alpha}
		\exp{\im m \alpha}
		\tilde{f}_m \left(k_\rho\right)
		\, .
	\end{equation}
	The inner integral in \eqref{eq:ht_proof_after_orthogonality} is identified
	as a form of Bessel's integral \cite[(10.19.2)]{Olver2010} for integer
	Bessel functions of integer order \cite[p.~314]{Davies2002}.
	With this \eqref{eq:ht_proof_after_orthogonality} can be written as
	\begin{equation}
		f_m \left(\rho\right) =
		\frac{1}{2\pi}
		\int\limits_{0}^{\infty} \dd k_\rho \,
		\besselj{m}\left(k_\rho \rho\right) k_\rho
		\tilde{f}m \left(k_\rho\right)
		\, ,
	\end{equation}
	which is the inverse Hankel transform \eqref{eq:hankel_transform_inverse}.
	The connection of the forward transform \eqref{eq:hankel_transform}
	to \eqref{eq:fourier_transform_2space_forward} can be shown in the same
	manner.
\end{proof}

By inspection of \eqref{eq:ht_proof_after_orthogonality} and 
\eqref{eq:ht_proof_f_tilde_fourier_coeffs} some vivid insight can be gained
regarding the role of the order $\nu$ in Hankel transform integrals. 
Consider the inverse transform \eqref{eq:hankel_transform_inverse} which
is of particular importance in the context of electromagnetic wave propagation
in media of planar inhomogeneity.
The expansion \eqref{eq:ht_proof_f_tilde_fourier_series} represents a
spectral domain function $\tilde{f}$ with a \emph{general} dependency on both
$k_\rho$ and $k_\varphi$, where the expansion coefficients are given by
\eqref{eq:ht_proof_f_tilde_fourier_coeffs}.
By contrast to the infinite number of non-vanishing expansion coefficients
$\tilde{f}_n$ in $k_\vartheta$ in this general function, the Hankel transform
of order $\nu = 0$ considers only the zeroth coefficient,
see \eqref{eq:ht_proof_after_orthogonality}.
Therefore, the zeroth-order inverse Hankel transform is especially suited for
functions spectral domain function $\tilde{f}$ of
\emph{azimuthal symmetry} around the cylindrical
$z$-axis\footnote{Off-centered functions of azimuthal
symmetry can be considered by straightforward transformation of variables.}.
For all spectral domain functions $\tilde{f}$ which vary in $k_\varphi$, the
inverse Hankel transform with $\nu = 0$ would perform angular averaging, which
is readily observed from \eqref{eq:ht_proof_f_tilde_fourier_coeffs}.
However, the inverse Hankel transform of order $\nu = 1$ is able to represent
first-order harmonic variation of $\tilde{f}$ in $k_\varphi$.
The second order transform is amenable to second order harmonic variation in
$k_\varphi$ and so on.

\fxnote{Check this paragraph}
This observation of a central mathematical property of the integral transforms
given by \cref{coll:hankel_transform} directly leads the use case in
electromagnetic theory.
In the study of wave fields in media of planar inhomogeneity the spatial domain
fields are represented by inverse Hankel transforms whose counterparts in the 
$k_\rho$-spectral-domain are known in analytical form.
As it turns out, these functions are either azimuthally symmetric, \ie,
independent of $k_\varphi$, or depend on $k_\varphi$ via trigonometric
functions. 
Here, a prominent feature of the representation of spatial domain fields in
terms of Hankel transforms becomes clear: the trigonometric variation of the
spectral function $\tilde{f}$
can be moved outside the Hankel transform integral, while this is not
possible in \eqref{eq:fourier_transform_2space_backward}.
Thus, the two-dimensional integral over $\R^2$ is reduced to a single
semi-infinite integral.
This makes the form of \eqref{eq:hankel_transform_inverse} especially appealing
for the straightforward evaluation by numerical integration.








\subsection{Helmholtz Equation and Green's Function of Free Space}

Let the following definitions prefix the present section.
\begin{definition}[Domain]
	An open, simply connected subset of a finite dimensional vector space or
	the complex plane $\C$ is
	called a \emph{domain}.
\end{definition}
\begin{definition}[Closure]
	Let $\Omega$ be a domain.
	The set $\overline{\Omega}$ consisting of $\Omega$ and all its limit points
	is called \emph{closure} of $\Omega$.
\end{definition}
\begin{definition}[Boundary]
	Let $\Omega \subset \R^3$ be a domain with closure $\overline{\Omega}$.
	The set $\partial\Omega \coloneqq \overline{\Omega}\setminus\Omega$
	is called \emph{boundary} of $\Omega$.
\end{definition}

The scalar wave equation \eqref{eq:scalar_wave_equation_physical_domain}
is a \ac{PDE} equation both in space and in time.
By application of \eqref{eq:fourier_transfrom_temporal_forward} to
\eqref{eq:scalar_wave_equation_physical_domain} the scalar Helmholtz equation
\begin{equation}\label{eq:scalar_helmholtz_equation}
	\left( \laplace + k^2 \right) \phi \left( \robs, \omega \right) = 0
	\qquad \omega = \mathrm{const.}
\end{equation}
is obtained, where $k = \omega / c$.
Note that $\omega$ is no variable but a parameter of the problem.
Hence, \eqref{eq:scalar_helmholtz_equation} is a \ac{PDE} in space only.
Moreover, in the common scheme of classification \cite[pp.~38]{Sommerfeld1964},
the \ac{PDE} changes from hyperbolic to elliptic type by transition from
\eqref{eq:scalar_wave_equation_physical_domain} to
\eqref{eq:scalar_helmholtz_equation}\footnote{For this reason the present
thesis avoids using the term \enquote{wave equation} for
\eqref{eq:scalar_helmholtz_equation}, although this terminology is frequently
used in the literature \cite[p.~238]{Sommerfeld1964}\cite{Coifman1993}}.

The \ac{PDE} \eqref{eq:scalar_helmholtz_equation} does not uniquely define
its solutions.
However, it models such central physical phenomena like sonic waves
and---in its vectorized form---electromagnetic waves including light.
As there is no randomness observed in such waves,
\eqref{eq:scalar_helmholtz_equation} has to be supplemented by appropriate
boundary conditions to make a solution unique.
For the case of an unbounded solution domain, the physically appropriate
boundary condition is given by
\begin{definition}[Sommerfeld radiation condition]
	\label{def:sommerfeld_radiation_condition}
	Let $f: \R^3 \mapsto \C$ be a function with support on a finite domain
	$\Omega \subset \R^3$ and assume $k \in \R$ with $k > 0$.
	Then a solution $\phi$ to
	\begin{equation}\label{eq:scalar_helmholtz_equation_inhomogeneous}
		\left( \laplace + k^2 \right) \phi \left( \robs \right) =
		f \left( \robs \right)
	\end{equation}
	is said to obey the \emph{Sommerfeld radiation condition} if it fulfills
	\cite{Sommerfeld1912}\cite{schot1992}
	\begin{equation}\label{eq:sommerfeld_radiation_condition}
		\lim_{r \to \infty}
		r \left( \frac{\partial}{\partial r} + \im k \right)
		\phi \left( r \right) = 0
		\, .
	\end{equation}
\end{definition}

The Sommerfeld condition ensures that a solution $\phi$ is a \emph{physical}
solution as it carries energy \emph{away} from the source region $\Omega$ and is
asymptotically small for $\lim_{r \to \infty}$.
Furthermore, it can be shown \cite[pp.~190]{Sommerfeld1964} that such a function
$\phi$ is the uniquely defined solution to
\eqref{eq:scalar_helmholtz_equation_inhomogeneous}
\begin{theorem}[Uniqueness]
	A solution $\phi$ to \eqref{eq:scalar_helmholtz_equation_inhomogeneous}
	for open boundary conditions which obeys
	\eqref{eq:sommerfeld_radiation_condition} is unique.
\end{theorem}

In order to solve \eqref{eq:scalar_helmholtz_equation} for the general
inhomogeneous case, it is beneficial first to consider the problem of Green's
function.
The Green's function is defined with $f$ in
\eqref{eq:scalar_helmholtz_equation_inhomogeneous} being a source function
according to
\begin{definition}[Delta function]\label{def:dirac_delta}
	Let $\robs$ and $\rsrc$ be two vectors in the Euclidean vector space
	$\F^N$, where $\F \in \left\{\R, \C\right\}$ and
	$N \in \left\{1, 2, 3\right\}$.
	Then the $N$-dimensional \emph{delta function}\footnote{The concept is
	termed \emph{function} here as the formal \cref{def:dirac_delta} is
	sufficient for the present thesis purposes.
	There is no benefit in a deeper consideration resorting to the theory of
	distributions\cite{Strichartz2003}.} is denoted by
	$\diracDelta$ and formally defined by the properties:
	\begin{enumerate}[label=(\alph*)]
		\item Point source behavior: for arbitrary $\Omega \subset \F^N$ we
		have
		\begin{equation}
			\int\limits_{\Omega} \dd \pvec{r} \,
			\diracDelta \left( \robs - \rsrc \right)
			\begin{cases*}
				1 & $\rsrc \in \Omega$ \\
				0 & \text{else} \, .
			\end{cases*} 
		\end{equation}
		\item Sifting functional: for a test function $\phi$ 
		\cite{Strichartz2003}\cite[p.~35]{Olver2010} we have
		\begin{equation}\label{eq:delta_filter_property}
			\int\limits_{\F^N} \dd \pvec{r} \,
			f \left( \robs \right)
			\diracDelta \left(\robs-\rsrc\right) =
			f \left( \rsrc \right)
			\, .
		\end{equation}
	\end{enumerate}
\end{definition}

The Green's function of the Helmholtz equation for the important case of
constant $k$ is given by the well-known \cite{Jackson2013}
\begin{corollary}[Free-space Green's function]
	Let $\rsrc, \robs \in \R^3$ with $\robs \neq \rsrc$ and assume
	$k$ to be a constant function of $\robs$ with $\imag{k} \leq 0$.
	Furthermore, let valid solutions to
	\eqref{eq:scalar_helmholtz_equation_inhomogeneous} be restricted by
	\cref{def:sommerfeld_radiation_condition}.
	Then
	\begin{equation}\label{eq:scalar_free_space_gf}
		G_0 \left( \rdiff \right) =
		\frac{\exp{-\im k \abs{\rdiff}}}{4\pi \abs{\rdiff}}
	\end{equation}
	is the unique solution to \eqref{eq:scalar_helmholtz_equation} for
	$\diracDelta$-excitation at $\rsrc$.
\end{corollary}

Clearly, $G_0$ represents an outward propagating spherical scalar wave 
centered at $\rsrc$.
Subsequently, the shortcut $R \coloneqq \abs{\rdiff}$ shall be used for
notational convenience.







\subsection{Complex Source Beams}

In case $k$ in \eqref{eq:scalar_helmholtz_equation_inhomogeneous} is not
constant throughout $\R^3$ the Green's function is no longer given by the
simple formula \eqref{eq:scalar_free_space_gf}.
In the case of $k = k\left(z\right)$ it is instead expressed by spectral
integrals where only the spectral Green's function is known analytically.
The \ac{DCIM} aims to fit these integrands by terms which can be integrated
analytically and which have the form of \eqref{eq:scalar_free_space_gf}.
However, the distance $R \coloneqq \abs{\rdiff}$ in 
\eqref{eq:scalar_free_space_gf} is written in case of the Euclidean metric
according to \cref{def:euclidean_metric}.
Therefore, $R$ is always a real, non-negative number.
This property does not hold within the framework of \ac{DCIM}, where $R$
is complex in general.
This property is, in fact, the eponymous feature of the \ac{DCIM}.

Namely, the \enquote{distance} $R \in \C$ within the \ac{DCIM} is of the
specific form
\begin{equation}\label{eq:dcim_cmplx_length_sqrt_z}
	R = \sqrt{\rho^2 + z^2}
	\, ,
\end{equation}
where $\rho = \abs{\left(\rdiff\right) \times \uv{z}}$ and $z \in \C$ is a
parameter obtained by the \ac{DCIM}.
Clearly, in \eqref{eq:dcim_cmplx_length_sqrt_z} a decision has to be made how
to choose the branch of the complex square root.
However, it is obvious that $R$ in \eqref{eq:dcim_cmplx_length_sqrt_z} is not
a length in the sense of a metric as specified in \cref{def:metric}.

% With regard to complex image sources within the electromagnetic context, it is
% observed that the output data of the \ac{DCIM} provides complex scalars
% which can be interpreted length-like.
% This fact does not cause problems if the \ac{DCIM} is applied as originally
% intended, as these complex images are summated internally. Within the 
% conventional algorithm they are never actually \enquote{placed} in a 
% $\C^3$ solution domain of the electromagnetic field problem.
% However, towards a possible integration of complex images into the \ac{FMM} the
% aim is to do exactly this.

% As it can easily be seen from \cref{def:metric} and \cref{def:norm}
% the operation mapping a vector $\rsrc \in \C^3$ to a complex distance in the
% \acs{DCIM}-sense can neither be a metric nor a norm.
% Nevertheless, as it is demonstrated in a paper by \textcite{Hansen2009}, such a
% complex distance can have a physical meaning.
% One property of a complex distance which can be axiomatically postulated
% is that a complex distance $r \in \C$ should have non-negative real part.
% Within the context of \ac{DCIM} a reasonable definition of complex length
% is \cite{Hansen2009, Hansen2013}
% \begin{definition}[Complex length]
% 	Let $x, y \in \R$, $z \in \C$ and the square root $\sqrt{c}$ of
% 	an arbitrary complex number $c$ be defined with its branch cut along the
% 	negative real axis.
% 	Then the \emph{complex length} of a vector
% 	$\pvec{r} = \uv{x}x + \uv{y}y +\uv{z}z$ is defined as
% 	\begin{equation}
% 		r_c =
% 		\complexLength{\pvec{r}} =
% 		\sqrt{\pvec{r} \cdot \overline{\pvec{r}}} =
% 		\sqrt{x^2 + y^2 + z^2} \, ,
% 	\end{equation}
% 	where the square root is evaluated on the Riemann sheet on which 
% 	$\real{r_c} \ge 0$.
% \end{definition}






\subsection{Sommerfeld Integrals}

In the electromagnetic context inverse Hankel transform integrals
are---in Arnold Sommerfeld's honor---predominantly referred to
as \emph{Sommerfeld integrals} \cite{Sommerfeld1909, Mosig2021}.
However, in this field only transforms of orders
$\nu \in \left\{0, 1, 2\right\}$ occur\footnote{Transforms of order $\nu = 2$
can, in fact, be expressed by ones of orders $\nu = 0$ and $\nu = 1$ in
electromagnetic problems \cite{Michalski2005}.}

Taking the significance of these integrals into account, it is adequate to
introduce a special symbol for Sommerfeld integrals.
\begin{definition}[Sommerfeld integrals]	
	Inverse Hankel transforms of orders $\nu \in \left\{0, 1, 2\right\}$
	are called \emph{Sommerfeld integrals}.
	They are denoted by
	\begin{equation}\label{eq:si_pos_real_axis_path}
		\sommerfeldIntegral{\nu}
		% \left\{ \tilde{f} \left( k_\rho \right) \right\} \coloneqq 
		% \frac{1}{2\pi}
		% \int\limits_{0}^{\infty} \dd k_\rho \, k_\rho
		% \besselj{\nu}\left(k_\rho \rho\right) 
		% \tilde{f} \left(k_\rho\right) 
		% \, .
	\end{equation}
\end{definition}

Much of Sommerfeld's original considerations \cite{Sommerfeld1909} regarding
dipole radiation above a plane lossy ground are not directly based on the
\ac{SIP} but on an alternative integration path given by
\begin{corollary}[Extended integration path]
	Let $\tilde{f} \left\{k_\rho\right\}$ be an even (odd) function of $k_\rho$
	for even (odd) $\nu \in \N$.
	Then the Sommerfeld integral \eqref{eq:si_pos_real_axis_path}
	along the positive real axis path is equivalent to
	\begin{equation}\label{eq:si_sommerfeld_intgration_path}
		\sommerfeldIntegral{\nu}{\tilde{f} \left( k_\rho \right)} =
		\frac{1}{4\pi}
		\int\limits_{-\infty}^{\infty} \dd k_\rho \, k_\rho
		\besselh{2}{\nu} \left(k_\rho \rho\right)
		\tilde{f} \left(k_\rho\right) \, .
	\end{equation}
	The path over $\R \cup \left\{-\infty, \infty\right\}$
	is called \acf{SIP}\cite[p.~66]{Chew1999}.
\end{corollary}

\begin{remark}[\acf{SIP}]
	To render the integral \eqref{eq:si_sommerfeld_intgration_path} defined
	the \ac{SIP} must avoid the logarithmic branch point introduced by
	$\besselh{2}{\nu}$ at $k_\rho = 0$.
	Formally this can be achieved by slight deformation of the path into
	$\C$ around this point.
\end{remark}

The \ac{SIP} has a variety of advantages over the positive real axis path in
\eqref{eq:si_pos_real_axis_path}.
Much of the power of Sommerfeld's approach originates in the fact that the
involved spectral domain functions are holomorphic on $\C$ with the possible
exceptions of distinct poles, branch point and the corresponding branch cuts.
This makes it possible to deform the path of integration, either to render
the integrals defined in first place or---totally leaving the real axis
path---to apply elaborated analytical and numerical techniques.
In this context the positive real axis path in \eqref{eq:si_pos_real_axis_path}
has the disadvantage of not being closed.
In fact, also this path can be deformed by virtue of Cauchy's theorem, but
the full power of this result combined with the residue theorem is only
available with the \ac{SIP}.
As the real $-\infty$ and $\infty$ can be interpreted as the same point in
$\C \cup \left\{\infty\right\}$ in the picture of Riemann's sphere
\cite[p.~180]{Meyberg2006}, the \ac{SIP} is a closed path in the complex plane
and the integral along the \ac{SIP} is, as stated by Cauchy's theorem
and Jordan's lemma, equal to the sum of residues of the captured singularities.

The proof of equivalence for \eqref{eq:si_pos_real_axis_path} and
\eqref{eq:si_sommerfeld_intgration_path}---which has turned out so fruitful in
the early days of the study of wave propagation---is nowadays a classic textbook
example \cite[p.~203]{Sommerfeld1964}.







\subsection{Sommerfeld identity}

% \begin{equation}\label{eq:sommerfeld_id_pos_real_axis}
% 	\frac{\exp{-\im k r}}{r} = 
% 	-\im
% 	\int\limits_{0}^{\infty} \dd k_\rho \,
% 	\besselj{0} \left(k_\rho \rho\right) k_\rho 
% 	\frac{\exp{-\im k_z \abs{z}}}{k_z}
% \end{equation}

% \begin{theorem}[Sommerfeld identity with complex vertical distance]
% 	Let $\rho \in \R$ with $\rho > 0$ and $k \in C$ be defined with
% 	$\imag{k} < 0$ where $\imag{k} \to 0$. Then \eqref{eq:sommerfeld_id_pos_real_axis} 
% 	remains valid if $\abs{z}$ with $z \in \R$ is replaced by a complex distance
% 	as defined in  

	
% \end{theorem}

% \begin{equation}\label{eq:sommerfeld_identity_bessel}
% 	\frac{\exp{\im k r}}{r} = \im \int\limits_{0}^{\infty} \frac{k_\rho}{k_z} \besselj{0} \left(k_\rho \rho\right) \exp{i k_z \abs{z}} \dd k_\rho \, ,
% \end{equation}
% where
% \begin{equation}\label{eq:k_z}
% 	k_z = \sqrt{k^2 - k_\rho^2} \, ,
% \end{equation}
% is chosen such that $\imag{k_z} > 0$.

% \begin{lemma}[Sommerfeld identity {\cite[p.~684]{Sommerfeld1909}, \cite{Chew1999}}]\label{lemma:sommerfeld_identity}
% 	Let $r,\,k\in\C \setminus \left\{0\right\}$, $z \in \C$, $\rho \in \R$, $\real{r} > 0$, $\imag{k} > 0$ and $r^2 = \rho^2 + z^2$. Then the Sommerfeld identity reads
% \end{lemma}

% \begin{proof}
% 	\fxnote{Beweis für komplexe Ortskoordinaten}
% \end{proof}

% With Cauchy's integral theorem in mind, Sommerfeld recognized a certain drawback in the integration path along the positive real $k_\rho$-axis when it comes to getting enlightening physical insights out of integrals like the one in \eqref{eq:sommerfeld_identity_bessel}. For a closed integration path would much better suit the theorem Sommerfeld derived an alternative representation of \eqref{eq:sommerfeld_identity_bessel} invoking a well-known identity \cite[eq.~10.4.4]{Olver2010} and the so-called \enquote{circuit relations} of Hankel functions \cite[p.~314]{Sommerfeld1964}. It is given by
% \begin{corollary}[Sommerfeld identity in terms of Hankel functions]
% 	The Sommerfeld identity in terms of Hankel functions reads
% 	\begin{equation}\label{eq:sommerfeld_identity_hankel}
% 		\frac{\exp{\im k r}}{r} = \frac{\im}{2} \int\limits_{-\infty}^{\infty} \frac{k_\rho}{k_z} \besselh{1}{0} \left(k_\rho \rho\right) \exp{i k_z \abs{z}} \dd k_\rho \, .
% 	\end{equation}
% \end{corollary}
% The third well-known formulation of the very same mathematical statement expands the Hankel transform in \eqref{eq:sommerfeld_identity_bessel} or \eqref{eq:sommerfeld_identity_hankel}, respectively, in a two-dimensional Fourier integral
% \begin{corollary}[Weyl identity {\cite{Weyl1919}, \cite{Chew1999}}]\label{coll:wely_identity}
% 	The Weyl identity reads
% 	\begin{equation}\label{eq:weyl_identity}
% 		\frac{\exp{\im k r}}{r} = \frac{\im}{2\pi} \int\limits_{-\infty}^{\infty} \int\limits_{-\infty}^{\infty} \frac{-\exp{-\im k_z \abs{z}}}{\im k_z} \exp{\im k_x x} \exp{-\im k_y y} \dd k_x \, \dd k_y \, .
% 	\end{equation}
% \end{corollary}

% For the mathematical equivalence of \eqref{eq:sommerfeld_identity_bessel}, \eqref{eq:sommerfeld_identity_hankel} and \eqref{eq:weyl_identity} all three forms can be employed in the description of the same physics, namely the description of a scalar spherical wave. While all three of the forms involve the plane wave term $\exp{i k_z \abs{z}}$ to represent the vertically directed wave constituents, the lateral part of the field can be represented either by standing or propagating cylindrical waves as well as by a superposition of plane waves.

% The differing property of vertical and lateral, however, is that the properties of the lateral wave constituents solely depend on the integration variable while the set of vertical plane waves is in any case composed of propagating and evanescent portions, corresponding to the cases $k_\rho \lessgtr k$ in \eqref{eq:k_z}.

% \fxnote{Hier noch schreiben wie sich das auswirkt.}


% \fxnote{Beweis, dass Sommerfeld-Identität auch mit komplexen Längen gilt!?}
%Die räumlichen Größen $r$ und $z$ in \eqref{eq:sommerfeld_identity} waren in Sommerfelds ursprüngliche Analyse reell. Wie früh erkannt wurde \cite{Deschamps1971,Keller1971} behält \cref{lemma:sommerfeld_identity} jedoch auch für $r, z\in\C$ seine Gültigkeit. Die Kugelwelle verändert dabei jedoch ihre für $r, z\in\R$ isotrope Charakteristik hin zu einem gerichteten gaußschen Strahl.

















\section{Electromagnetic Waves in Planar Multilayered Media}

\subsection{Fundamental equations}
\label{subsec:em_fundamental_equations}

The theory of classical electrodynamics, expressed axiomatically by Maxwell's
equations, constitute an accepted and well-proven framework for thy analysis of
\emph{macroscopic} electromagnetic phenomena.
Macroscopic means that it can be justly assumed that the electromagnetic
sources --- charges and currents --- are described by \emph{continous}
functions of space. 
In order to state a version of Maxwell's equations suitable to the problem at
hand the following assumptions are made.
\begin{itemize}
	\item All time dependent quantities are assumed to vary sinusoidally with
	a single frequency $f > 0$ (in $\SI{}{\hertz}$) under time convention
	as determined by \cref{def:fourier_transfrom_temporal_forward},
	where $\omega = 2\pi f$.
	\item All media are assumed to possess linear and isotropic behavior.
	Their electromagnetic properties are therefore fully described by two scalar
	fields $\epsr, \mur \in \C$.
	\item Hypothetical magnetic (equivalent) sources $\pvec{M}$ and
	$\varrho_\mathrm{m}$ are assumed to mathematically complement the physical
	sources $\pvec{J}$ and $\varrho$.
\end{itemize}
Under these assumptions Maxwell's equations read \cite{Chew1999}
\begin{subequations}\label{eq:mwe_fd}
	\begin{align}
		&\curl \pvec{E}
		= -\im\omega\mu\pvec{H} -\pvec{M} \label{eq:mwe_fd_faraday} \\
		&\curl \pvec{H}
		= \im\omega\varepsilon\pvec{E} + \pvec{J} \label{eq:mwe_fd_ampere} \\
		&\divergence \varepsilon\pvec{E}
		= \varrho \label{eq:mwe_fd_gauss} \\
		&\divergence \mu\pvec{H}
		= \varrho_\mathrm{m} \,, \label{eq:mwe_fd_gauss_magnetic}
	\end{align}
\end{subequations}
where $\varepsilon = \epsr \varepsilon_0$ and $\mu = \mur \mu_0$.
The physical constants $\varepsilon_0$ and $\mu_0$ specify the
electromagnetic properties of vacuum.
The vector fields are functions $\R^3 \mapsto \C^3$ and the scalars map
$\R^3 \mapsto \C$.

The dimensionless quantity $\epsr \in \C$ is called relative permittivity 
and can be composed of a real part describing the dielectric properties of a
lossless medium and the conductivity of the medium which determines its losses
\cite[p.~43]{Jin2015}:
\begin{equation}
	\epsr = \epsr^\prime - \im \frac{\sigma}{\omega \varepsilon_0} \,.
\end{equation}

In order to uniquely define an electromagnetic field problem and its solution,
Maxwell's equations \eqref{eq:mwe_fd} have to be supplemented by appropriate
boundary conditions.
In a homogeneous domain these follow from
\cref{sommerfeld_radiation_condition}.

At an interface separating two spatial domains $\Omega_1$ and $\Omega_2$ with
different, but domain-wise constant material parameters the well-known
continuity conditions \cite[pp.~20]{Jackson2013}
\begin{subequations}\label{eq:mwe_continuity_at_interface}
	\begin{align}
		&\uv{n} \times \pvec{E}_1 - \uv{n} \times \pvec{E}_2 =
		- \pvec{M}_\mathrm{s} \\
		&\uv{n} \times \pvec{H}_1 - \uv{n} \times \pvec{H}_2 =
		\pvec{J}_\mathrm{s} \\
		&\uv{n} \cdot \left(\varepsilon_1 \pvec{E}_1\right) -
		\uv{n} \cdot \left(\varepsilon_2 \pvec{E}_2\right) = 
		\varrho_\mathrm{s} \\
		&\uv{n} \cdot \left(\mu_1 \pvec{H}_1\right) -
		\uv{n} \cdot \left(\mu_2 \pvec{H}_2\right) = 
		\varrho_\mathrm{m,s} \\
	\end{align}
\end{subequations}
must be fulfilled, where $\uv{n}$ is the normal unit vector on the interface
between $\Omega_1$ and $\Omega_2$ and the subscript \enquote{s} denotes
possible surface currents and charge densities at this interface.
The right-hand sides $\pvec{M}_\mathrm{s}$ and $\varrho_\mathrm{m,s}$
in \eqref{eq:mwe_continuity_at_interface} follow from the introduction of
the corresponding hypothetical sources in \eqref{eq:mwe_fd}.

The arguably most prominent feature of Maxwell's equations is the possibility
of wave solutions. Equations more suitable to deal with wave phenomena can
readily obtained from \eqref{eq:mwe_fd}.
For example
\begin{equation}\label{eq:curlcurl_E}
	\mu\curl\frac{1}{\mu}\curl\pvec{E} - k^2\pvec{E} = 0 
\end{equation}
is readily derived from \eqref{eq:mwe_fd_faraday} and \eqref{eq:mwe_fd_ampere}.
The corresponding equation
\begin{equation}\label{eq:curlcurl_H}
	\varepsilon\curl\frac{1}{\varepsilon}\curl\pvec{H} - k^2\pvec{H} = 0
\end{equation}
for the magnetic field is obtained analogously.
For constant material parameters \eqref{eq:curlcurl_E} and \eqref{eq:curlcurl_H}
reduce to the vector Helmholtz equation
\begin{equation}\label{eq:vector_helmholtz_equation}
	\laplace \pvec{F} + k^2 \pvec{F} = 0 \qquad
	\pvec{F} \in \left\{\pvec{E}, \pvec{H}\right\}
\end{equation}
The quantity
\begin{equation}\label{eq:wavenumber}
	k = \omega^2 \sqrt{\varepsilon \mu}
\end{equation}
is called \emph{wavenumber}.
To make a solution to \eqref{eq:curlcurl_E}, \eqref{eq:curlcurl_H} and
\eqref{eq:vector_helmholtz_equation} uniquely defined $k$ has to be chosen
according to
\begin{definition}[Computation of the wavenumber $k$]\label{def:branch_of_k}
	Assume $\epsr, \mur \in \C$ with $\imag{\epsr} \le 0$ and
	$\imag{\mur} \le 0$. 
	The square root in \eqref{eq:wavenumber} is defined with
	$\imag{\sqrt{\epsr \mur}} \le 0$ and its branch cut along the negative real
	axis.
\end{definition}
\begin{remark}
	With the choice of $k$ according to \cref{def:branch_of_k} the radiation
	condition as given by \cref{sommerfeld_radiation_condition} is fulfilled.
\end{remark}
For $k \in \R$ it makes sense also to define the wavelength as
$\lambda = 2\pi / k$.
If the vacuum values of the quantities $\lambda_0 = 2\pi / k_0 = c / f$,
where $c$ is the vacuum speed of light, are considered, this is indicated by
the subscript zero.

\subsection{Duality principle}
\label{subsec:duality_principle}

Instead of by a derivation analogous to the one of \eqref{eq:curlcurl_E},
\eqref{eq:curlcurl_H} could also be directly obtained by by a principle
which \textcite[\S12-1]{Feynman2011} summarized by stating that
\enquote{the same equations have the same solutions}.

This so-called duality principle makes use of the fact that the symmetry of the
complemented Maxwell's equations \eqref{eq:mwe_fd} in only broken by
opposing signs in \eqref{eq:mwe_fd_faraday} and \eqref{eq:mwe_fd_ampere}.
Taking this into account, a set of duality replacement rules can be established.
Note that these rules are not unique as there are different possibilities how
to define the set of substitutions \cite{Jin2015,Harrington2001,Chew1999}.
The only criterion is, that the set of rules leaves \eqref{eq:mwe_fd} invariant.
The present thesis uses the particular choice of 
\begin{definition}[Duality substitution rules for electrodynamic quantities]
	The \emph{duality substitution rules for electrodynamic quantities} in
	\eqref{eq:mwe_fd} are defined as \cite[p.~9]{Chew1999}
	\begin{subequations}
		\begin{align}
		\pvec{E} &\to \pvec{H} \\
		\pvec{H} &\to \pvec{E} \\
		\pvec{J} &\to -\pvec{M} \\
		\pvec{M} &\to -\pvec{J} \\
		\varrho &\to -\varrho_\mathrm{m} \\
		\varrho_\mathrm{m} &\to -\varrho \\
		\varepsilon &\to -\mu \\
		\mu &\to -\varepsilon 
		\end{align}
	\end{subequations}
\end{definition}

\subsection{Sommerfeld Half-Space Problem and Multilayered Media}

% \begin{figure}[htb]
% 	\centering
	
% 	% Define view angle
% 	\tdplotsetmaincoords{75}{120}
% 	\begin{tikzpicture}[tdplot_main_coords,scale=0.8]
		
% 		\begin{scope}[canvas is xy plane at z=0]
% 			\filldraw[fill=blue!30!white] (-5,-5) rectangle (5,5);
% 		\end{scope}
% 		\begin{scope}[canvas is yz plane at x=5]
% 			\filldraw[fill=blue!30!white] (5,0) rectangle (-5,-4);
% 		\end{scope}
% 		\begin{scope}[canvas is xz plane at y=5]
% 			\filldraw[fill=blue!30!white] (5,0) rectangle (-5,-4);
% 		\end{scope}
		
% 		% Draw cartesian coordinate system.
% 		\draw[thick,-latex] (0,0,0) -- (3.5,0,0) node[anchor=east]{$x$};
% 		\draw[thick,-latex] (0,0,0) -- (0,3.5,0) node[anchor=west]{$y$};
% 		\draw[thick,-latex] (0,0,0) -- (0,0,3.5) node[anchor=south]{$z$};
		
% 		% Draw observation point
% 		\pgfmathsetmacro{\rvec}{5}
% 		\pgfmathsetmacro{\thetavec}{40}
% 		\pgfmathsetmacro{\phivec}{150}
% 		\coordinate (O) at (0,0,0);
% 		\tdplotsetcoord{P}{\rvec}{\thetavec}{\phivec}
% 		\draw[-latex] (O) --node[anchor=east]{$r$} (P) node[anchor=west]{$\robs$};
% 		\draw[dashed] (O) --node[anchor=south]{$\rho$} (Pxy);
% 		\draw[dashed] (P) --node[anchor=west]{$z$} (Pxy);
% 		\tdplotdrawarc[-latex]{(O)}{1.2}{0}{\phivec}{anchor=north}{$\varphi$}
% 		\tdplotsetthetaplanecoords{\phivec}
% 		\tdplotdrawarc[tdplot_rotated_coords,-latex]{(0,0,0)}{1.2}{0}{\thetavec}{anchor=south}{$\vartheta$}
		
% 	\end{tikzpicture}
% 	\caption[Sommerfeld half-space]{Sommerfeld half-space problem with coordinate systems.}
% 	\label{fig:half_space}
% \end{figure}

\subsection{Planarly Inhomogeneous Media and Five-Component Fields}
\label{subsec:five_component_filds}

Assume a medium described by parameters $\epsr\left(z\right), \mur\left(z\right)$ which depend only on the $z$-coordinate. In this case the study of wave fields governed by \eqref{eq:curlcurl_E} an \eqref{eq:curlcurl_H} can be reduced to the solution of two \acsp{ODE}. These \acsp{ODE} describe the so-called \emph{characteristic component} of an electromagnetic filed with only five non-vanishing components. Since the vanishing sixth component is the $z$-component of either the electric or magnetic field these fields are called \ac{TE} and \ac{TM}, respectively. Once the characteristic component is known, the remaining field components can be obtained by mere differentiation \cite[pp.~75]{Chew1999}. Linear superposition of \ac{TE} and \ac{TM} solutions eventually allows for the representation of arbitrary solutions to \eqref{eq:mwe_fd}.

As an example consider a generic \ac{TE} field
\begin{equation}\label{eq:TE_E_field_components}
	\pvec{E} = \pvec{E}^\te = \uv{x}E_x + \uv{y}E_y \,.
\end{equation}
The choice of a characteristic component for this \ac{TE} field is not unique. Either the transverse component of $\pvec{E}$ as well as the vertical component of $\pvec{H}$ will do. In this example $H_z$ shall considered as characteristic component.

Apparently $H_z$ is contained in the solution to \eqref{eq:curlcurl_H}. Substituting \eqref{eq:mwe_fd_faraday} into \eqref{eq:curlcurl_H} yields
\begin{equation}\label{eq:triple_curl_TE}
	- \frac{\varepsilon}{\im \omega}\curl\frac{1}{\varepsilon}\curl\frac{1}{\mu} \curl \pvec{E} - k^2\pvec{H} = 0 \,.
\end{equation}
Expanding the $H_z$ component in \eqref{eq:triple_curl_TE} and using the precondition $\varepsilon = \varepsilon\left(z\right)$ and $\mu = \mu\left(z\right)$ we obtain
\begin{equation}\label{eq:H_z_complicated}
	\begin{split}
		\frac{1}{\mu} \left(-\pdsec{x} \pd[E_y]{x} + \pdsec{y} \pd[E_x]{y} + \pdsec{x} \pd[E_x]{y} - \pdsec{y} \pd[E_y]{x}\right) \\ -\pd{z}\frac{1}{\mu}\pd{z}\pd[E_y]{x} + \pd{z}\frac{1}{\mu}\pd{z}\pd[E_x]{y} + \im \omega k^2 H_z = 0 \,.
	\end{split}
\end{equation}
In \eqref{eq:H_z_complicated} the expression
\begin{equation}
	\pd[E_y]{x} = \pd[E_x]{y} - \im \omega \mu H_z \,,
\end{equation}
attained from \eqref{eq:mwe_fd_faraday}, as well as the shortcut
\begin{equation}\label{eq:laplace_transversal}
	\laplaceTrans \equiv \frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial y^2} = \frac{1}{\rho}\frac{\partial}{\partial \rho} \rho \frac{\partial}{\partial \rho}
\end{equation}
for the transversal part of the Laplacian operator \cite[p.~731]{Bronstein2016} are conveniently used to write
\begin{equation}\label{eq:H_z_pde}
	\laplaceTrans H_z + \frac{\partial}{\partial z}\frac{1}{\mu}\frac{\partial}{\partial z} \mu H_z + k^2 H_z = 0 \,.
\end{equation}
If the Hankel transform \eqref{eq:hankel_transform} for $\nu = 0$ is applied to \eqref{eq:H_z_pde} this corresponds to the formal substitution\footnote{Fourier transform \wrt $x$ and $y$ would correspond to $\laplaceTrans \rightarrow - k_x^2 - k_y^2$.} \cite{Michalski2016b}
\begin{equation}
	\laplaceTrans \rightarrow -k_\rho^2 \equiv - k_x^2 - k_y^2 \,.
\end{equation}
Using the vertical component
\begin{equation}\label{eq:k_z_square}
	k_z^2 = k^2 - k_\rho^2
\end{equation}
of the wavenumber in the transformed version \eqref{eq:H_z_pde} the \ac{ODE}
\begin{equation}\label{eq:TE_ODE}
	\frac{\dd}{\dd z}\frac{1}{\mu}\frac{\dd}{\dd z}\mu  \tilde{H}_z + k_z^2 \tilde{H}_z = 0
\end{equation}
is obtained for the characteristic component of the \ac{TE} field. The solution $\tilde{H}_z$ of \eqref{eq:TE_ODE} can be interpreted as the $k_\rho$-spectral domain version of the spatial domain solution $H_z$.

The dual of a \ac{TE} field is a \ac{TM} field. This circumstance can be employed to readily obtain the spectral domain \ac{ODE} for the characteristic component of the \ac{TM} field by the duality principle. The spatial domain equation for $E_z$ reads
\begin{equation}\label{eq:E_z_pde}
	\laplaceTrans E_z + \frac{\partial}{\partial z}\frac{1}{\varepsilon}\frac{\partial}{\partial z} \varepsilon E_z + k^2 E_z = 0 \,,
\end{equation}
its spectral domain counterpart becomes
\begin{equation}\label{eq:TM_ODE}
	\frac{\dd}{\dd z}\frac{1}{\varepsilon}\frac{\dd}{\dd z}\varepsilon \tilde{E}_z + k_z^2 \tilde{E}_z = 0 \,.
\end{equation}

Now \eqref{eq:TE_ODE} and \eqref{eq:TM_ODE} still assume the source-free case. In contrast to that, the Green's functions for $\tilde{H}_z$ and $\tilde{E}_z$ are of particular interest in the study of dipole radiation over planar ground. It is convenient to define the defining equations of these Green's functions in terms of $\tilde{G}^\te \equiv \mu \tilde{H}_z$ and $\tilde{G}^\tm \equiv \varepsilon \tilde{E}_z$ instead of $\tilde{H}_z$ and $\tilde{E}_z$ directly. Given these definitions the Green's functions of \eqref{eq:TE_ODE} and \eqref{eq:TM_ODE} are defined by
\begin{equation}\label{eq:TE_ODE_GF}
	\left(\frac{\dd}{\dd z}\frac{1}{\mu}\frac{\dd}{\dd z} + \frac{k_z^2}{\mu}\right) \tilde{G}^\te = -\diracDelta\left(z-z^\prime\right)
\end{equation}
and
\begin{equation}\label{eq:TM_ODE_GF}
	\left(\frac{\dd}{\dd z}\frac{1}{\varepsilon}\frac{\dd}{\dd z} + \frac{k_z^2}{\varepsilon}\right) \tilde{G}^\tm = -\diracDelta\left(z-z^\prime\right) \,,
\end{equation}
respectively.

\subsection{Continuity conditions at material changes}
\label{subsec:continuity_at_interfaces}

The derivation of the characteristic components of \ac{TE} and \ac{TM} fields in \cref{subsec:5_comp_filds} still assumes a generic dependence of $\epsr$ and $\mur$ on $z$. Solely the existence of the derivatives in \eqref{eq:TE_ODE} and \eqref{eq:TM_ODE} is required. In the following $\epsr$ and $\mur$ are assumed to be piece-wise constant in $z$. With that assumption the continuity condition for $\tilde{H}_z$ and $\tilde{E}_z$ at a discontinuity of the material parameters need to be known.

In fact these continuity conditions can readily be deduced from \eqref{eq:TE_ODE} and \eqref{eq:TM_ODE} using heuristic reasoning \cite[p.~47]{Chew1999}. Another approach to obtain the continuity conditions could follow a similar idea like the well-known derivation of the general continuity conditions for the electromagnetic field which is based on the integral form representation of Maxwell's equations \cite[pp.~20]{Jackson2013}.

In any case the continuity conditions for $\tilde{H}_z$ at a discontinuity of the material parameters read
\begin{subequations}
	\begin{equation}\label{eq:B_continuity}
		\mu_i \tilde{H}_{z,i} = \mu_{i+1} \tilde{H}_{z,i+1}
	\end{equation}
	and
	\begin{equation}\label{eq:H_z_tilde_second_continuity_condition}
		\frac{1}{\mu_i}\frac{\dd}{\dd z} \mu_i \tilde{H}_{z,i} = \frac{1}{\mu_{i+1}}\frac{\dd}{\dd z} \mu_{i+1} \tilde{H}_{z,i+1} \,.
	\end{equation}
\end{subequations}
Once more the duality principle can be employed to obtain the corresponding conditions for $\tilde{E}_z$ as
\begin{subequations}
	\begin{equation}\label{eq:D_continuity}
		\varepsilon_i \tilde{E}_{z,i} = \varepsilon_{i+1} \tilde{E}_{z,i+1}
	\end{equation}
	and
	\begin{equation}\label{eq:E_z_tilde_second_continuity_condition}
		\frac{1}{\varepsilon_i}\frac{\dd}{\dd z} \varepsilon_i \tilde{E}_{z,i} = \frac{1}{\varepsilon_{i+1}}\frac{\dd}{\dd z} \varepsilon_{i+1} \tilde{E}_{z,i+1} \,.
	\end{equation}
\end{subequations}

\fxnote{Allgemeinere Schreibweise für die Stetigkeit einführen. Darauf hinweisen, dass die Größen außerhalb von Quellen (!) immer stetig sind. Siehe \cite[S.~7]{Michalski2016b}}

\subsection{Equivalent transmission line networks and spectral Green's functions}
\label{subsec:tl_greens_functions}

If or if not inspired by Feynman's famous quote (see \cref{subsec:duality_principle}), inspection of \eqref{eq:TE_ODE_GF} and \eqref{eq:TM_ODE_GF} reveals distinctive similarities of these equations with the equations governing voltage and current on transmission lines \cite[Section 2.4]{Felsen1994}. These similarities have been widely employed in the solution of spectral Green's functions of half-space and multilayered media problems. Despite the known solution this method -- hereinafter called the \emph{network-method} -- offers yet another advantage -- it allows for the transfer of a certain \emph{feeling} about the quantities on transmission lines to those in the $k_\rho$ spectral domain.

The equations describing voltage and current on a $z$-directed transmission line with propagation constant $k_\rho$ read \cite{Felsen1994} \cite{Michalski2016b}
\begin{subequations}\label{eq:tl_ode_system}
	\begin{align}
		\frac{\dd}{\dd z} V\left(z\right) &= \im k_z Z^\tx I\left(z\right) \label{eq:tl_ode_system_dV} \\
		\frac{\dd}{\dd z} I\left(z\right) &= \im k_z Y^\tx V\left(z\right) \label{eq:tl_ode_system_dI} \, ,
	\end{align}
\end{subequations}
with $Z^\tx = 1/Y^\tx$ and $\tx$ stands either for \ac{TE} or \ac{TM}. Obviously \eqref{eq:tl_ode_system_dV} and \eqref{eq:tl_ode_system_dI} are dual equations with the relations given by \cref{tab:tl_duality}.
\fxnote{check time convention in \eqref{eq:tl_ode_system}}

\begin{table}[hbt]
	\centering
	\begin{tabular}{cc}
		\toprule%
		\textbf{original} & \textbf{dual}\\ \midrule
		$V$ & $I$ \\
		$I$ & $V$ \\
		$Z$ & $Y$ \\
		$Y$ & $Z$ \\
		\bottomrule
	\end{tabular}
	\caption[Duality substitution rules for transmission line quantities]{Duality substitution rules for transmission line quantities.}
	\label{tab:tl_duality}
\end{table}



% \begin{figure}
%    \begin{tikzpicture}
%     \pgfplotsset{small}
%     \matrix {
%         \begin{axis}[
%             width = \textwidth,
%             height = 0.25\textwidth,
%             grid = major,
%             xlabel = {$z / \lambda_0$},
%             ylabel = {$V$ in Volt},
%             xmin = -2,
%             xmax = 4,
%         ]
%             \addplot [color = blue] table [x = z_by_lambda_0, y = V_re]
% 			{thesis_tlgf.dat};
%             \addplot [color = red] table [x = z_by_lambda_0, y = V_im]
% 			{thesis_tlgf.dat};
%         \end{axis}
%         \\
%         \begin{axis}[
%             width = \textwidth,
%             height = 0.25\textwidth,
%             grid = major,
%             xlabel = {$z / \lambda_0$},
%             ylabel = {$I$ in Amp\`ere},
%             xmin = -2,
%             xmax = 4,
%         ]
%             \addplot [color = blue] table [x = z_by_lambda_0, y = I_re]
% 			{thesis_tlgf.dat};
%             \addplot [color = red] table [x = z_by_lambda_0, y = I_im]
% 			{thesis_tlgf.dat};
%         \end{axis}
%         \\
%         \begin{axis}[
%             width = \textwidth,
%             height = 0.25\textwidth,
%             grid = major,
%             xlabel = {$z / \lambda_0$},
%             ylabel = {$Z / Z_0$},
%             ytick = {-2, -1, 0, 1},
%             xmin = -2,
%             xmax = 4,
%         ]
%             \addplot [color = blue] table [x = z_by_lambda_0, y = Z_rel_re]
% 			{thesis_tlgf.dat};
%             \addplot [color = red] table [x = z_by_lambda_0, y = Z_rel_im]
% 			{thesis_tlgf.dat};
%         \end{axis}
%         \\
%         };
%     \end{tikzpicture}
% 	\label{fig:tlgf_example}
% 	\caption[{Example for a typical \acs{TLGF}]
% 	{Example for the \ac{TLGF} $V_{i}^{\mathrm{TM}}$ with $z^\prime = \lambda_0$.
% 	The ground parameters are $\epsr = 9 - \im$ and $\mur = 1$.}
% \end{figure}






Auch im Fall der Leitungen lassen sich in Modelle der Führung von TM-Wellen von entsprechenden Wellenleitern für TE-Wellen unterscheiden. Die ausschlaggebende Größe ist die charakteristische Leitungsimpedanz $Z^\tx$ bzw. -admittanz $Y^\tx$, die sich sich im TM-Fall durch
\begin{equation}
	Z^\tm\left(z\right) = \frac{k_z\left(z\right)}{\omega \varepsilon\left(z\right)}
\end{equation}
und im TE-Fall durch
\begin{equation}
	Y^\te\left(z\right) = \frac{k_{z}\left(z\right)}{\omega \mu\left(z\right)}
\end{equation}
bestimmt. Die Ausbreitungskonstante $k_z$ ist in beiden Fällen gleich.

Für die Definition der Greenschen Funktionen von \eqref{eq:tl_ode_system} gibt es nun
\begin{itemize}
	\item die Möglichkeit
	\begin{subequations}\label{eq:tl_first_order_odes_i_source}
		\begin{align}
			\frac{\dd}{\dd z} V^{\isrc,\tx}\left(z\right) &= -\im k_z Z^\tx I^{\isrc,\tx}\left(z\right) \label{eq:tl_first_order_odes_i_source_homo}\\
			\frac{\dd}{\dd z} I^{\isrc,\tx}\left(z\right) &=-\im k_z Y^\tx V^{\isrc,\tx}\left(z\right) + \diracDelta\left(z-z^\prime\right)
		\end{align}
	\end{subequations}
	der Anregung mit einer impulsförmigen Einheitsstromquelle (oberer Index $\isrc$) bei $z^\prime$, sowie 
	\item den analogen Fall
	\begin{subequations}\label{eq:tl_first_order_odes_v_source}
		\begin{align}
			\frac{\dd}{\dd z} V^{\vsrc,\tx}\left(z\right) &= -\im k_z Z^\tx I^{\vsrc,\tx}\left(z\right) + \diracDelta\left(z-z^\prime\right) \\
			\frac{\dd}{\dd z} I^{\vsrc,\tx}\left(z\right) &=-\im k_z Y^\tx V^{\vsrc,\tx}\left(z\right) \label{eq:tl_first_order_odes_v_source_homo}
		\end{align}
	\end{subequations}
	 mit einer Spannungsquelle (oberer Index $\vsrc$) bei $z^\prime$ als treibender Größe \cite{Michalski2016b}.
\end{itemize}
Aus den Systemen erster Ordnung \eqref{eq:tl_first_order_odes_i_source} und \eqref{eq:tl_first_order_odes_v_source} lassen sich durch Differenziation der einen und Einsetzen der jeweils anderen Gleichung die Gleichungen zweiter Ordnung
\begin{equation}\label{eq:tl_2nd_order_ode_isrc}
	\left(\frac{\dd}{\dd z} \frac{1}{\im k_z Z^\tx} \frac{\dd}{\dd z} + \frac{k_z^2}{\im k_z Z^\tx}\right)  V^{\isrc,\tx} = -\diracDelta\left(z-z^\prime\right)
\end{equation}
und
\begin{equation}\label{eq:tl_2nd_order_ode_vsrc}
	\left(\frac{\dd}{\dd z} \frac{1}{\im k_z Y^\tx} \frac{\dd}{\dd z} + \frac{k_z^2}{\im k_z Y^\tx}\right)  I^{\vsrc,\tx} = -\diracDelta\left(z-z^\prime\right)
\end{equation}
gewinnen. Durch Vergleich erkennt man die Dualität zwischen \eqref{eq:TE_ODE_GF} und \eqref{eq:tl_2nd_order_ode_isrc} sowie \eqref{eq:TM_ODE_GF} und \eqref{eq:tl_2nd_order_ode_isrc}. Damit lassen sich die Lösungen von \eqref{eq:TE_ODE_GF} und \eqref{eq:TM_ODE_GF} durch die wohlbekannten Greenschen Funktionen der Leitungsgleichungen ausdrücken.

So ergibt der Vergleich von \eqref{eq:TE_ODE_GF} mit \eqref{eq:tl_2nd_order_ode_isrc} im TE-Fall
\begin{equation}\label{eq:G_tilde_TE_tl_quantities}
	\tilde{G}^\te \equiv \frac{1}{\im \omega} V^{\isrc,\te} \,
\end{equation}
der Vergleich von \eqref{eq:TM_ODE_GF} mit \eqref{eq:tl_2nd_order_ode_vsrc} im TM-Fall liefert
\begin{equation}\label{eq:G_tilde_TM_tl_quantities}
	\tilde{G}^\tm \equiv \frac{1}{\im \omega} I^{\vsrc,\tm} \, .
\end{equation}

Aus der Leitungstheorie \cite{Pozar2011} sind wesentliche Aspekte der Wellenausbreitung von Spannung und Stromstärke auf Leitungen, die durch \eqref{eq:tl_ode_system_dI} und \eqref{eq:tl_ode_system_dV} beschrieben werden, bekannt. So sind beispielsweise Spannung und Strom außerhalb von Quellregionen -- im vorliegenden Kontext also für $z \neq z^\prime$ -- stetig. Ein Vergleich von \eqref{eq:G_tilde_TE_tl_quantities} und \eqref{eq:G_tilde_TM_tl_quantities} mit \eqref{eq:B_continuity} und \eqref{eq:D_continuity} legt daher offen, dass die Lösung über die Netzwerk-Methode bereits eine der an die Stetigkeit der charakteristischen Feldkomponenten erfüllt. Dass auch die Bedingungen \eqref{eq:H_z_tilde_second_continuity_condition} und \eqref{eq:E_z_tilde_second_continuity_condition} automatisch erfüllt ist, lässt sich durch Einsetzten der Lösung für $V^{\isrc,\te}$ in \eqref{eq:tl_first_order_odes_i_source_homo} und jener für $I^{\vsrc,\tm}$ in \eqref{eq:tl_first_order_odes_v_source_homo} erkennen. Man erhält dadurch
\begin{equation}
	\frac{1}{\mu} \frac{\dd}{\dd z} \tilde{G}^\te \equiv - I^{\isrc,\te}
\end{equation}
sowie
\begin{equation}
	\frac{1}{\varepsilon} \frac{\dd}{\dd z} \tilde{G}^\tm \equiv - V^{\vsrc,\tm} \,,
\end{equation}
für $z \neq z^\prime$ sind also \eqref{eq:H_z_tilde_second_continuity_condition} und \eqref{eq:E_z_tilde_second_continuity_condition} ebenfalls befriedigt.

Damit sind die Greenschen Funktionen der charakteristischen Komponenten $\tilde{H}_z$ und $\tilde{E}_z$ von TE bzw. TM-Feldern im $k_\rho$-Spektralbereich auf die in \cref{app:tl_greens_functions} zusammengefassten bekannten Greenschen Funktionen für Spannung und Stromstärke Übertragungsleitungen zurückgeführt.

\subsection{Image principle}

Scalar GF over PEC/PMC. \cite[p. 250]{Sommerfeld1964}


\section{Numerical Computation of Sommerfeld Integrals}

\subsection{Asymptotic Methods}

\subsection{Numerical Integration}

\subsection{Discrete Complex Image Method}


\section{Fast Multipole Method for the Helmholtz Equation}

\subsection{Definitions}

The following considerations concerning the \ac{FMM} use the geometrical
assumptions elucidated by \cref{fig:fmm_geometry}. The solution domain is
subdivided into cubical group boxes of side length $w$.
Note that $\rdiff$ can be written as the sum of three vectors. These, as well
as the possible ground are aligned with the global Cartesian coordinate system.

Based on this grouping scheme $\rdiff$ can be written as
\begin{equation}
	\rdiff =
	\left( \robs - \fmmObsGroupCenter              \right) +
	\left( \fmmObsGroupCenter - \fmmSrcGroupCenter \right) -
	\left( \rsrc - \fmmSrcGroupCenter              \right) \, ,
\end{equation}
where $\fmmSrcGroupCenter$ and $\fmmObsGroupCenter$ denote the centers of
source and observation boxes, respectively.
Based on this notation the shorthand notations 
$\fmmDiffGroupCenters \coloneqq \fmmObsGroupCenter - \fmmSrcGroupCenter$
and 
$\pvec{d} \coloneqq \left( \robs - \fmmObsGroupCenter \right) - \left( \rsrc - \fmmSrcGroupCenter \right)$
are introduced.

\begin{figure}
	\centering
	\begin{tikzpicture}
		[scale = 0.7]
		
		\newcommand{\w}{3}
		\newcommand{\dotsize}{1.5pt}
		
		\coordinate(r_s) at (1.5*\w,0.5*\w);
		\coordinate(r_o) at ($(r_s) + (2*\w,\w)$);
		\coordinate(r_prime) at ($(r_s) + (0.2*\w,0.45*\w)$);
		\coordinate(r) at ($(r_o) + (-0.3*\w,0.3*\w)$);
		
		% Ground
		\fill[color = blue!30!white] (-0.5*\w,0) rectangle (4.5*\w,-1.5*\w);
		
		% Coordinate system
		\draw [color=gray!20]  [step=\w] (-0.5*\w,-1.5*\w) grid (4.5*\w,2.5*\w);
		\draw[->,>=stealth] (-0.75*\w,0) -- (4.75*\w,0) node[right] {$x$, $y$};
		\draw[->,>=stealth] (0,-1.75*\w) -- (0,2.75*\w) node[above] {$z$};
		\foreach \c in {1,2,3,4}{\draw (\c*\w,-.1) -- (\c*\w,.1) node[below=4pt] {$\c w$};}
		\foreach \c in {1,2}{\draw (-0.1,\c*\w) -- (0.1,\c*\w) node[left=4pt] {$\c w$};}
		\draw (-0.1,-0.1) node[below left] {$0$};
		
		% Vectors
		\draw[->, >=stealth] (r_s) -- node[below]{$\fmmDiffGroupCenters$} (r_o);
		\draw[->, >=stealth, line width=1.0pt, red] (r_prime) -- node[above]{$\rdiff$} (r);
		\draw[->, >=stealth] (r_prime) -- node[left]{$\fmmSrcGroupCenter - \rsrc$} (r_s);
		\draw[->, >=stealth] (r_o) -- node[right]{$\robs - \fmmObsGroupCenter$} (r);
		
		% Points
		\fill (r) circle (\dotsize) node[above]{$\robs$};
		\fill (r_prime) circle (\dotsize) node[above]{$\rsrc$};
		\fill (r_s) circle (\dotsize) node[below]{$\fmmSrcGroupCenter$};
		\fill (r_o) circle (\dotsize) node[below]{$\fmmObsGroupCenter$};
		
		% Group boxes
		\draw($(r_s) - (\w/2,\w/2)$) rectangle ($(r_s) + (\w/2,\w/2)$);
		\draw($(r_o) - (\w/2,\w/2)$) rectangle ($(r_o) + (\w/2,\w/2)$);
		
	\end{tikzpicture}

	\caption[\acs{FMM} geometry]
	{Geometric definition of the \ac{FMM} implementation.}
	\label{fig:fmm_geometry}
\end{figure}

\subsection{Conventional Free-Space Approach}

The classical derivation of the \ac{FMM} for the free-space Green's function
of the Helmholtz equation is based on two elementary identities.

The first identity is, in a more general form, referred to as Gegenbauer's
addition theorem by handbooks on mathematical functions
\cite[eq. 10.23.8]{Olver2010} \cite[9.1.80]{Abramowitz2014}.
A more specialized version also plays a role in analytical field theory where
\cite[p.~414]{Stratton2007}
\begin{equation}\label{eq:addition_thrm_spherical_waves_stratton}
	\frac{\exp{-\im k \abs{\rdiff}}}{\abs{\rdiff}} =
	-\im k \sum\limits_{l=0}^{\infty}
	\left(2l + 1\right)
	\legendrepl{l} \left( \uv{r} \cdot \uv{r^\prime} \right)
	\begin{cases}
		\sphbesselj{l}    \left( k r        \right)
		\sphbesselh{2}{l} \left( k r^\prime \right)
		& r < r^\prime \\
		\sphbesselj{l}    \left( k r^\prime \right)
		\sphbesselh{2}{l} \left( k r        \right)
		& r > r^\prime
	\end{cases}
\end{equation}
is known as the \emph{addition theorem for spherical wave functions}
\cite[p.~362]{Jin2015}.
The expression on the right-hand side expands an offset spherical wave
($\rsrc \neq 0$) by a series of spherical waves centered at the origin.

The identity desired towards the \ac{FMM} is obtained from
\eqref{eq:addition_thrm_spherical_waves_stratton} by flipping the sign of 
$\rsrc$ for $r > r^\prime$.
Using the notation of \cref{fig:fmm_geometry}, it is given by
\begin{corollary}[Gegenbauer's addition theorem]
	Let $\pvec{t}, \pvec{d} \in \R^3$, $d < t$, $k \in \C$ and
	\eqref{eq:addition_thrm_spherical_waves_stratton} be given.
	Then Gegenbauer's addition reads
	\begin{equation}\label{eq:fmm_std_gegenbauer}
		\frac{\exp{-\im k \abs{\pvec{t} + \pvec{d}}}}{\abs{\pvec{t} + \pvec{d}}} = 
		-\im k \sum\limits_{l=0}^{\infty}
		\left( -1 \right)^l
		\left( 2l + 1 \right) \,
		\sphbesselj{l} \left( k d  \right) \,
		\sphbesselh{2}{l} \left( k t \right) \, 
		\legendrepl{l} \left( \uv{d} \cdot \uv{t} \right) \, .
	\end{equation}
\end{corollary} 

\begin{proof}
	\fxnote{TODO}
\end{proof}

The second major identity towards \ac{FMM} expands the product 
$\sphbesselj{l} \left( k b \right) \legendrepl{l} \left( \uv{b} \cdot \uv{a} \right)$
into an integral of weighted propagating plane waves. For compact notation, it
is useful to introduce
\begin{definition}[Ewald sphere of propagating plane waves]\label{def:ewald_sphere}
	Let $S^2$ denote the unit sphere in $\R^3$. Then
	integrals of the form
	\begin{equation}\label{eq:ewald_sphere_integral}
		\ewaldintegral \left(\uv{k}\right) 
		\coloneqq
		\int\limits_{\phi = 0}^{2\pi} \int\limits_{\theta = 0}^{\pi}
		\sin\left(\theta \right) \dd \theta \dd \phi \, ,
	\end{equation}
	where
	\begin{equation}
		\uv{k} =
		\uv{x} \sin \left(\theta\right) \cos \phi +
		\uv{y} \sin \left(\theta\right) \sin \phi +
		\uv{z} \cos \theta \, ,
	\end{equation}
	are called \emph{integrals over the Ewald sphere of propagating plane waves}.
\end{definition}
With this notation the desired identity reads
\begin{equation}\label{eq:fmm_jP_expansion_plane_waves}
		\sphbesselj{l} \left( k b    \right) \,
		\legendrepl{l} \left( \uv{b} \cdot \uv{a} \right) = 
		\frac{\im^l}{4\pi}	
		\ewaldintegral
		\exp{-\im \pvec{k} \cdot \pvec{b}}
		\legendrepl{l} \left( \uv{k} \cdot \uv{a} \right)
\end{equation}
Note that is a special case of another wave expansion well-established in
electromagnetic theory \cite[p.~410]{Stratton2007}.

Substituting \eqref{eq:fmm_jP_expansion_plane_waves} into
\eqref{eq:fmm_std_gegenbauer}











\begin{figure}
   \begin{tikzpicture}
    \pgfplotsset{small}
    \matrix {
        \begin{axis}[
            width = \textwidth,
            height = 0.25\textwidth,
            grid = major,
            xlabel = {$z / \lambda_0$},
            ylabel = {$V$ in Volt},
            xmin = -2,
            xmax = 4,
        ]
            \addplot [color = blue] table [x = z_by_lambda_0, y = V_re]
			{thesis_tlgf.dat};
            \addplot [color = red] table [x = z_by_lambda_0, y = V_im]
			{thesis_tlgf.dat};
        \end{axis}
        \\
        \begin{axis}[
            width = \textwidth,
            height = 0.25\textwidth,
            grid = major,
            xlabel = {$z / \lambda_0$},
            ylabel = {$I$ in Amp\`ere},
            xmin = -2,
            xmax = 4,
        ]
            \addplot [color = blue] table [x = z_by_lambda_0, y = I_re]
			{thesis_tlgf.dat};
            \addplot [color = red] table [x = z_by_lambda_0, y = I_im]
			{thesis_tlgf.dat};
        \end{axis}
        \\
        \begin{axis}[
            width = \textwidth,
            height = 0.25\textwidth,
            grid = major,
            xlabel = {$z / \lambda_0$},
            ylabel = {$Z / Z_0$},
            ytick = {-2, -1, 0, 1},
            xmin = -2,
            xmax = 4,
        ]
            \addplot [color = blue] table [x = z_by_lambda_0, y = Z_rel_re]
			{thesis_tlgf.dat};
            \addplot [color = red] table [x = z_by_lambda_0, y = Z_rel_im]
			{thesis_tlgf.dat};
        \end{axis}
        \\
        };
    \end{tikzpicture}
    \caption[]{A TLGF}
\end{figure}