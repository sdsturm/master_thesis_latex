\part{Theoretical Considerations}






\chapter{Mathematical Preliminaries}
\label{ch:math_preliminaries}

The aim of this chapter is, in first place, to provide a unified
treatment of major ideas and theorems which form the foundation of the study
of electromagnetic ware propagation in half-space environments and
multilayered media.
Secondly, important consequences for the topic at hand---namely the computation
of highly accurate reference results and the aspired combination of the \ac{FMM}
with the Sommerfeld problem's solution domain---are pointed out.




\section{Notation}

Let the following notes regarding notation prepended this chapter.
\begin{description}
	\item[Complex numbers:] Real and complex numbers are marked in the
	respective context if necessary. For a complex number $z \in C$ the complex 
	conjugate is denoted by $\complexConjugate{z}$ and the absolute value of
	$z$ is written as $\abs{z} = \sqrt{z \complexConjugate{z}}$.
	\item[Physical vectors:] Vectors in $\R^3$ a physical meaning are denoted in
	bold and italic serif font, \eg, the position vector $\pvec{r}$.
	Source points are marked by a prime, observation points are unprimed.
	Unit vectors are marked as $\uv{u}$.
	\item[Linear algebra:] Entities with reference to linear algebra,~\ie,
	matrices and vectors are denoted in bold, italic and sans-serif font.
	Matrices, \eg, $\mat{A}$, are distinguished from column vectors,~\eg,
	$\vec{v}$, by the use of upper and lower case symbols, respectively.
	\item[Special functions:] The notation of special functions and related
	symbols is in accordance to the NIST Handbook of Mathematical Functions
	\cite{Olver2010}.
\end{description}

Otherwise, if not explicitly labeled, the notation in the present thesis
follows the textbook by \textcite{vanBladel2007}.








\section{Basic Definitions and Terms}
\label{sec:basic_definitions_and_terms}

The following discussions will deal with vectors in various forms therefore
it is adequate to be precise about
\begin{definition}[Vector space {\cite[73]{heuser2006}}]
	Let $\F$ be a field (in particular $\F = \R,\C$). A \emph{vector space
	over} $\F$ (or $\F$-vector space) is a nonempty set $\mathcal{V}$, whose
	elements are called \emph{vectors} and in which the following two operations
	are defined:
	\begin{enumerate}
		\item Addition: To every pair of vectors $x, y \in \mathcal{V}$ there
		corresponds a vector $x + y$, in a way such that
		\begin{enumerate}[label=(\alph*)]
			\item $x + y = y + x$
			\item $x + \left(y + z\right) = \left(x + y\right) + z$
			\item $\mathcal{V}$ contains a unique \emph{zero vector} $0$ such
			that $x + 0 = x \forall x \in \mathcal{V}$
			\item To each $x \in \mathcal{V}$ there exists a unique
			$-x \in \mathcal{V}$ such that $x + \left(-x\right) = 0$
		\end{enumerate}
		\item Scalar multiplication: To every pair $(a, x)$ of a scalar
		$\alpha \in \F$ and a vector $x \in \mathcal{V}$ there corresponds a
		vector $\alpha x \in \mathcal{V}$, in such a way that
		\begin{enumerate}[label=(\alph*), start = 5]
			\item $\alpha \left(\beta\right) = \left(\alpha \beta\right) x$ for
			all $\beta \in \F$ 
			\item $1 x = x$
		\end{enumerate}
		These operations satisfy the distributive laws
		\begin{enumerate}[label=(\alph*), start = 7]
			\item $\alpha \left(x + y\right) = \alpha x + \alpha y$
			\item $\left(\alpha + \beta\right) x = \alpha x + \beta x$.
		\end{enumerate}
	\end{enumerate}
\end{definition}

In the geometrical context we have to express vectors by means of coordinates
and basis vectors in order to perform actual computations.
The definition of the three major orthonormal coordinate systems in which a
vector $\pvec{r} \in \R^3$ can be represented shall be based on 
\begin{definition}[Cartesian coordinate system]
	Let $\pvec{r}$ be an arbitrary vector in $\R$ and let that the
	basis vectors $\left\{\uv{x}, \uv{y}, \uv{z}\right\}$ be orthonormal and
	constant for all $\pvec{r} \in \R^3$.
	Then the representation of $\pvec{r}$ in the \emph{Cartesian coordinate
	system} is given by
	\begin{equation}
		\pvec{r} = \uv{x}x + \uv{y}y + \uv{z},
	\end{equation}
\end{definition}
The representation of a vector $\pvec{r} \in \R^3$ in Cartesian coordinates
relates to the common curvilinear systems according to the following two
definition.
\begin{definition}[Cylindrical coordinate system]
	\label{def:cyl_coords}
	Let a vector in $\R^3$ be given in Cartesian coordinates and unit vectors
	by $\uv{x}x + \uv{y}y + \uv{z}z$.
	The \emph{cylindrical coordinate system} is defined by 
	\begin{subequations}
		\begin{align}
			&x = \rho \cos \varphi
			\qquad
			&&\uv{x} = \uv{\rho} \cos \varphi - \uv{\varphi}\sin \varphi \\
			&y = \rho \sin \varphi 
			\qquad
			&&\uv{y} = \uv{\rho} \sin \varphi + \uv{\varphi} \cos \varphi\\
			&z = z 
			\qquad
			&&\uv{z} = \uv{z} 
		\end{align}
	\end{subequations}
	and
	\begin{subequations}
		\begin{align}
			&\rho = \sqrt{x^2 + y^2}
			\qquad
			&& \uv{\rho} = \uv{x} \cos \varphi + \uv{y} \sin \varphi \\
			&\varphi = \arctan \frac{y}{x}
			\qquad
			&&\uv{\varphi} = -\uv{x} \sin \varphi + \uv{y} \cos \varphi \\
			&z = z
			\qquad
			&&\uv{z} = \uv{z} \, .
		\end{align}
	\end{subequations}
\end{definition}

\begin{definition}[Spherical coordinate system]
	\label{def:sph_coords}
	Let a vector in $\R^3$ be given in Cartesian coordinates and unit vectors
	by $\uv{x}x + \uv{y}y + \uv{z}z$.
	The \emph{spherical coordinate system} is defined by 
	\begin{subequations}
		\begin{align}
			&x = r \sin \left(\vartheta\right) \cos \varphi
			\qquad
			&&\uv{x} = \uv{r} \sin\left(\vartheta\right) \cos \varphi +
			\uv{\vartheta} \cos\left(\vartheta\right) \cos \varphi -
			\uv{\varphi} \sin \varphi \\
			&y = r \sin \left(\vartheta\right) \sin \varphi
			\qquad
			&&\uv{y} = \uv{r} \sin\left(\vartheta\right) \sin \varphi +
			\uv{\vartheta} \cos\left(\vartheta\right) \sin \varphi +
			\uv{\varphi} \cos \varphi \\
			&z = r \cos \vartheta
			\qquad
			&&\uv{z} = \uv{r} \cos \vartheta - \uv{\vartheta} \sin \vartheta
		\end{align}
	\end{subequations}
	and
	\begin{subequations}
		\begin{align}
			&r = \sqrt{x^2 + y^2 + z^2}
			\qquad
			&&\uv{r} =
			\uv{x} \sin \left(\vartheta\right) \cos \varphi +
			\uv{y} \sin \left(\vartheta\right) \sin \varphi +
			\uv{z} \cos \vartheta \\
			&\vartheta = \arctan \frac{\sqrt{x^2 + y^2}}{z}
			\qquad
			&&\uv{\vartheta} = 
			\uv{x} \cos \left(\vartheta\right) \cos \varphi +
			\uv{y} \cos \left(\vartheta\right) \sin \varphi -
			\uv{z} \sin \vartheta \\
			&\varphi = \arctan \frac{y}{x}
			\qquad
			&&\uv{\varphi} = 
			-\uv{x} \sin \varphi +
			\uv{y} \cos \varphi \, .
		\end{align}
	\end{subequations}
\end{definition}

The notion of a \emph{distance} is familiar in Euclidean geometry,
\ie, in $\R2$ and
$\R3$.
As the term must be extended to complex space in the following, it shall be
pointed out that the usual concept of distance relies on
\begin{definition}[Metric and metric space]\label{def:metric}
	Let $\mathcal{X}$ be a set. A non-negative function
	$d: \mathcal{X} \times \mathcal{X} \mapsto \R$ is called a \emph{metric}
	on $\mathcal{X}$ if it fulfills the following four properties.
	\begin{enumerate}[label=(\alph*)]
		\item $0 \le d\left(x_1, x_2\right) < 0$ for all
		$x_1, x_2 \in \mathcal{X}$
		\item $d\left(x_1, x_2\right) = 0$ if and only if $x_1 = x_2$
		\item $d\left(x_1, x_2\right) = d\left(x_2, x_1\right)$ for all
		$x_1, x_2 \in \mathcal{X}$
		\item $d\left(x_1, x_3\right) \le d\left(x_1, x_2\right) + d\left(x_2, x_3\right)$
		for all $x_1, x_2, x_3 \in \mathcal{X}$
	\end{enumerate}
	A set $\mathcal{X}$ together with a metric $d$ defined on $\mathcal{X}$ is
	called a \emph{metric space} and denoted by $\left(\mathcal{X}, d\right)$.
\end{definition}

From a geometrical point of view the term distance is closely related to
\emph{length}.
Usual axioms regarding length are that a length should be real and non-negative.
These perceptions are predicated on
\begin{definition}[Norm and normed space]\label{def:norm}
	Let $\mathcal{V}$ be a $\F$-vector space.
	A non-negative real-valued functional $x \mapsto \left\Vert x \right\Vert$
	from $\mathcal{V}$ into $\R$ is called a \emph{norm} if
	\begin{enumerate}[label=(\alph*)]
		\item $\norm{x} = 0 \Leftrightarrow x = 0$ 
		\item $\norm{\alpha x} = \abs{\alpha} \norm{x}$ for every
		$x \in \mathcal{V}$ and $\alpha \in \F$
		\item $\norm{x_1 + x_2} \le \norm{x_1} + \norm{x_2}$ for every
		$x_1, x_2 \in \mathcal{V}$.
	\end{enumerate}
	A $\F$-vector space $\mathcal{V}$ together with a norm
	$\left\Vert . \right\Vert$ is called a \emph{normed space} and denoted by
	$\left( \mathcal{V}, \left\Vert . \right\Vert \right)$.
\end{definition}

As it is well known \cite{heuser2006}, vector spaces obtain a set of
mathematically advantageous properties if a metric and a norm can be defined on
them.
The essentially beneficial properties of a Hilbert space become available if,
in addition, an inner product can be defined.
A valid inner product for the Euclidean space is given by
\begin{definition}[Dot product]\label{def:dot_product}
	Let $\C^N$ be a finite-dimensional vector space and
	$\pvec{a}, \pvec{b} \in \C^N$.
	Assume that the coordinates of $\pvec{a}$ and $\pvec{b}$ are given in
	the Cartesian representation.
	Then the \emph{dot product}
	is defined as 
	\begin{equation}
		\pvec{a} \cdot \pvec{b} = \sum\limits_{n = 1}^{N} a_n \bar{b}_n \, ,
	\end{equation}
	where $\bar{b}_n$ denotes the complex conjugate of $b$.
\end{definition}

With \cref{def:dot_product} we also obtain a way to actually compute length
and distance according to the following two definitions.

\begin{definition}[Euclidean norm]\label{def:euclidean_norm}
	Let $\pvec{r} \in \C^3$ arbitrary. Then the \emph{Euclidean norm} of
	$\pvec{r}$ is defined as
	\begin{equation}
		r = \euclideanNorm{\pvec{r}} = \sqrt{\pvec{r} \cdot \pvec{r}} \, .
	\end{equation}
\end{definition}

\begin{definition}[Euclidean metric]\label{def:euclidean_metric}
	Let $\pvec{r}_1, \pvec{r}_2 \in \C^3$ arbitrary. Then the \emph{Euclidean
	metric} is defined as
	\begin{equation}
		d_E\left(\pvec{r}_1 , \pvec{r}_2\right) = 
		\sqrt{
			\left(\pvec{r}_1 - \pvec{r}_2\right)
			\cdot
			\left(\pvec{r}_1 - \pvec{r}_2\right)
		} \, .
	\end{equation}
\end{definition}

\begin{remark}[Euclidean norm notation]
	For notational convenience the subscript $2$ is omitted and---unless
	marked otherwise---the Euclidean norm is assumed by just writing $\norm{.}$
\end{remark}








\section{Fourier Transforms}
\label{sec:fourier_transforms}

Although large portions of the study of electromagnetism heavily rely on the
decomposition of functions into---as well as on the composition of functions
from---spectra of different frequencies, no specific definition of the Fourier
transform prevails throughout the field.
For the ubiquitous Fourier transform with respect to time the present thesis
uses
\begin{definition}[Fourier transform with respect to time]
	\label{def:fourier_transfrom_temporal_forward}
	Let $f \in L^1\left( \R \right)$ be a function of a variable $t \in \R$
	which shall be called \emph{time}.
	Then the \emph{Fourier transform with respect to time} of $f$ is defined as 
	\begin{equation}\label{eq:fourier_transfrom_temporal_forward}
		\tilde{f} \left(\omega\right) = 
		\left( \fourierTransformTemporal f \right) \left(\omega\right) = 
		\tilde{f} \left( \omega \right) =
		\int\limits_{-\infty}^{\infty} \dd t \,
		\exp{-\im \omega t} 
		f\left( t \right)
		\qquad \omega \in \R
		\, ,
	\end{equation}
	where $\omega$ is a parameter called \emph{angular frequency}.
\end{definition}
Provided a transformed function possesses certain well-known properties
\cite{heuser2006, Strichartz2003}, an inverse transform to
\eqref{eq:fourier_transfrom_temporal_forward} exists.
With \cref{def:fourier_transfrom_temporal_forward}  this inverse operation is
given by
\begin{lemma}[Inverse Fourier tansform with respect to time]
	Let $f \in L^1 \left(\R\right)$ such that
	$\tilde{f} \in L^1 \left(\R\right)$. Then the
	inverse Fourier transform with respect to time is given by
	\begin{equation}\label{eq:fourier_transform_temporal_backward}
		f \left(t\right) =
		\left( \fourierTransformTemporalInverse \tilde{f} \right)
		\left( t \right) = 
		\frac{1}{2\pi}
		\int\limits_{-\infty}^{\infty} \dd \omega \,
		\exp{\im \omega t} 
		\tilde{f} \left( \omega \right)
		\qquad t \in \R
		\, .
	\end{equation}
\end{lemma}

\begin{remark}[Time convention]\label{rem:time_convention}
	If the pair of transforms formed by
	\eqref{eq:fourier_transfrom_temporal_forward} and
	\eqref{eq:fourier_transform_temporal_backward} is applied to \acp{ODE}
	or \acp{PDE} containing a differentiation with respect to time, then
	\cref{def:fourier_transfrom_temporal_forward} is equivalent to the
	assumption a time dependency $\propto\exp{\im \omega t}$ for all
	functions of time in $\omega$-spectral domain\footnote{Within the course of
	the present thesis expressions taken from the literature are adapted to the
	$\exp{\im \omega t}$ convention. Some of these, \eg, the work of
	Sommerfeld, originally use the alternative $\exp{-\mathrm{i} \omega t}$
	time convention.
	The conversion to $\exp{\im \omega t}$ is done by the formal substitution
	$\mathrm{i} \to -\im$. In addition, the kinds of Hankel functions,~\ie,
	of propagating cylindrical or spherical waves, must be changed.}.
\end{remark}

Formally, the extension of the concept of Fourier transforms to higher
dimensions is straightforward, as the scalars $t$ and $\omega$ simply become
vectors and their product is replaced by the dot product.
However, one has to take into account some physical reasoning in order to
combine the Fourier transform in with respect to time with corresponding spatial
transforms.
Namely, the spatial counterpart to
\cref{def:fourier_transfrom_temporal_forward} must be defined in the particular
way of
\begin{definition}[Fourier transform with respect to space]
	\label{def:fourier_transfrom_spatial_forward}
	Let $f: \R^3 \mapsto \C$ be a function of a variable $\pvec{r} \in \R^3$
	which shall be called \emph{position} and assume $\pvec{k} \in \C^3$.
	The \emph{Fourier transform with respect to space} is defined as
	\begin{equation}\label{eq:fourier_transform_3space_forward}
		\tilde{f} \left( \pvec{k} \right) = 
		\left( \fourierTransformSpatial f \right) \left( \pvec{k} \right) = 
		\iiint\limits_{\R^3} \dd \pvec{r} \,
		\exp{\im \pvec{k} \cdot \pvec{r}}
		f \left( \pvec{r} \right) \, ,
	\end{equation}
	where $\pvec{k}$ is called \emph{wavevector} and
	$k = \euclideanNorm{\pvec{k}}$ is called \emph{wavenumber}.
\end{definition}
The inverse transform to \eqref{eq:fourier_transform_3space_forward} becomes
\begin{equation}\label{eq:fourier_transform_3space_backward}
	f \left( \pvec{r} \right) = 
	\left( \fourierTransformSpatialInverse \tilde{f} \right) \left(\pvec{r}\right) = 
	\frac{1}{\left( 2\pi \right)^3}
	\iiint\limits_{\R^3} \dd \pvec{k} \,
	\exp{-\im \pvec{k} \cdot \pvec{r}}
	\tilde{f} \left( \pvec{k} \right) \, .
\end{equation}
Based on \cref{def:fourier_transfrom_temporal_forward} and
\cref{def:fourier_transfrom_spatial_forward} the combined four-dimensional pair
of transforms
\begin{equation}\label{eq:fourier_transform_4d_forward}
	\tilde{f} \left( \pvec{k}, \omega \right) = 
	\iiint\limits_{\R^3} \dd \robs
	\int\limits_{-\infty}^{\infty} \dd t \,
	\exp{\im \left( \pvec{k} \cdot \robs - \omega t \right)}
	f \left( \robs, t \right)
\end{equation}
and
\begin{equation}\label{eq:fourier_transform_4d_inverse}
	f \left( \robs, t \right) = 
	\frac{1}{\left(2\pi\right)^4}
	\iiint\limits_{\R^3} \dd \pvec{k}
	\int\limits_{-\infty}^{\infty} \dd \omega \,
	\exp{-\im \left( \pvec{k} \cdot \robs - \omega t \right)}
	\tilde{f} \left( \pvec{k}, \omega \right)
\end{equation}
can be constructed.
Note that the sense of rotation of the kernel phasors is opposing in the
temporal and the spatial parts.

A physical interpretation of \eqref{eq:fourier_transform_4d_inverse} is,
that an arbitrary field $f \left( \robs, t \right)$ can be decomposed 
into an infinite number of \emph{plane waves}---expressed by the
$\exp{-\im \left( \pvec{k} \cdot \robs - \omega t \right)}$ terms---where
the expansion coefficients are given by \eqref{eq:fourier_transform_4d_forward}.
Each one of these individual plane waves solves
the homogeneous scalar wave equation \cite[32]{Sommerfeld1964}
\begin{equation}\label{eq:scalar_wave_equation_physical_domain}
	\left( \laplace - \frac{1}{c^2} \frac{\partial^2}{\partial t^2} \right)	
	\phi \left( \pvec{r}, t \right) = 0
\end{equation}
in the \enquote{physical} $\left(\pvec{r}, t\right)$-domain, where $c$ ist
the velocity of propagation.
However, if the same phasor convention of
\cref{def:fourier_transfrom_temporal_forward} would also be used in
\cref{def:fourier_transfrom_spatial_forward}, the kernel
$\exp{-\im \left( \pvec{k} \cdot \robs + \omega t \right)}$
of the resulting 4D inverse transform satisfies
\eqref{eq:scalar_wave_equation_physical_domain} as well.
The reason why the phasor convention of
\cref{def:fourier_transfrom_spatial_forward} is the physically reasonable choice
under the $\exp{\im \omega t}$ time convention
can be seen if we assume $\pvec{r} = \uv{x} x$ and $\pvec{k} = \uv{x} k_x$
with $x, k_x \in \R$ and $k_x > 0$,~\ie, a lossless right-handed medium.
Then $\exp{-\im \left( \pvec{k} \cdot \robs - \omega t \right)}$ describes
a plane wave whose wave fronts propagate \emph{forward},~\ie, in positive
$x$-direction, as time evolves.
In contrast,
$\exp{-\im \left( \pvec{k} \cdot \robs + \omega t \right)}$
propagates in \emph{backwards}.
Even though a plane wave is not a physical entity in the sense that it carries
an infinite amount of energy, it is physically reasonable that it should
travel forward as time marches on.
Therefore, \cref{def:fourier_transfrom_temporal_forward} and
\cref{def:fourier_transfrom_spatial_forward} constitute a matching pair.

A deeper motivation for the interaction of
\cref{def:fourier_transfrom_temporal_forward} and 
\cref{def:fourier_transfrom_spatial_forward} can be drawn from special
relativity.
It turns out that opposing choices of phasor conventions in
\cref{def:fourier_transfrom_temporal_forward} and
\cref{def:fourier_transfrom_spatial_forward}, respectively, lead to the two
meaningful sign conventions of the metric tensor\footnote{
	$\left( + + + - \right)$ for $\exp{-\mathrm{i} \omega t}$
	and $\left( - - - + \right)$ for $\exp{\im \omega t}$}
describing the structure of the four-dimensional (Minkowski) space-time
continuum \cite[p624]{Jackson2013}\cite{Kaiser2016}.









\section{Hankel Transform}
\label{sec:hankel_transform}

Planar Fourier-type expansion integrals play a predominant role in the study
of wave fields in solution domains with are inhomogeneous only in one
Cartesian direction.
Assume this direction to be the one of $\uv{z}$.
By this choice the expansion plane becomes the plane $z \equiv 0$ of the
Cartesian coordinate system.
Under these assumptions \eqref{eq:fourier_transform_3space_forward}
and \eqref{eq:fourier_transform_3space_backward} reduce to the pair
\begin{equation}\label{eq:fourier_transform_2space_forward}
	\tilde{f} \left(k_\rho, k_\varphi, z\right) = 
	\int\limits_{0}^{\infty} \dd \rho \, \rho
	\int\limits_{0}^{2\pi} \dd \varphi \, 
	\exp{\im k_\rho \rho \cos \left(k_\varphi - \varphi\right)}
	f \left(\rho, \varphi, z\right)
\end{equation}
and
\begin{equation}\label{eq:fourier_transform_2space_backward}
	f \left(\rho, \varphi, z\right) = 
	\frac{1}{\left(2\pi\right)^2}
	\int\limits_{0}^{\infty} \dd k_\rho \, k_\rho
	\int\limits_{0}^{2\pi} \dd k_\varphi \, 
	\exp{-\im k_\rho \rho \cos \left(k_\varphi - \varphi\right)}
	\tilde{f} \left(k_\rho, k_\varphi, z\right)
	\, ,
\end{equation}
where the geometrical meaning of the dot product is incorporated.
Note that $z = \uv{z} \cdot \pvec{r}$ is unaffected by the integral in
\eqref{eq:fourier_transform_2space_forward}.
It is therefore sufficient to consider only $f = f\left(\rho, \varphi\right)$
and $\tilde{f} \left(k_\rho, k_\varphi\right)$,~\ie, to use planar polar
coordinates.

Assume further that both functions $f$ and $\tilde{f}$ possess---or
can be coordinate-transformed to obtain---azimuthal symmetry,~\ie, the
functions do not depend on the coordinate $\varphi$ in \cref{def:cyl_coords}.
For such functions of azimuthal symmetry the 2D integrals in 

Under certain conditions the two-dimensional integrals in
\eqref{eq:fourier_transform_2space_forward} and 
\eqref{eq:fourier_transform_2space_backward} can be reduced to integral
transforms with cylinder function kernels and integration only over one
variable.
Such transforms are referred to as Hankel transforms or, synonymously,
Fourier-Bessel transforms in mathematical context.
As the Hankel transform is essentially a special case of a two-dimensional
Fourier transform, the specific shape of the former depends on the choice of
definition of the latter,~\ie, on \cref{def:fourier_transfrom_temporal_forward}.

The following result gives the Hankel transform as it is obtained on the
basis of \cref{def:fourier_transfrom_temporal_forward} and
\cref{def:fourier_transfrom_spatial_forward} as well as a proof for this
connection\footnote{The proof treats the derivation of the inverse Hankel
transform. A corresponding approach for the forward transform can be found
in the book by \textcite[p229]{Davies2002}}.
Details regarding the function spaces on which the Hankel transform pair is
defined can be found in specialized literature \cite{Patra2018,Davies2002}.

\begin{corollary}[Hankel transform and inverse Hankel transform]
	\label{coll:hankel_transform}
	The Hankel transform of order $\nu$ of a function $f\left(\rho\right)$ is
	given by
	\begin{equation}\label{eq:hankel_transform}
		\tilde{f}_\nu \left(k_\rho\right) =
		\left( \hankelTransform{\nu} f \right) \left(k_\rho\right) = 
		2\pi
		\int\limits_{0}^{\infty} \dd \rho \, \rho
		\besselj{\nu}\left(k_\rho \rho\right)
		f\left(\rho\right) \, ,
	\end{equation}
	where $\besselj{\nu}$ is the cylindrical Bessel function of first kind and
	of order $\nu$.
	The inverse Hankel transform is given by
	\begin{equation}\label{eq:hankel_transform_inverse}
		f\left(\rho\right) =
		\left( \hankelTransformInverse{\nu}\tilde{f}\right) \left(\rho\right) =
		\frac{1}{2\pi}
		\int\limits_{0}^{\infty} \dd k_\rho \, k_\rho
		\besselj{\nu}\left(k_\rho \rho\right)
		\tilde{f}_\nu\left(k_\rho\right) \, .
	\end{equation}
\end{corollary}
\begin{proof}
	Consider both $f = \left(\rho, \varphi\right)$ and
	$\tilde{f} \left(k_\rho, k_\varphi\right)$ in planer polar coordinates.
	With this, both functions are periodic with $2\pi$ in $\varphi$ and
	$k_\varphi$, respectively.
	Therefore, they can be expressed by Fourier series expansions
	\begin{equation}\label{eq:ht_proof_f_fourier_series}
		f \left(\rho,\varphi\right) =
		\sum_{\forall m \in \Z}
		f_m \left(\rho\right)
		\exp{\im m \varphi}
	\end{equation}
	and
	\begin{equation}\label{eq:ht_proof_f_tilde_fourier_series}
		\tilde{f} \left(k_\rho, k_\varphi\right) = 
		\sum_{\forall n \in \Z}
		\tilde{f}_n \left(k_\rho\right)
		\exp{\im n k_\varphi}
		\, ,
	\end{equation}
	in these arguments, where the expansion coefficients are determined by
	\begin{equation}\label{eq:ht_proof_f_fourier_coeffs}
		f_m\left(\rho\right) = \frac{1}{2\pi}
		\int\limits_{0}^{2\pi} \dd \varphi \,
		\exp{-\im m \varphi}
		f \left(\rho, \varphi\right)
	\end{equation}
	and
	\begin{equation}\label{eq:ht_proof_f_tilde_fourier_coeffs}
		\tilde{f}_n \left(k_\rho\right) = \frac{1}{2\pi}
		\int\limits_{0}^{2\pi} \dd k_\varphi \,
		\exp{-\im n k_\varphi}
		\tilde{f} \left(k_\rho, k_\varphi\right)
		\, ,
	\end{equation}
	respectively.
	The inverse transform \eqref{eq:hankel_transform_inverse} shall be derived
	first.
	To do so, \eqref{eq:fourier_transform_2space_backward} is substituted into
	\eqref{eq:ht_proof_f_fourier_coeffs} to obtain
	\begin{equation}\label{eq:ht_proof_triple_integral}
		f_m \left(\rho\right)  =
		\frac{1}{\left(2\pi\right)^3}
		\int\limits_{0}^{2\pi} \dd \varphi
		\exp{-\im m \varphi}
		\int\limits_{0}^{\infty} \dd k_\rho \, k_\rho
		\int\limits_{0}^{2\pi} \dd k_\varphi \, 
		\exp{-\im k_\rho \rho \cos \left(k_\varphi - \varphi\right)}
		\sum_{\forall n \in \Z}
		\tilde{f}_n \left(k_\rho\right) \exp{\im n k_\varphi}
		\, ,
	\end{equation}
	where $\tilde{f}$ is expressed by its Fourier series representation
	\eqref{eq:ht_proof_f_tilde_fourier_series}.
	Defining $\alpha \coloneqq k_\varphi - \varphi$ allows to express the
	two exponentials of $-\im m \varphi$ and $\im n k_\varphi$ as functions
	of the same variable.
	The orthogonality relations for trigonometric functions reveal that
	all terms but the one for $m = n$ in the sum in
	\eqref{eq:ht_proof_triple_integral} vanish.
	Hence, \eqref{eq:ht_proof_triple_integral} is essentially
	\begin{equation}\label{eq:ht_proof_after_orthogonality}
		f_m \left(\rho\right) = 
		\frac{1}{\left(2\pi\right)^2}
		\int\limits_{0}^{\infty} \dd k_\rho \, k_\rho
		\int\limits_{0}^{2\pi} \dd \alpha \,
		\exp{-\im k_\rho \rho \cos \alpha}
		\exp{\im m \alpha}
		\tilde{f}_m \left(k_\rho\right)
		\, .
	\end{equation}
	The inner integral in \eqref{eq:ht_proof_after_orthogonality} is identified
	as a form of Bessel's integral \cite[(10.19.2)]{Olver2010} for integer
	Bessel functions of integer order \cite[314]{Davies2002}.
	With this \eqref{eq:ht_proof_after_orthogonality} can be written as
	\begin{equation}
		f_m \left(\rho\right) =
		\frac{1}{2\pi}
		\int\limits_{0}^{\infty} \dd k_\rho \,
		\besselj{m}\left(k_\rho \rho\right) k_\rho
		\tilde{f}m \left(k_\rho\right)
		\, ,
	\end{equation}
	which is the inverse Hankel transform \eqref{eq:hankel_transform_inverse}.
	The connection of the forward transform \eqref{eq:hankel_transform}
	to \eqref{eq:fourier_transform_2space_forward} can be shown in the same
	manner.
\end{proof}

By inspection of \eqref{eq:ht_proof_after_orthogonality} and 
\eqref{eq:ht_proof_f_tilde_fourier_coeffs} some vivid insight can be gained
regarding the role of the order $\nu$ in Hankel transform integrals. 
Consider the inverse transform \eqref{eq:hankel_transform_inverse} which
is of particular importance in the context of electromagnetic wave propagation
in media of planar inhomogeneity.
The expansion \eqref{eq:ht_proof_f_tilde_fourier_series} represents a
spectral domain function $\tilde{f}$ with a \emph{general} dependency on both
$k_\rho$ and $k_\varphi$, where the expansion coefficients are given by
\eqref{eq:ht_proof_f_tilde_fourier_coeffs}.
By contrast to the infinite number of non-vanishing expansion coefficients
$\tilde{f}_n$ in $k_\vartheta$ in this general function, the Hankel transform
of order $\nu = 0$ considers only the zeroth coefficient,
see \eqref{eq:ht_proof_after_orthogonality}.
Therefore, the zeroth-order inverse Hankel transform is especially suited for
functions spectral domain function $\tilde{f}$ of
\emph{azimuthal symmetry} around the cylindrical
$z$-axis\footnote{Off-centered functions of azimuthal
symmetry can be considered by straightforward transformation of variables.}.
For all spectral domain functions $\tilde{f}$ which vary in $k_\varphi$, the
inverse Hankel transform with $\nu = 0$ would perform angular averaging, which
is readily observed from \eqref{eq:ht_proof_f_tilde_fourier_coeffs}.
However, the inverse Hankel transform of order $\nu = 1$ is able to represent
first-order harmonic variation of $\tilde{f}$ in $k_\varphi$.
The second order transform is amenable to second order harmonic variation in
$k_\varphi$ and so on.

\fxnote{Check this paragraph}
This observation of a central mathematical property of the integral transforms
given by \cref{coll:hankel_transform} directly leads the use case in
electromagnetic theory.
In the study of wave fields in media of planar inhomogeneity the spatial domain
fields are represented by inverse Hankel transforms whose counterparts in the 
$k_\rho$-spectral-domain are known in analytical form.
As it turns out, these functions are either azimuthally symmetric,~\ie,
independent of $k_\varphi$, or depend on $k_\varphi$ via trigonometric
functions. 
Here, a prominent feature of the representation of spatial domain fields in
terms of Hankel transforms becomes clear: the trigonometric variation of the
spectral function $\tilde{f}$
can be moved outside the Hankel transform integral, while this is not
possible in \eqref{eq:fourier_transform_2space_backward}.
Thus, the two-dimensional integral over $\R^2$ is reduced to a single
semi-infinite integral.
This makes the form of \eqref{eq:hankel_transform_inverse} especially appealing
for the straightforward evaluation by numerical integration.







\chapter{Scalar Case}
\label{ch:scalar_case}







\section{Helmholtz Equation and Green's Function of Free Space}
\label{sec:helmholtz_eq_and_gf}

Let the following definitions prefix the present section.
\begin{definition}[Domain]
	An open, simply connected subset of a finite dimensional vector space or
	the complex plane $\C$ is
	called a \emph{domain}.
\end{definition}
\begin{definition}[Closure]
	Let $\Omega$ be a domain.
	The set $\overline{\Omega}$ consisting of $\Omega$ and all its limit points
	is called \emph{closure} of $\Omega$.
\end{definition}
\begin{definition}[Boundary]
	Let $\Omega \subset \R^3$ be a domain with closure $\overline{\Omega}$.
	The set $\partial\Omega \coloneqq \overline{\Omega}\setminus\Omega$
	is called \emph{boundary} of $\Omega$.
\end{definition}

The scalar wave equation \eqref{eq:scalar_wave_equation_physical_domain}
is a \ac{PDE} equation both in space and in time.
By application of \eqref{eq:fourier_transfrom_temporal_forward} to
\eqref{eq:scalar_wave_equation_physical_domain} the scalar Helmholtz equation
\begin{equation}\label{eq:scalar_helmholtz_equation}
	\left( \laplace + k^2 \right) \phi \left( \robs, \omega \right) = 0
	\qquad \omega = \mathrm{const.}
\end{equation}
is obtained, where $k = \omega / c$.
Note that $\omega$ is no variable but a parameter of the problem.
Hence, \eqref{eq:scalar_helmholtz_equation} is a \ac{PDE} in space only.
Moreover, in the common scheme of classification \cite[38]{Sommerfeld1964},
the \ac{PDE} changes from hyperbolic to elliptic type by transition from
\eqref{eq:scalar_wave_equation_physical_domain} to
\eqref{eq:scalar_helmholtz_equation}\footnote{For this reason the present
thesis avoids using the term \enquote{wave equation} for
\eqref{eq:scalar_helmholtz_equation}, although this terminology is frequently
used in the literature \cite[238]{Sommerfeld1964}\cite{Coifman1993}}.

The \ac{PDE} \eqref{eq:scalar_helmholtz_equation} does not uniquely define
its solutions.
However, it models such central physical phenomena like sonic waves
and---in its vectorized form---electromagnetic waves including light.
As there is no randomness observed in such waves,
\eqref{eq:scalar_helmholtz_equation} has to be supplemented by appropriate
boundary conditions to make a solution unique.
For the case of an unbounded solution domain, the physically appropriate
boundary condition is given by
\begin{definition}[Sommerfeld radiation condition]
	\label{def:sommerfeld_radiation_condition}
	Let $f: \R^3 \mapsto \C$ be a function with support on a finite domain
	$\Omega \subset \R^3$ and assume $k \in \R$ with $k > 0$.
	Then a solution $\phi$ to
	\begin{equation}\label{eq:scalar_helmholtz_equation_inhomogeneous}
		\left( \laplace + k^2 \right) \phi \left( \robs \right) =
		f \left( \robs \right)
	\end{equation}
	is said to obey the \emph{Sommerfeld radiation condition} if it fulfills
	\cite{Sommerfeld1912}\cite{schot1992}
	\begin{equation}\label{eq:sommerfeld_radiation_condition}
		\lim_{r \to \infty}
		r \left( \frac{\partial}{\partial r} + \im k \right)
		\phi \left( r \right) = 0
		\, .
	\end{equation}
\end{definition}

The Sommerfeld condition ensures that a solution $\phi$ is a \emph{physical}
solution as it carries energy \emph{away} from the source region $\Omega$ and is
asymptotically small for $\lim_{r \to \infty}$.
Furthermore, it can be shown \cite[p190]{Sommerfeld1964} that such a function
$\phi$ is the uniquely defined solution to
\eqref{eq:scalar_helmholtz_equation_inhomogeneous}
\begin{theorem}[Uniqueness]
	A solution $\phi$ to \eqref{eq:scalar_helmholtz_equation_inhomogeneous}
	for open boundary conditions which obeys
	\eqref{eq:sommerfeld_radiation_condition} is unique.
\end{theorem}

In order to solve \eqref{eq:scalar_helmholtz_equation} for the general
inhomogeneous case, it is beneficial first to consider the problem of Green's
function.
The Green's function is defined with $f$ in
\eqref{eq:scalar_helmholtz_equation_inhomogeneous} being a source function
according to
\begin{definition}[Delta function]\label{def:dirac_delta}
	Let $\robs$ and $\rsrc$ be two vectors in the Euclidean vector space
	$\F^N$, where $\F \in \left\{\R, \C\right\}$ and
	$N \in \left\{1, 2, 3\right\}$.
	Then the $N$-dimensional \emph{delta function}\footnote{The concept is
	termed \emph{function} here as the formal \cref{def:dirac_delta} is
	sufficient for the present thesis purposes.
	There is no benefit in a deeper consideration resorting to the theory of
	distributions\cite{Strichartz2003}.} is denoted by
	$\diracDelta$ and formally defined by the properties:
	\begin{enumerate}[label=(\alph*)]
		\item Point source behavior: for arbitrary $\Omega \subset \F^N$ we
		have
		\begin{equation}
			\int\limits_{\Omega} \dd \pvec{r} \,
			\diracDelta \left( \robs - \rsrc \right)
			\begin{cases*}
				1 & $\rsrc \in \Omega$ \\
				0 & \text{else} \, .
			\end{cases*} 
		\end{equation}
		\item Sifting functional: for a test function $\phi$ 
		\cite{Strichartz2003}\cite[35]{Olver2010} we have
		\begin{equation}\label{eq:delta_filter_property}
			\int\limits_{\F^N} \dd \pvec{r} \,
			f \left( \robs \right)
			\diracDelta \left(\robs-\rsrc\right) =
			f \left( \rsrc \right)
			\, .
		\end{equation}
	\end{enumerate}
\end{definition}

The Green's function of the Helmholtz equation for the important case of
constant $k$ is given by the well-known \cite{Jackson2013}
\begin{corollary}[Free-space Green's function]\label{coll:free_space_gf}
	Let $\rsrc, \robs \in \R^3$ with $\robs \neq \rsrc$ and assume
	$k$ to be a constant function of $\robs$ with $\imag{k} \leq 0$.
	Furthermore, let valid solutions to
	\eqref{eq:scalar_helmholtz_equation_inhomogeneous} be restricted by
	\cref{def:sommerfeld_radiation_condition}.
	Then
	\begin{equation}\label{eq:scalar_free_space_gf}
		G_0 \left( \rdiff \right) =
		\frac{\exp{-\im k \rdiffNorm}}{4\pi \rdiffNorm}
	\end{equation}
	is the unique solution to \eqref{eq:scalar_helmholtz_equation} for
	$\diracDelta$-excitation at $\rsrc$.
\end{corollary}

Clearly, $G_0$ represents an outward propagating spherical scalar wave 
centered at $\rsrc$.
Subsequently, the shortcuts $\rdiffSymbol \coloneqq \rdiff$ and
$\rdiffNormSymbol = \norm{\pvec{R}}$ shall be used for notational convenience.








\section{Helmholtz Equation for Problems of Azimuthal Symmetry}
\label{sec:helmholtz_eq_az_symmetry}

In Green's function problems arising in the area of electromagnetic waves
in plane stratified media the inhomogeneous medium is characterized by
$k = k\left(z\right)$.
The sole functional dependency of the wavenumber on the Cartesian and cylindrical 
$z$-coordinate can be employed to reduce the governing Helmholtz
equation \eqref{eq:scalar_free_space_gf} to an \ac{ODE}.

The second circumstance on which this simplification relies is the fact that 
the driving force in a Green's function problem is \emph{point-like}.
By transformation of variables this point source can be brought to
coincidence with the $z$-axis in cylindrical coordinates.
As $k$ depends on $z$ only, symmetry arguments lead to the conclusion that
the solution $\phi = \phi \left(\rho, z\right)$ does not depend on $\varphi$
in this arrangement.
The angle $\varphi$ is commonly referred to as azimuth, hence the prescribed
problem is of \emph{azimuthal symmetry}.

The homogeneous Helmholtz equation \eqref{eq:scalar_helmholtz_equation} in
cylindrical coordinates reads
\begin{equation}\label{eq:scalar_helmholtz_equation_cyl_coords}
	\left( \laplaceTrans + \frac{\partial^2}{\partial z^2} + k^2 \right)
	\phi \left(\rho, z\right) = 0
	\, ,
\end{equation}
where it follows from the above assumptions that the azimuthal derivative in
the transverse part of the Laplacian operator
\begin{equation}\label{eq:def_laplace_trans}
	\laplaceTrans \coloneqq
	\frac{1}{\rho}
	\frac{\partial}{\partial \rho}
	\rho
	\frac{\partial}{\partial \rho}
	+
	\frac{1}{\rho^2}
	\frac{\partial^2}{\partial \varphi^2}
\end{equation}
vanishes. 
The desired reduction of \eqref{eq:scalar_helmholtz_equation_cyl_coords} to
and \ac{ODE} can be achieved by means of
\begin{corollary}[$k_\rho$ spectral domain]\label{coll:k_rho_domain}
	Let $\phi: \R^3 \mapsto \C$ be a function of azimuthal symmetry
	$\phi = \phi \left(\rho, z\right)$.
	Let further the problem which is obtained by application of
	\eqref{eq:hankel_transform} to
	\eqref{eq:scalar_helmholtz_equation_cyl_coords} be referred to as the
	representation of \eqref{eq:scalar_helmholtz_equation_cyl_coords}
	in the $k_\rho$ spectral domain.
	Then we have the formal substitution 
	\begin{equation}\label{eq:k_rho_domain_laplaceTrans_replacement}
		\laplaceTrans \to -k_\rho^2
	\end{equation}
	in transition of \eqref{eq:scalar_helmholtz_equation_cyl_coords} from the
	$\rho$ to the $k_\rho$ spectral domain.
\end{corollary}
\begin{proof}
	The Hankel transform pair as given by \cref{coll:hankel_transform} does not
	act on the $z$-dependency of $\phi$.
	Hence, it is sufficient to consider
	$\phi = \phi \left(\rho\right)$ which, in terms of an inverse Hankel
	transform, can be expressed as
	\begin{equation}
		\phi \left(\rho\right) =
		\left(\hankelTransformInverse{0} \tilde{\phi} \left(k_\rho\right)\right)
		\left(\rho\right)
		\, .
	\end{equation}
	With the notation of \eqref{eq:def_laplace_trans} we have
	\begin{equation}\label{eq:k_rho_domain_proof_01}
		\laplaceTrans
		\phi \left(\rho\right) =
		\frac{1}{2\pi}
		\frac{1}{\rho}
		\frac{\dd}{\dd \rho}
		\rho
		\frac{\dd}{\dd \rho}
		\int\limits_{0}^{\infty} \dd k_\rho \, k_\rho
		\besselj{0}\left(k_\rho \rho\right)
		\tilde{\phi} \left(k_\rho\right)
		\, ,
	\end{equation}
	where it is noted that $\besselj{0}\left(k_\rho \rho\right)$ is the only
	function in the spectral integrand depending on $\rho$.
	Under the assumption that interchange of integration and differentiation in 
	\eqref{eq:k_rho_domain_proof_01} is legitimate as well as with
	\cite[(10.6.6)]{Olver2010}
	\begin{equation}
		\frac{1}{z}
		\frac{\dd}{\dd z}
		\left( z^\nu \besselj{\nu} \left(z\right) \right) =
		z^{\nu - 1} \besselj{\nu - 1} \left(z\right)
	\end{equation}
	and \cite[(10.4.1)]{Olver2010}
	\begin{equation}
		\frac{\dd}{\dd z} \besselj{0} \left(z\right) = 
		-\besselj{1} \left(z\right)
	\end{equation}
	the action of the derivatives on $\besselj{0}\left(k_\rho \rho\right)$ 
	is determined by straightforward calculation and
	\begin{equation}\label{eq:k_rho_domain_proof_02}
		\laplaceTrans
		\phi \left(\rho\right) =
		\frac{1}{2\pi}
		\int\limits_{0}^{\infty} \dd k_\rho \, k_\rho
		\besselj{0}\left(k_\rho \rho\right)
		\left( -k_\rho^2 \right)
		\tilde{\phi} \left(k_\rho\right) 
	\end{equation}
	is obtained.
	Comparison of \eqref{eq:k_rho_domain_proof_01} and
	\eqref{eq:k_rho_domain_proof_02} reveals that indeed
	\begin{equation}
		\laplaceTrans
		\phi \left(\rho\right)
		\to
		-k_\rho^2 
		\phi \left(k_\rho\right)
	\end{equation}
	corresponds to the transition from the spatial $\rho$ to the spectral
	$k_\rho$ domain.
\end{proof}
\begin{remark}[Bessel's equation]
	An alternative representation of $\laplaceTrans$ is given by
	\cite[(1.5.15)]{Olver2010}
	\begin{equation}
		\laplaceTrans =
		\frac{\partial^2}{\partial \rho^2} + 
		\frac{1}{\rho}
		\frac{\partial}{\partial \rho} + 
		\frac{1}{\rho^2}
		\frac{\partial^2}{\partial \varphi^2}
		\, ,
	\end{equation}
	where the radial part is similar to the derivatives in Bessel's equation
	\cite[(10.2.1)]{Olver2010}.
	Therefore, the Hankel transform transfers Bessel's equation into an
	algebraic equation.
	The connection to \cref{coll:k_rho_domain} is given noting that 
	solutions of Bessel's equation are functions solving the radial part arising
	in a separation of variables ansatz for
	\eqref{eq:scalar_helmholtz_equation_cyl_coords}.
	Hence, the inverse Hankel transform \emph{constructs} a solution to
	\eqref{eq:scalar_helmholtz_equation_cyl_coords} by superposition of
	eigenfunctions.
\end{remark}

With \cref{coll:k_rho_domain} the reduction of
\eqref{eq:scalar_helmholtz_equation_cyl_coords} to an \ac{ODE} is now
straightforward.
Using
\begin{equation}
	k_z^2 \coloneqq k^2 - k_\rho^2
	\, ,
\end{equation}
for notational convenience, the \ac{PDE}
\eqref{eq:scalar_helmholtz_equation_cyl_coords} becomes
\begin{equation}
	\left( \frac{\dd^2}{\dd z^2} + k_z^2 \right)
	\phi \left(\rho, z\right) = 0
\end{equation}
in the $k_\rho$ spectral domain.







\section{Complex Source Beams}
\label{sec:cmplx_src_beams}

In view of the assumptions of \cref{coll:free_space_gf} it is clear that
$R$ is real and non-negative.
However, according to the metric as specified by \cref{def:metric}, this even
holds if the requirement $\rsrc, \robs \in \R^3$ is relaxed to
$\rsrc, \robs \in \C^3$ as the dot product of a complex vector with itself
is real quantity according to \cref{def:dot_product}.
Conversely, a mapping $\cmplxlength{\pvec{z}}: \C^3 \mapsto \C$ for a vector
$\pvec{z} = \rdiff$ with $\rsrc, \robs \in \C^3$ is not a norm according
to \cref{def:norm},~\ie, such a definition of the distance between the
points $\robs$ and $\rsrc$ is not a metric.

However, it turns out that the usual observation point $\robs \in \R^3$ 
in conjunction with a $\diracDelta$-source at \enquote{point} $\rsrc \in \C^3$
causes a significant change in the behavior of the function
$G_0 \left(\rdiff\right)$ if the axioms of \cref{def:euclidean_metric} and
\cref{def:euclidean_norm} are dropped.

As an example, assume $0 < k \in \R$ and
$R = R_\mathrm{re} + \im R_\mathrm{im}$, where
$R = R_\mathrm{re}, R_\mathrm{im} \in \R$.
Substituting these into \eqref{eq:scalar_free_space_gf}, the consideration
\begin{equation}\label{eq:example_csb}
	\abs{\frac{\exp{-\im k R}}{R}} = 
	\abs{ \frac{\exp{-\im k R_\mathrm{re}} \exp{k R_\mathrm{im}}}{R} } = 
	\frac{\exp{k R_\mathrm{im}}}{\abs{R}}
\end{equation}
suggests the complex length $R$ should be defined with $\imag{R} \leq 0$ in
order to allow large magnitude $R$. Such freedom of choice can be achieved
with
\begin{equation}
	R = \sqrt{\left(\rdiff\right) \cdot \overline{\left(\rdiff\right)}}
	\, ,
\end{equation}
which could be seen as a straightforward relaxation of the requirement
$0 \leq R \in \R$ in \cref{def:metric}.
As the complex square root $\sqrt{z}$ has a branch point at $z = 0$, an
valid branch cut must be defined.
It is common to use
\begin{definition}[Branch cut of the complex square root]
	\label{def:sqrt_standard_branch_cut}
	Let $z \in \C$ be arbitrary.
	The branch cut of $\sqrt{z}$ is defined from $z = 0$ along the real axis
	to $-\infty$.
\end{definition}

With \cref{def:sqrt_standard_branch_cut} possible contact with the branch cut
can be avoided by choosing $R$ such that $\real{R} \geq 0$.
Furthermore, this choice appears appealing from an intuitive point of view,
as well as compared to the requirement $R \in \R$ of \cref{def:metric}.
Therefore, the term complex distance is subsequently used according to
\begin{definition}[Complex distance]\label{def:cmplx_distance}
	Let $\robs \in \R^3$ and $\rsrc \in \C^3$ be two vectors.
	The \emph{complex distance} from $\rsrc$ to $\robs$ is defined by
	\begin{equation}
		\cmplxlength{\rdiff} = 
		\sqrt{\left(\rdiff\right) \cdot \overline{\left(\rdiff\right)}}
		\, ,
	\end{equation}
	where the square root is evaluated with
	$\real{\cmplxlength{\rdiff}} \geq 0$.
\end{definition}

As it turns out, the choice of \cref{def:cmplx_distance} even has a special
physical meaning:
with this choice the spherical symmetry of \eqref{eq:scalar_free_space_gf}
passes over to a directive pattern.
This pattern is similar to that of a single-sided Gaussian beam
\cite{hecht2017}, at least for small angles near the beam axis.
As the term Gaussian beam is more frequently used in another context, this
wave object $G_0 \left(\robs, \rsrc\right)$ with $\rsrc \in \C^3$ is called
\ac{CSB} in the following \cite{Hansen2009,Hansen2013}.
Details of \ac{CSB} behavior can be found in the literature
\cite{Deschamps1971,Keller1971,Couture1981}.

\fxnote{explain \ac{CSB} in context of \ac{DCIM}}


\begin{figure}
    \newcommand{\sizeFactor}{0.3}
    \centering
    \begin{tikzpicture}
        \pgfplotsset{small}
        \matrix {
            \begin{axis}[
                width=\sizeFactor\textwidth,
                height=\sizeFactor\textwidth,
                colormap/jet,
                xlabel = {$x / \lambda_0$},
                ylabel = {$z / \lambda_0$},
                zlabel = {$\real{G_0}$},
                title={
					$\real{\rdiffNormSymbol} \geq 0$,
					$\rsrc = \num{-0.1}\lambda_0 \uv{z}$
					},
            ]
            \addplot3 [
                surf,
                mesh/ordering=y varies,
                ] table[
                    x = x_by_lambda_0, y = z_by_lambda_0, z = g1_1,
                ]
                {thesis_csb_examples.dat};
            \end{axis}
            &
            \begin{axis}[
                width=\sizeFactor\textwidth,
                height=\sizeFactor\textwidth,
                colormap/jet,
                xlabel = {$x / \lambda_0$},
                ylabel = {$z / \lambda_0$},
                zlabel = {$\real{G_0}$},
                title={
					$\real{\rdiffNormSymbol} \geq 0$,
					$\rsrc = \num{-0.5}\lambda_0 \uv{z}$
					},
            ]
            \addplot3 [
                surf,
                mesh/ordering=y varies,
                ] table[
                    x = x_by_lambda_0, y = z_by_lambda_0, z = g1_2,
                ]
                {thesis_csb_examples.dat};
            \end{axis}
            &&
            \begin{axis}[
                width=\sizeFactor\textwidth,
                height=\sizeFactor\textwidth,
                colormap/jet,
                xlabel = {$x / \lambda_0$},
                ylabel = {$z / \lambda_0$},
                zlabel = {$\real{G_0}$},
                title={
					$\real{\rdiffNormSymbol} \geq 0$,
					$\rsrc = \num{1.0}\lambda_0 \uv{z}$
					},
            ]
            \addplot3 [
                surf,
                mesh/ordering=y varies,
                ] table[
                    x = x_by_lambda_0, y = z_by_lambda_0, z = g1_3,
                ]
                {thesis_csb_examples.dat};
            \end{axis}
            \\
            \begin{axis}[
                width=\sizeFactor\textwidth,
                height=\sizeFactor\textwidth,
                colormap/jet,
                xlabel = {$x / \lambda_0$},
                ylabel = {$z / \lambda_0$},
                zlabel = {$\real{G_0}$},
                title={
					$\real{\rdiffNormSymbol} \geq 0$,
					$\rsrc = \num{-0.1}\lambda_0 \uv{z}$
					},
            ]
            \addplot3 [
                surf,
                mesh/ordering=y varies,
                ] table[
                    x = x_by_lambda_0, y = z_by_lambda_0, z = g2_1,
                ]
                {thesis_csb_examples.dat};
            \end{axis}
            &
            \begin{axis}[
                width=\sizeFactor\textwidth,
                height=\sizeFactor\textwidth,
                colormap/jet,
                xlabel = {$x / \lambda_0$},
                ylabel = {$z / \lambda_0$},
                zlabel = {$\real{G_0}$},
                title={
					$\real{\rdiffNormSymbol} \geq 0$,
					$\rsrc = \num{-0.5}\lambda_0 \uv{z}$
					},
            ]
            \addplot3 [
                surf,
                mesh/ordering=y varies,
                ] table[
                    x = x_by_lambda_0, y = z_by_lambda_0, z = g2_2,
                ]
                {thesis_csb_examples.dat};
            \end{axis}
            &&
            \begin{axis}[
                width=\sizeFactor\textwidth,
                height=\sizeFactor\textwidth,
                colormap/jet,
                xlabel = {$x / \lambda_0$},
                ylabel = {$z / \lambda_0$},
                zlabel = {$\real{G_0}$},
                title={
					$\real{\rdiffNormSymbol} \geq 0$,
					$\rsrc = \num{-1.0}\lambda_0 \uv{z}$
					},
            ]
            \addplot3 [
                surf,
                mesh/ordering=y varies,
                ] table[
                    x = x_by_lambda_0, y = z_by_lambda_0, z = g2_3,
                ]
                {thesis_csb_examples.dat};
            \end{axis}
            \\
            };
    \end{tikzpicture}
    \caption{Real part of \acp{CSB} for different imaginary offsets and
	two different definitions of complex length.}
	\label{fig:thesis_csb_examples}
\end{figure}










\section{Sommerfeld Integrals and Sommerfeld Identity}
\label{sec:sommerfeld_integrals_and_identity}

Arnold Sommerfeld's approach towards a mathematical description of dipole
radiation above flat earth combines the results of the two preceding
sections.
In the original consideration of a \ac{VED} over ground \cite{Sommerfeld1909}
it is clear by intuition, that the radiated field is of azimuthal symmetry.
The wavenumber $k = k\left(z\right)$ of the governing Helmholtz equation is
domain-wise constant for $z < 0$ and $z \geq 0$, respectively.
By recognition of these two properties, Sommerfeld identifies products of
Bessel functions of first kind (in radial direction) and plane waves
(in vertical directions) as the eigenfunctions of the problem.
The very core of the Sommerfeld formalism is now an expression which represents
the free-space Green's function \eqref{eq:scalar_free_space_gf} by an infinite
superposition of these eigenfunctions.
This \emph{Sommerfeld identity} is given by the central
\cite[eq.~(10)]{Sommerfeld1909}\cite[66]{Chew1999}
\begin{theorem}[Sommerfeld identity]\label{thm:sommerfeld_identity}
	Let $\robs, \rsrc \in \R^3$ with $\robs \neq \rsrc$ be two vectors and
	$k \in \C$ with $\real{k} > 0$ and $\imag{k} < 0$.
	Then the Sommerfeld identity then reads
	\begin{equation}\label{eq:sommerfeld_identity_pos_real_axis}
		\frac{\exp{-\im k \rdiffNormSymbol}}{\rdiffNormSymbol} = 
		-\im
		\int\limits_{0}^{\infty} \dd k_\rho \, k_\rho
		\besselj{0} \left(k_\rho \rho\right)
		\frac{\exp{-\im k_z \abs{z - z^\prime}}}{k_z}
		\, ,
	\end{equation}
	where\footnote{
		Sommerfeld originally used to define the vertical propagation constant
		$k_z$ differently, namely as $k_z = \sqrt{{k_\rho}^2 - k^2}$
		\cite{Sommerfeld1909,Sommerfeld1964}.
		A detailed discussion on the impact of this convention \vs
		\eqref{eq:def_k_z_of_k_rho} can be found in a review paper by
		\textcite{Mosig2021}.
		As the form of \eqref{eq:def_k_z_of_k_rho} seems to prevail in
		more recent literature, this convention is used throughout the present
		thesis.
		}
	\begin{equation}\label{eq:def_k_z_of_k_rho}
		k_z = \sqrt{k^2 - {k_\rho}^2}
	\end{equation}
	is defined with $\imag{k_z} \geq 0$ and where
	\begin{equation}
		\rdiffNormSymbol = \rdiffNorm \qquad
		\rho = \norm{\uv{z} \times \left(\rdiff\right)} \qquad
		z = \uv{z} \cdot \robs \qquad
		z^\prime = \uv{z} \cdot \rsrc
		\, .
	\end{equation}
	The integrand of \eqref{eq:sommerfeld_identity_pos_real_axis} is holomorphic
	at all $k_\rho \in \C$ except at the branch points $\pm k$ of $k_z$ and
	on the corresponding branch cut(s).
\end{theorem}

Due to the analytic properties of the integrand in
\eqref{eq:sommerfeld_identity_pos_real_axis} the restriction $\imag{k} < 0$
in \cref{thm:sommerfeld_identity} can readily be resolved by
\begin{corollary}[Path detour]
	In the $\imag{k} \to 0$ the path of integration in
	\eqref{eq:sommerfeld_identity_pos_real_axis} can legitimately be deformed
	into the first quadrant of the complex $k_\rho$-plane to render the integral
	defined.
\end{corollary}

\begin{definition}[\acl{SIP}]
	In \eqref{eq:sommerfeld_identity_pos_real_axis} the path of integration
	along the non-negative real axis is called \emph{\acf{SIP}}.
\end{definition}

Clearly, \eqref{eq:sommerfeld_identity_pos_real_axis} is an inverse Hankel
transform and can be written as
\begin{equation}
		\frac{\exp{-\im k \rdiffNormSymbol}}{\rdiffNormSymbol} = 
		2\pi \,
		\hankelTransformInverse{0}
		\left\{ \frac{\exp{-\im k_z \abs{z - z^\prime}}}{\im k_z} \right\} 
\end{equation}
using the notation of \cref{coll:hankel_transform}.
As it turns out, within the context of electromagnetic theory only
inverse Hankel transforms of orders $\nu \in \left\{0, 1, 2\right\}$
occur.
These integrals are---taking into account the enormous impact of the
concept during the past 112 years---most frequently referred to as
\emph{Sommerfeld integrals} within the electromagnetics community, which is why
it is appropriate to introduce a special symbol for them.
\begin{definition}[Sommerfeld integrals]	
	Inverse Hankel transforms of orders $\nu \in \left\{0, 1, 2\right\}$
	are called \emph{Sommerfeld integrals} and denoted by
	$\sommerfeldIntegral{\nu} \equiv \hankelTransformInverse{\nu}$.
\end{definition}

Much of Sommerfeld's original considerations
\cite{Sommerfeld1909,Sommerfeld1926} regarding dipole radiation above flat
lossy earth are not directly based on the positive real axis integration path
of \eqref{eq:sommerfeld_identity_pos_real_axis} but on an alternative path
which enables application of a wider set of mathematical tools.
This flexibility proves especially fruitful if the transformed function
$\tilde{f} \left(k_\rho\right) = \exp{-\im k_z \abs{z - z^\prime}} k_z^{-1}$ of
\eqref{eq:sommerfeld_identity_pos_real_axis} is replaced by a more general
function.
\begin{corollary}[\acf{EIP}]
	Let $\tilde{f} \left(k_\rho\right)$ be an even (odd) function of $k_\rho$
	for even (odd) $\nu \in \N$.
	Then we have
	\begin{align}
		\sommerfeldIntegral{\nu} \left\{\tilde{f} \left( k_\rho \right) \right\}
		&=
		\frac{1}{2\pi}
		\int\limits_{0}^{\infty} \dd k_\rho \, k_\rho
		\besselj{0} \left(k_\rho \rho\right)
		\tilde{f} \left(k_\rho\right) 
		\label{eq:sommerfeld_integral_sip}
		\\
		&\equiv
		\frac{1}{4\pi}
		\int\limits_{-\infty}^{\infty} \dd k_\rho \, k_\rho
		\besselh{2}{\nu} \left(k_\rho \rho\right)
		\tilde{f} \left(k_\rho\right)
		\label{eq:sommerfeld_integral_eip}
		\, ,
	\end{align}
	where the path of integration in \eqref{eq:sommerfeld_integral_eip} is
	understood in the way shown in \cref{fig:sip}.
\end{corollary}
	
\begin{figure}
	\centering
	\begin{tikzpicture}[
        decoration={
            markings, 
            mark= at position 0.375 with {\arrow{stealth}},
            mark= at position 0.625 with {\arrow{stealth}},
            },
    ]
		\draw [->,>=stealth] (-4.5,0) -- (4.5,0) node[right] {$\real{k_\rho}$};
		\draw [->,>=stealth] (0,-2) -- (0,2) node[above] {$\imag{k_\rho}$};
        \fill (1,-0.2) circle (1.0pt) node[below right]{$k$};
        \fill (-1,0.2) circle (1.0pt) node[above left]{$-k$};
        \draw [red,thick,postaction={decorate}] (-4,0) -- (-2,0) -- (-2,-0.2) --
				(0.2,-0.2) -- (0.2,0.2) -- (2,0.2) -- (2,0) --node[above]{SIP} (4,0);
	\end{tikzpicture}
	\caption[\acl{SIP} in the complex $k_\rho$-plane]
	{\acf{SIP} in the complex $k_\rho$-plane. The exact form of the detour
	is not critical, as long as the branch points $\pm k$ and the singularity
	of $\besselh{2}{\nu} \left(0\right)$ are obviated.}
	\label{fig:sip}
\end{figure}

The integration path of \eqref{eq:sommerfeld_integral_eip} is called
\acf{EIP}\footnote{
	The term \acl{SIP} is not used uniformly in the literature.
	Sometimes the whole real axis path is termed \ac{SIP}, while the
	path in non-negative real axis path is called differently.
	}
subsequently.
The particular course of the \ac{EIP} ensures to sidestep the logarithmic
branch point singularity of $\besselh{\nu}{2}\left(0\right)$ \cite{Olver2010}
as well as it allows for $\imag{k} \to 0$.

The \ac{EIP} has a variety of advantages over the positive real axis path in
\eqref{eq:sommerfeld_integral_real_axis_path}.
Much of the power of Sommerfeld's approach originates in the fact that the
involved spectral domain functions $\tilde{f}$ are holomorphic on $\C$ except at 
distinct poles and, as can be shown \cite{Michalski2016b}, at most two
branch points and the corresponding branch cuts.

In the picture of Riemann's sphere \cite[180]{Meyberg2006}, the real
$-\infty$ and $\infty$ in \eqref{eq:sommerfeld_integral_sip} can be interpreted
as the same point on $\C \cup \left\{\infty\right\}$.
Another way to think of this is that, for $\rho > 0$, the real axis path in
\eqref{eq:sommerfeld_integral_sip} can be closed at infinity in the lower
complex $k_\rho$-half-plane by virtue of Jordan's lemma.

Corresponding to Cauchy's theorem and the residue theorem, the result of
integration along the closes \ac{EIP} is constituted solely by the integration
around the branch cuts and the residues of the poles.

This enables the application of various exact and asymptotic techniques,
analytical ones as well as numerical ones
\cite{Sommerfeld1964,Chew1999,Michalski1985a,Michalski2016b}.

The proof of equivalence for \eqref{eq:sommerfeld_integral_real_axis_path} and
\eqref{eq:sommerfeld_integral_sip} is nowadays a classic textbook example
\cite[203]{Sommerfeld1964}.

\fxnote{Sommerfeld identity for complex $\abs{z-z^\prime}$}












\chapter{Electromagnetic Waves in Planar Multilayered Media}
\label{ch:em_case}







\section{Fundamental equations}
\label{sec:em_fundamental_equations}

The theory of classical electrodynamics, expressed axiomatically by Maxwell's
equations, constitute an accepted and well-proven framework for thy analysis of
macroscopic\footnote{An electromagnetic problem is considered \emph{macroscopic}
if it can be justly assumed that the electromagnetic sources---charges and
currents---are described by \emph{continous} functions of space.}
electromagnetic phenomena.
The subsequent section aims to demonstrate one possible way to derive the
representation of electromagnetic wave fields in inhomogeneous media for in the
important special case of a solution domain whose media parameters vary only in
one Cartesian direction.
This direction is defined to be the one of $\uv{z}$.

As usual, at the very beginning there are Maxwell's equations.
Out of their manifold manifestations it is advisable to choose the most
simplified formulation still amenable to the problem at hand.
In the present case the bounds of simplification are specified by the following
assumptions.
\begin{itemize}
	\item Only stationary \emph{time-harmonic} fields are considered.
	The frequency $f > 0$ (in $\SI{}{\hertz}$) is treated as a parameter of the
	problem, time convention is determined by
	\cref{def:fourier_transfrom_temporal_forward}, where $\omega = 2\pi f$.
	\item All media are assumed to be \emph{linear} and \emph{isotropic}.
	Their electromagnetic properties are therefore fully described by two scalar
	fields $\epsr, \mur \in \C$.
	The material parameters depend on space in the particular way
	$\epsr = \epsr\left(z\right)$ and $\mur = \mur\left(z\right)$.
	\item Hypothetical magnetic (equivalent) sources $\pvec{M}$ and
	$\varrho_\mathrm{m}$ are introduced to mathematically complement the
	physical sources $\pvec{J}$ and $\varrho$.
\end{itemize}
Under these assumptions Maxwell's equations read \cite{Harrington2001,Chew1999}
\begin{subequations}\label{eq:mwe_fd}
	\begin{align}
		-&\curl \pvec{E}
		= \im\omega\mu\pvec{H} + \pvec{M} \label{eq:mwe_fd_faraday} \\
		&\curl \pvec{H}
		= \im\omega\varepsilon\pvec{E} + \pvec{J} \label{eq:mwe_fd_ampere} \\
		&\divergence \left(\varepsilon\pvec{E}\right)
		= \varrho \label{eq:mwe_fd_gauss} \\
		&\divergence \left(\mu\pvec{H}\right) 
		= \varrho_\mathrm{m} \,, \label{eq:mwe_fd_gauss_magnetic}
	\end{align}
\end{subequations}
where $\varepsilon = \epsr \varepsilon_0$ and $\mu = \mur \mu_0$.
The well-known physical constants $\varepsilon_0$ and $\mu_0$ specify the
electromagnetic properties of vacuum.
The vector and scalar fields in \eqref{eq:mwe_fd} are functions
$\R^3 \mapsto \C^3$ and $\R^3 \mapsto \C$, respectively.

The dimensionless quantity $\epsr \in \C$ is called relative permittivity 
and can be composed as \cite[43]{Jin2015}
\begin{equation}
	\epsr = \epsr^\prime - \im \frac{\sigma}{\omega \varepsilon_0} \,,
\end{equation}
where $\epsr^\prime$ describes the dielectric properties of a lossless medium
and the imaginary part is a quantifies the losses due to the electrical
conductivity $\sigma$ (measured in Siemens).

In order to uniquely define an electromagnetic field problem and its solution,
Maxwell's equations \eqref{eq:mwe_fd} have to be supplemented by appropriate
boundary conditions.
In a homogeneous domain these follow from the Sommerfeld condition of radiation
as given by \cref{def:sommerfeld_radiation_condition}.

At an interface separating two spatial domains $\Omega_1, \Omega_2 \subset \R^3$
with different, but domain-wise constant material parameters the canonical
continuity conditions
\begin{subequations}\label{eq:mwe_continuity_at_interface}
	\begin{align}
		&\uv{n} \times \pvec{E}_1 - \uv{n} \times \pvec{E}_2 =
		- \pvec{M}_\mathrm{s} \\
		&\uv{n} \times \pvec{H}_1 - \uv{n} \times \pvec{H}_2 =
		\pvec{J}_\mathrm{s} \\
		&\uv{n} \cdot \left(\varepsilon_1 \pvec{E}_1\right) -
		\uv{n} \cdot \left(\varepsilon_2 \pvec{E}_2\right) = 
		\varrho_\mathrm{s} \\
		&\uv{n} \cdot \left(\mu_1 \pvec{H}_1\right) -
		\uv{n} \cdot \left(\mu_2 \pvec{H}_2\right) = 
		\varrho_\mathrm{m,s}
	\end{align}
\end{subequations}
can be derived \cite[p20]{Jackson2013}, where the omitted arguments
$\robs_{1,2} \in \Omega_{1,2}$ of the fields are understood in the
$\robs_{1,2} \to \partial \Omega$ with the common boundary
$\partial \Omega = \partial \Omega_1 = \partial \Omega_2$ and the unit normal
vector $\uv{n}$ on $\partial \Omega$.
The surface (indicated by the subscript $\mathrm{s}$) current and charge
densities on the right-hand sides of \eqref{eq:mwe_continuity_at_interface}
reside, if existent, on $\partial\Omega$.

The arguably most prominent feature of Maxwell's equations is the possibility
of wave solutions.
To give particular emphasis on the wave nature of the fields for $\omega > 0$,
more suitable \acp{PDE} can be derived from \eqref{eq:mwe_fd}.
For example
\begin{equation}\label{eq:curlcurl_E}
	\mu\curl\frac{1}{\mu}\curl\pvec{E} - k^2\pvec{E} = 0 
\end{equation}
is readily derived from \eqref{eq:mwe_fd_faraday} and \eqref{eq:mwe_fd_ampere}
for a spatial domain free of sources,~\ie, $\pvec{J} = \pvec{M} = 0$.
The corresponding equation
\begin{equation}\label{eq:curlcurl_H}
	\varepsilon\curl\frac{1}{\varepsilon}\curl\pvec{H} - k^2\pvec{H} = 0
\end{equation}
for the magnetic field follows analogously.
In a domain $\Omega \in \R^3$ with constant material parameters
\eqref{eq:curlcurl_E} and \eqref{eq:curlcurl_H} reduce to the vector Helmholtz
equation
\begin{equation}\label{eq:vector_helmholtz_equation}
	\laplace \pvec{F} + k^2 \pvec{F} = 0 \qquad
	\pvec{F} \in \left\{\pvec{E}, \pvec{H}\right\}
	\, .
\end{equation}
The quantity
\begin{equation}\label{eq:wavenumber}
	k = \omega^2 \sqrt{\varepsilon \mu}
\end{equation}
is called \emph{wavenumber}.

Consider now an open domain problem,~\ie, $\Omega = \R^3$, where $\Omega$ may
be compound of multiple disjoint subdomains
$\Omega_1, \Omega_2, \dots, \Omega_N$ with domain-wise constant $\epsr$ and
$\mur$.
In order to be unique and physical, a solution to \eqref{eq:curlcurl_E},
\eqref{eq:curlcurl_H} or \eqref{eq:vector_helmholtz_equation} must fulfill
the radiation condition for large $\robs \in \Omega$.
To ensure this, $k$ must have $\imag{k} \leq 0$ in all sub-domains $\Omega_n$
which contain points $\robs$ with $r \to \infty$.
Therefore, we restrict allowed values of $\epsr$ and $\mur$ to lie in
$\Omega_{\epsr,\mur} = \left\{z \in \C : \real{z} > 0, \imag{z} \leq 0\right\}$.
With these restrictions $\imag{\epsr \mur} \leq 0$ and therefore $\real{k} > 0$.
As $\imag{k} \leq 0$ is guaranteed now if the square root in
\eqref{eq:wavenumber} is evaluated with positive sign, it turns out that
$G_0$ from \eqref{eq:scalar_free_space_gf} vanishes in the
$\rdiffNorm \to \infty$ for $\epsr, \mur \in \Omega_{\epsr,\mur}$.
Hence, the radiation is fulfilled for open boundary conditions with
$\epsr, \mur \in \Omega_{\epsr,\mur}$.

For real $k$ it makes sense to define the \emph{wavelength} as
$\lambda = 2\pi / k$.
The wavelength will be used later to define relative distances which makes
the presentation of results independent of frequency.
Vacuum values. \eg, $\lambda_0 = 2\pi / k_0 = c / f$,
where $c$ is the vacuum speed of light, are indicated by the subscript zero.









\section{Duality principle}
\label{sec:duality_principle}

The derivation of \eqref{eq:curlcurl_E} and \eqref{eq:curlcurl_H} is analogous.
This is due to a principle which \textcite[\S12-1]{Feynman2011} felicitously
summarized by stating that \enquote{the same equations have the same solutions}.

This so-called duality principle makes use of the fact that the symmetry of the
complemented Maxwell's equations \eqref{eq:mwe_fd} in only broken by
opposing signs in \eqref{eq:mwe_fd_faraday} and \eqref{eq:mwe_fd_ampere}.
Taking this into account, one can establish as set of duality replacement rules.
This set is not unique as, in fact, any set of rules which preserves the form
of \eqref{eq:mwe_fd} is admissible.
While different possibilities can be found can be found in the literature
\cite{Jin2015,Harrington2001,Chew1999}, the present thesis uses
\begin{definition}[Duality substitution rules for electrodynamic quantities]
	The \emph{duality substitution rules for electromagnetic quantities} in
	\eqref{eq:mwe_fd} are defined as \cite[9]{Chew1999}
	\begin{subequations}
		\begin{align}
		\pvec{E} &\to \pvec{H} \\
		\pvec{H} &\to \pvec{E} \\
		\pvec{J} &\to -\pvec{M} \\
		\pvec{M} &\to -\pvec{J} \\
		\varrho &\to -\varrho_\mathrm{m} \\
		\varrho_\mathrm{m} &\to -\varrho \\
		\varepsilon &\to -\mu \\
		\mu &\to -\varepsilon 
		\end{align}
	\end{subequations}
\end{definition}











\section{Five-Component Fields}
\label{sec:five_component_fields}

In media of one-dimensional inhomogeneity,\ie, $\epsr = \epsr\left(z\right)$ and
$\mur = \mur\left(z\right)$ the study of wave fields governed by
\eqref{eq:curlcurl_E} and \eqref{eq:curlcurl_H} can be reduced to the solution
of two \acp{ODE}.
These equations describe a so-called \emph{characteristic component} of an
electromagnetic filed with only five non-vanishing components.
Since either $\pvec{E}$ or $\pvec{H}$ have no $\uv{z}$ component, these
\emph{modes} are termed \ac{TE} and \ac{TM}, respectively.

% The following derivation of a generic \ac{TM} field and its continuity
% conditions at a change of $\epsr$ or $\mur$ in $z$ is essentially the solution
% to an example problem in the textbook by \textcite[140]{Chew1999}.

Consider the $E_z = \uv{z} \cdot \pvec{E}$ as the characteristic component
of a generic \ac{TM} field
\begin{equation}\label{eq:generic_TM_field_components}
	\pvec{H} = \uv{x}H_x + \uv{y}H_y 
	\qquad
	\pvec{E} = \uv{x}E_x + \uv{y}E_y \uv{z}E_z
	\, .
\end{equation}
Obviously, the component $E_z$ is contained in \eqref{eq:curlcurl_E}.
Its governing equation
\begin{equation}\label{eq:TM_E_z_PDE_first_step}
	\laplaceTrans E_z
	+
	\frac{\partial}{\partial z}
	\left(
		\frac{\partial}{\partial x} E_x + 
		\frac{\partial}{\partial y} E_y + 
	\right)
	-
	k^2 E_z
	=
	0
\end{equation}
is straightforwardly obtained by extracting the $z$-component of
\eqref{eq:curlcurl_E}, where the properties $\epsr = \epsr\left(z\right)$ and
$\mur = \mur\left(z\right)$ are employed together with Schwarz's theorem.
From Gauss's law \eqref{eq:mwe_fd_gauss} for the homogeneous case $\varrho = 0$
\begin{equation}
	\frac{\partial}{\partial x} E_x + 
	\frac{\partial}{\partial y} E_y + 
	=
	-
	\frac{1}{\varepsilon}
	\frac{\partial}{\partial z}
	\varepsilon E_z
\end{equation}
is obtained which can be used in \eqref{eq:TM_E_z_PDE_first_step} to write
\begin{equation}\label{eq:TM_characteristic_component_PDE}
	\left(
		\laplaceTrans 
		+
		\varepsilon
		\frac{\partial}{\partial z}
		\frac{1}{\varepsilon}
		\frac{\partial}{\partial z}
		+
		k^2
	\right)
	\varepsilon E_z = 0
\end{equation}
for the characteristic component $\varepsilon E_z$ of this \ac{TM}
field\footnote{Alternatively to $\varepsilon E_z$ the transverse component
$H_\mathrm{t}$ could also be used as characteristic component
\cite[46]{Chew1999}.}.

So far the \ac{TM} characteristic of \eqref{eq:generic_TM_field_components} has
not yet been employed.
The missing $H_z$ component comes into play as this very property allows
for calculation of the remaining five field components from a known solution for
$E_z$ \cite[\S\S2.3.3]{Chew1999}.


With \eqref{eq:TM_characteristic_component_PDE} in mind consider now the field
of a \ac{VED},~\ie, an infinitesimal $\uv{z}$-directed current element.
As the assumptions state that $\varepsilon$ and $\mu$ do depend on $z$ only
one can, without loss of generality, lie the \ac{VED} onto the Cartesian
and cylindrical $z$-axis.
As the driving current density has no transverse component it is a justifiable
assumption that the \ac{VED} field is of azimuthal symmetry.
By the nature of \eqref{eq:mwe_fd_ampere} we can further deduce that $\pvec{H}$
has no vertical component.
With these two arguments the fields depend on position in the particular way
of $\pvec{E} = \pvec{E} \left(\rho, z\right)$ and
$\pvec{E} = \pvec{E} \left(\rho, z\right)$.
Furthermore, it is known the solution of Maxwell's equation for the
\ac{VED} is a \ac{TM} field.
These characteristics allow for application of the Hankel transform to
reduce \eqref{eq:TM_characteristic_component_PDE}
\begin{equation}\label{eq:TM_characteristic_component_ODE}
	\left(
		\varepsilon
		\frac{\dd}{\dd z}
		\frac{1}{\varepsilon}
		\frac{\dd}{\dd z}
		+
		k_z^2
	\right)
	\varepsilon \tilde{E}_z = 0
	\, ,
\end{equation}
where again \eqref{eq:def_k_z_of_k_rho} is used for notational convenience.
Hence, the characteristic component of the \ac{VED} field obeys the \ac{ODE}
\eqref{eq:TM_characteristic_component_ODE} in the $k_\rho$ spectral domain.
The spectral-domain solution $\tilde{E}_z$ again solves Maxwell's equations
by which the remaining components can also be obtained in the spectral domain.
The spatial domain solution for each component is then found by inverse Hankel
transformation,~\ie, by means of Sommerfeld integrals.

\fxnote{\ac{HED}, dyadic Green's functions}

\section{Continuity Conditions at Boundaries}
\label{sec:continuity_at_interfaces}

\begin{figure}
    \centering
        \begin{tikzpicture}[
        scale = 0.7,
		]

        % Coordinate axis
        \draw [->,>=stealth] (-1,-1) -- (-1,10) node[above] {$\left(z\right)$};
        \draw (-1.1,3.5) -- (-0.9,3.5) node[right] {$z^\prime$};
        \draw (-1.1,5.5) -- (-0.9,5.5) node[right] {$z$};

        % Top BC
        \draw[draw=none,pattern=north west lines] (0,9) -- (7.5,9) -- (7.5,9.5)
        --node[above]{open($z_N\to\infty$), PEC, PMC} (0,9.5) -- cycle;

        % Layers
        \draw (0,9) -- (7.5,9) node[right]{$z_{N}$};
        \node at (4,8.5) [align=center] {$\Omega_{N-1}$};
        \draw (0,8) -- (7.5,8) node[right]{$z_{N-1}$};
        \node at (4,7.5) [align=center] {$\Omega_{N-2}$};
        \draw (0,7) -- (7.5,7) node[right]{$z_{N-2}$};
        \node at (4,6.6) [align=center] {\vdots};
        \draw (0,6) -- (7.5,6) node[right]{$z_{m+1}$};
        \node at (4,5.5) [align=center] {$\Omega_m$};
        \draw (0,5) -- (7.5,5) node[right]{$z_m$};
        \node at (4,4.6) [align=center] {\vdots};
        \draw (0,4) -- (7.5,4) node[right]{$z_{n+1}$};
        \node at (4,3.5) [align=center] {$\Omega_n$};
        \draw (0,3) -- (7.5,3) node[right]{$z_n$};
        \node at (4,2.6) [align=center] {\vdots};
        \draw (0,2) -- (7.5,2) node[right]{$z_2$};
        \node at (4,1.5) [align=center] {$\Omega_1$};
        \draw (0,1) -- (7.5,1) node[right]{$z_1$};
        \node at (4,0.5) [align=center] {$\Omega_0$};
        \draw (0,0) --(7.5,0) node[right]{$z_0$};

        % Bottom BC
        \draw[draw=none,pattern=north west lines] (0,0) -- (7.5,0) -- (7.5,-0.5)
        --node[below]{open($z_0\to-\infty$), PEC, PMC} (0,-0.5) -- cycle;
    \end{tikzpicture}
    \caption[Multilayered medium with indexing scheme]
	{Multilayered medium with indexing scheme.
	The layers are defined as domains
	$\Omega_i = \left\{z \in \R\,:\, z_i \leq z < z_{i+1}\right\}$.}
    \label{fig:multilayered_medium_spec}
\end{figure}

The derivation of the characteristic components of \ac{TE} and \ac{TM} fields in
\cref{subsec:reduction_to_odes} does only assume $\epsr = \epsr\left(z\right)$
and $\mur = \mur\left(z\right)$.
So far, the dependency on $z$ is still generic, with the sole requirement that
the derivatives in \eqref{eq:TE_ODE} and \eqref{eq:TM_ODE} must exist.

In the following $\epsr$ and $\mur$ are assumed to be domain-wise constant for
adjacent intervals in $z$.
The domains corresponding to these layers are defined in
\cref{fig:multilayered_medium_spec}.
Each domain,~\ie, each layer, is assigned its domain-wise constant pair of
material parameters $\epsr,\mur$ and wavenumber according to
\eqref{eq:wavenumber}.
Accordingly, the discontinuities of $\epsr$ and $\mur$ occur at the interfaces
$z_i$.
Within the conventions of \cref{fig:multilayered_medium_spec} Sommerfeld problem
corresponds to $N=2$ with one single finite boundary at $z_1 = 0$ and open
boundary conditions at $z_0$ and $z_2$.
With that assumption the continuity condition for $\tilde{H}_z$ and
$\tilde{E}_z$ at the boundaries of two neighboring domains with different
$\epsr$ and/or $\mur$ need to be known.

One, heuristic, way to obtain these continuity conditions is to deduce them from 
\eqref{eq:TE_ODE} and \eqref{eq:TM_ODE} \cite[47]{Chew1999}.
Another approach would be to follow the idea behind a common derivation of
\eqref{eq:mwe_continuity_at_interface}, which re-writes the governing 
differential equations in integral form and then considers small loops or
volumes around the interface \cite[p20]{Jackson2013}.
Anyhow, the continuity conditions for $\tilde{H}_z$ at the boundary $z_i$ read
\begin{subequations}
	\begin{equation}\label{eq:B_continuity}
		\mu_i \tilde{H}_{z} \left(z^{-}\right) =
		\mu_{i+1} \tilde{H}_{z} \left(z^{+}\right)
	\end{equation}
	and
	\begin{equation}\label{eq:H_z_tilde_second_continuity_condition}
		\frac{1}{\mu_i}
		\frac{\dd}{\dd z}
		\mu_i \tilde{H}_{z}\left(z^{-}\right)
		=
		\frac{1}{\mu_{i+1}}
		\frac{\dd}{\dd z}
		\mu_{i+1} \tilde{H}_{z} \left(z^{+}\right)
		\,,
	\end{equation}
\end{subequations}
where $z^{\pm} \to z_i$ from both sides.
Once more the duality principle can be employed to obtain the corresponding
conditions 
\begin{subequations}
	\begin{equation}\label{eq:D_continuity}
		\varepsilon_i \tilde{E}_{z,i} \left(z^{-}\right)
		=
		\varepsilon_{i+1} \tilde{E}_{z,i+1} \left(z^{+}\right)
	\end{equation}
	and
	\begin{equation}\label{eq:E_z_tilde_second_continuity_condition}
		\frac{1}{\varepsilon_i}
		\frac{\dd}{\dd z}
		\varepsilon_i \tilde{E}_{z,i} \left(z^{-}\right)
		=
		\frac{1}{\varepsilon_{i+1}}
		\frac{\dd}{\dd z}
		\varepsilon_{i+1} \tilde{E}_{z,i+1} \left(z^{+}\right)
		\,.
	\end{equation}
\end{subequations}
for $\tilde{E}_z$.










\section{Equivalent Transmission Line Networks and Spectral Green's Functions}
\label{sec:tl_greens_functions}

Coming back to Richard Feynman's famous quote (see
\cref{subsec:duality_principle}), comparison of \eqref{eq:TE_ODE} and
\eqref{eq:TM_ODE} reveals distinctive similarities to another set of
\acp{ODE} familiar to electrical engineers: the \acp{ODE} describing 
voltage and current on transmission lines. 

Because of this familiarity, it has become a well-established procedure to
re-use known results of transmission line theory in the solution process of
electromagnetic field problem in half-space or planar multilayered solution
domains.
This approach is referred to as equivalent transmission line network method or
just network method in the literature.
For the special case of multilayered media with domain-wise constant material
parameters the \acp{TLGF} are known analytically for an arbitrary number of
layers and outer boundary conditions which might be open, \ac{PEC}, \ac{PMC}
or of impedance-type \cite[Section~2.4]{Felsen1994}\cite{Michalski1990,
Eibert1997,Michalski2005,Michalski2016b}.

Just as in planar layered media, \ac{TE} and \ac{TM} modes can be distinguished
on transmission lines.
The homogeneous transmission line equations for a $z$-directed line with
propagation \enquote{constant} $k_z$ are given by
\cite{Felsen1994,Michalski2016b}
\begin{subequations}\label{eq:tl_ode_system}
	\begin{align}
		\frac{\dd}{\dd z} V\left(z\right)
		&=
		-\im k_z Z^\tx I\left(z\right) \label{eq:tl_ode_system_dV} \\
		\frac{\dd}{\dd z} I\left(z\right)
		&=
		-\im k_z Y^\tx V\left(z\right) \label{eq:tl_ode_system_dI} \, ,
	\end{align}
\end{subequations}
where with regard to the characteristic impedance $Z = Y^{-1}$ a distinction has
to be made for $\tx \in \left\{\te,\tm\right\}$.
Within the framework of multilayered media the transmission line
characteristics in the $i$-th layer are determined by
\begin{equation}
	k_{zi} = \sqrt{{k_i}^2 - {k_\rho}^2}
	\,
\end{equation}
\begin{equation}
	Z_i^\tm = \frac{k_{zi}}{\omega \varepsilon_i}
\end{equation}
and
\begin{equation}
	Z_i^\te = \frac{\omega \mu_i}{k_{zi}}
	\, .
\end{equation}
With that, the four \acp{TLGF} of \eqref{eq:tl_ode_system}
\begin{itemize}
	\item voltage due to unit-strength $\diracDelta$-like current source $V_i$
	\item current due to unit-strength $\diracDelta$-like current source $I_i$
	\item voltage due to unit-strength $\diracDelta$-like voltage source $V_v$
	\item current due to unit-strength $\diracDelta$-like voltage source $I_v$
\end{itemize}
are known analytically for the geometry shown in
\cref{fig:multilayered_medium_spec} and more or less ready to use expressions
for special cases as well as for a general multilayered medium can be found in
the literature 
\cite{Michalski1990,Hsu1993,Ho1994,Eibert1997,Michalski2005}.
As the coupled \acp{ODE} \eqref{eq:tl_ode_system_dV} and
\eqref{eq:tl_ode_system_dI} are dual
equations, the set of duality rules for the \acp{TLGF} can be formulated as
given by \cref{tab:tlgf_duality}.

\begin{table}[hbt]
	\centering
	\begin{tabular}{cc}
		\toprule%
		\textbf{original} & \textbf{dual}\\ \midrule
		$V_i$ & $I_v$ \\
		$I_i$ & $V_v$ \\
		$Z$ & $Y$ \\
		\bottomrule
	\end{tabular}
	\caption{Duality substitution rules for \acp{TLGF}.}
	\label{tab:tlgf_duality}
\end{table}








To illustrate the behavior of voltage and current on the equivalent
\ac{TM} transmission line of a Sommerfeld half-space an example is shown in
\cref{fig:tlgf_example}.

\begin{figure}
   \begin{tikzpicture}
    \pgfplotsset{small}
    \matrix {
        \begin{axis}[
            width = \textwidth,
            height = 0.22\textwidth,
            grid = major,
            xlabel = {$z / \lambda_0$},
            ylabel = {$V_i$ in Volt},
            xmin = -2,
            xmax = 4,
        ]
            \addplot [color = blue] table [x = z_by_lambda_0, y = V_re]
			{thesis_tlgf.dat};
            \addplot [color = red] table [x = z_by_lambda_0, y = V_im]
			{thesis_tlgf.dat};
        \end{axis}
        \\
        \begin{axis}[
            width = \textwidth,
            height = 0.22\textwidth,
            grid = major,
            xlabel = {$z / \lambda_0$},
            ylabel = {$I_i$ in Amp\`ere},
            xmin = -2,
            xmax = 4,
        ]
            \addplot [color = blue] table [x = z_by_lambda_0, y = I_re]
			{thesis_tlgf.dat};
            \addplot [color = red] table [x = z_by_lambda_0, y = I_im]
			{thesis_tlgf.dat};
        \end{axis}
        \\
        \begin{axis}[
            width = \textwidth,
            height = 0.22\textwidth,
            grid = major,
            xlabel = {$z / \lambda_0$},
            ylabel = {$Z / Z_0$},
            ytick = {-2, -1, 0, 1},
            xmin = -2,
            xmax = 4,
        ]
            \addplot [color = blue] table [x = z_by_lambda_0, y = Z_rel_re]
			{thesis_tlgf.dat};
            \addplot [color = red] table [x = z_by_lambda_0, y = Z_rel_im]
			{thesis_tlgf.dat};
        \end{axis}
        \\
        };
    \end{tikzpicture}
    \caption{Example case for \acp{TLGF}: the \ac{TM} lines are excited by
	a unit-strength current source at $z^\prime = \lambda_0$, the medium
	is a Sommerfeld non-magnetic half-space with lossy ground specified by
	$\epsr = \num{9.0} - \num{1.0}\im$.}
	\label{fig:tlgf_example}
\end{figure}



















Für die Definition der Greenschen Funktionen von \eqref{eq:tl_ode_system} gibt
es nun
\begin{itemize}
	\item die Möglichkeit
	\begin{subequations}\label{eq:tl_first_order_odes_i_source}
		\begin{align}
			\frac{\dd}{\dd z} V^{\isrc,\tx}\left(z\right)
			&= -\im k_z Z^\tx I^{\isrc,\tx}\left(z\right) \label{eq:tl_first_order_odes_i_source_homo}\\
			\frac{\dd}{\dd z} I^{\isrc,\tx}\left(z\right)
			&=-\im k_z Y^\tx V^{\isrc,\tx}\left(z\right) + \diracDelta\left(z-z^\prime\right)
		\end{align}
	\end{subequations}
	der Anregung mit einer impulsförmigen Einheitsstromquelle (oberer Index
	$\isrc$) bei $z^\prime$, sowie 
	\item den analogen Fall
	\begin{subequations}\label{eq:tl_first_order_odes_v_source}
		\begin{align}
			\frac{\dd}{\dd z} V^{\vsrc,\tx}\left(z\right)
			&= -\im k_z Z^\tx I^{\vsrc,\tx}\left(z\right) + \diracDelta\left(z-z^\prime\right) \\
			\frac{\dd}{\dd z} I^{\vsrc,\tx}\left(z\right)
			&=-\im k_z Y^\tx V^{\vsrc,\tx}\left(z\right) \label{eq:tl_first_order_odes_v_source_homo}
		\end{align}
	\end{subequations}
	 mit einer Spannungsquelle (oberer Index $\vsrc$) bei $z^\prime$ als
	 treibender Größe \cite{Michalski2016b}.
\end{itemize}
Aus den Systemen erster Ordnung \eqref{eq:tl_first_order_odes_i_source} und
\eqref{eq:tl_first_order_odes_v_source} lassen sich durch Differenziation der
einen und Einsetzen der jeweils anderen Gleichung die Gleichungen zweiter
Ordnung
\begin{equation}\label{eq:tl_2nd_order_ode_isrc}
	\left(\frac{\dd}{\dd z}
	\frac{1}{\im k_z Z^\tx}
	\frac{\dd}{\dd z} +
	\frac{k_z^2}{\im k_z Z^\tx}\right)
	V^{\isrc,\tx} =
	-\diracDelta\left(z-z^\prime\right)
\end{equation}
und
\begin{equation}\label{eq:tl_2nd_order_ode_vsrc}
	\left(\frac{\dd}{\dd z}
	\frac{1}{\im k_z Y^\tx}
	\frac{\dd}{\dd z} +
	\frac{k_z^2}{\im k_z Y^\tx}\right)
	I^{\vsrc,\tx} =
	-\diracDelta\left(z-z^\prime\right)
\end{equation}
gewinnen.
Durch Vergleich erkennt man die Dualität zwischen \eqref{eq:TE_ODE_GF} und
\eqref{eq:tl_2nd_order_ode_isrc} sowie \eqref{eq:TM_ODE_GF} und
\eqref{eq:tl_2nd_order_ode_isrc}.
Damit lassen sich die Lösungen von \eqref{eq:TE_ODE_GF} und \eqref{eq:TM_ODE_GF}
durch die wohlbekannten Greenschen Funktionen der Leitungsgleichungen ausdrücken.

So ergibt der Vergleich von \eqref{eq:TE_ODE_GF} mit
\eqref{eq:tl_2nd_order_ode_isrc} im TE-Fall
\begin{equation}\label{eq:G_tilde_TE_tl_quantities}
	\tilde{G}^\te \equiv \frac{1}{\im \omega} V^{\isrc,\te} \,
\end{equation}
der Vergleich von \eqref{eq:TM_ODE_GF} mit \eqref{eq:tl_2nd_order_ode_vsrc}
im TM-Fall liefert
\begin{equation}\label{eq:G_tilde_TM_tl_quantities}
	\tilde{G}^\tm \equiv \frac{1}{\im \omega} I^{\vsrc,\tm} \, .
\end{equation}

Aus der Leitungstheorie \cite{Pozar2011} sind wesentliche Aspekte der
Wellenausbreitung von Spannung und Stromstärke auf Leitungen, die durch
\eqref{eq:tl_ode_system_dI} und \eqref{eq:tl_ode_system_dV} beschrieben werden,
bekannt.
So sind beispielsweise Spannung und Strom außerhalb von Quellregionen---im
vorliegenden Kontext also für $z \neq z^\prime$---stetig.
Ein Vergleich von \eqref{eq:G_tilde_TE_tl_quantities} und
\eqref{eq:G_tilde_TM_tl_quantities} mit \eqref{eq:B_continuity} und
\eqref{eq:D_continuity} legt daher offen, dass die Lösung über die
Netzwerk-Methode bereits eine der an die Stetigkeit der charakteristischen
Feldkomponenten erfüllt.
Dass auch die Bedingungen \eqref{eq:H_z_tilde_second_continuity_condition} und
\eqref{eq:E_z_tilde_second_continuity_condition} automatisch erfüllt ist, lässt
sich durch Einsetzten der Lösung für $V^{\isrc,\te}$ in
\eqref{eq:tl_first_order_odes_i_source_homo} und jener für $I^{\vsrc,\tm}$ in
\eqref{eq:tl_first_order_odes_v_source_homo} erkennen.
Man erhält dadurch
\begin{equation}
	\frac{1}{\mu} \frac{\dd}{\dd z} \tilde{G}^\te \equiv - I^{\isrc,\te}
\end{equation}
sowie
\begin{equation}
	\frac{1}{\varepsilon} \frac{\dd}{\dd z} \tilde{G}^\tm \equiv - V^{\vsrc,\tm} \,,
\end{equation}
für $z \neq z^\prime$ sind also \eqref{eq:H_z_tilde_second_continuity_condition}
und \eqref{eq:E_z_tilde_second_continuity_condition} ebenfalls befriedigt.

Damit sind die Greenschen Funktionen der charakteristischen Komponenten
$\tilde{H}_z$ und $\tilde{E}_z$ von TE bzw.
TM-Feldern im $k_\rho$-Spektralbereich auf die in \cref{app:tl_greens_functions}
zusammengefassten bekannten Greenschen Funktionen für Spannung und Stromstärke
Übertragungsleitungen zurückgeführt.

\section{Image principle}
\label{sec:img_principle}

Scalar GF over PEC/PMC. \cite[p. 250]{Sommerfeld1964}






% \begin{figure}[htb]
% 	\centering
	
% 	% Define view angle
% 	\tdplotsetmaincoords{75}{120}
% 	\begin{tikzpicture}[tdplot_main_coords,scale=0.8]
		
% 		\begin{scope}[canvas is xy plane at z=0]
% 			\filldraw[fill=blue!30!white] (-5,-5) rectangle (5,5);
% 		\end{scope}
% 		\begin{scope}[canvas is yz plane at x=5]
% 			\filldraw[fill=blue!30!white] (5,0) rectangle (-5,-4);
% 		\end{scope}
% 		\begin{scope}[canvas is xz plane at y=5]
% 			\filldraw[fill=blue!30!white] (5,0) rectangle (-5,-4);
% 		\end{scope}
		
% 		% Draw cartesian coordinate system.
% 		\draw[thick,-latex] (0,0,0) -- (3.5,0,0) node[anchor=east]{$x$};
% 		\draw[thick,-latex] (0,0,0) -- (0,3.5,0) node[anchor=west]{$y$};
% 		\draw[thick,-latex] (0,0,0) -- (0,0,3.5) node[anchor=south]{$z$};
		
% 		% Draw observation point
% 		\pgfmathsetmacro{\rvec}{5}
% 		\pgfmathsetmacro{\thetavec}{40}
% 		\pgfmathsetmacro{\phivec}{150}
% 		\coordinate (O) at (0,0,0);
% 		\tdplotsetcoord{P}{\rvec}{\thetavec}{\phivec}
% 		\draw[-latex] (O) --node[anchor=east]{$r$} (P) node[anchor=west]{$\robs$};
% 		\draw[dashed] (O) --node[anchor=south]{$\rho$} (Pxy);
% 		\draw[dashed] (P) --node[anchor=west]{$z$} (Pxy);
% 		\tdplotdrawarc[-latex]{(O)}{1.2}{0}{\phivec}{anchor=north}{$\varphi$}
% 		\tdplotsetthetaplanecoords{\phivec}
% 		\tdplotdrawarc[tdplot_rotated_coords,-latex]{(0,0,0)}{1.2}{0}{\thetavec}{anchor=south}{$\vartheta$}
		
% 	\end{tikzpicture}
% 	\caption[Sommerfeld half-space]{Sommerfeld half-space problem with coordinate systems.}
% 	\label{fig:half_space}
% \end{figure}


\chapter{Numerical Computation of Sommerfeld Integrals}

\section{Numerical Integration}

\section{Discrete Complex Image Method}

\section{Asymptotic Methods}







\chapter{Fast Multipole Method for the Helmholtz Equation}

\section{Conventional Free-Space Approach}

The crucial idea of the \ac{FMM} is to write $\rdiff$ as a sum
\begin{equation}\label{eq:fmm_rdiff_parts}
	\rdiff =
	\left( \robs - \fmmObsGroupCenter              \right) +
	\left( \fmmObsGroupCenter - \fmmSrcGroupCenter \right) -
	\left( \rsrc - \fmmSrcGroupCenter              \right) \, ,
\end{equation}
of three vectors, where $\fmmSrcGroupCenter$ and $\fmmObsGroupCenter$ are the
centers of localized groups of source and observation points, respectively.
Based on \eqref{eq:fmm_rdiff_parts} the shorthand notations 
$\fmmDiffGroupCenters \coloneqq \fmmObsGroupCenter - \fmmSrcGroupCenter$
and 
$\pvec{d} \coloneqq \left( \robs - \fmmObsGroupCenter \right) - \left( \rsrc - \fmmSrcGroupCenter \right)$
are introduced.
The Green's function of the Helmholtz equation is then \emph{factorized} into
three terms which represent
\begin{enumerate}
	\item the \emph{aggregation} of a localized source distribution to the
	reference point $\fmmSrcGroupCenter$, 
	\item the \emph{translation} of the combined effect from
	$\fmmSrcGroupCenter$ to the reference point $\fmmObsGroupCenter$ of a
	localized and \enquote{far-away} groups of observation locations
	and finally
	\item the distribution or \emph{disaggregation} of the combined effect from
	$\fmmObsGroupCenter$ to the individual source points.
\end{enumerate}

The conventional \ac{FMM} for the free-space Green's function
of the Helmholtz equation \eqref{eq:scalar_free_space_gf} is based on two
elementary identities which, in the literature \cite{Rokhlin1993,Coifman1993},
are usually assumed to be given or are derived from more general formulas from
handbooks on mathematical functions \cite{Abramowitz2014,Abramowitz2014}.
The aim of the subsequent section is to approach these identities from
the perspective of electrodynamics to emphasize the underlying idea and to
illustrate why the methods carries the term multipole in its name.

As it is well-known, the Green's function of the Helmholtz equation
\eqref{eq:scalar_helmholtz_equation} is given by
\eqref{eq:scalar_helmholtz_equation}.
Clearly, $G_0\left(\robs, \rsrc\right)$ is a function of $r$ only for
$\rsrc = 0$ and its expression in spherical coordinates according to
\cref{def:sph_coords} is most trivial.
The expansion of $G_0\left(\robs, \rsrc\right)$ in terms of solutions of
\eqref{eq:scalar_helmholtz_equation} in spherical coordinates for the
off-centered case $\rsrc \neq 0$ is a classical result in electromagnetic
theory.
For $r > r^\prime$ this so-called \emph{multiple-expansion} is given by
\cite[492]{Jackson2013}
\begin{equation}\label{eq:multipole_expansion_jackson}
	\frac{\exp{-\im k \rdiffNorm}}{4\pi \rdiffNorm} = 
	-\im k \sum_{l = 0}^{\infty}
	\sphbesselj{l} \left(k r^\prime\right)
	\sphbesselh{2}{l} \left(k r\right)
	\sum_{m = -l}^{l}
	\complexConjugate{\operatorname{Y}}_{l m}
	\left( \vartheta^\prime, \varphi^\prime \right) 
	\operatorname{Y}_{l m}
	\left( \vartheta, \varphi\right)
	\qquad
	r > r^\prime
\end{equation}
where $\sphbesselj{l}$ and $\sphbesselh{2}{l}$ are the spherical Bessel and
second-kind spherical Hankel function of $l$-th order, respectively, and
$\operatorname{Y}_{l m}$ denotes the spherical harmonic of $l$-th degree and
$m$-th order.
The variables $\vartheta, \varphi$ and $\vartheta^\prime, \varphi^\prime$ are
the spherical angles of $\robs$ and $\rsrc$, respectively.
The multipole expansion \eqref{eq:multipole_expansion_jackson} is especially
useful if the field of a source distribution of local support within a
\enquote{small} domain is considered for \enquote{far-away} observation points
$\robs$.
For such a configuration the series over $l$ in
\eqref{eq:multipole_expansion_jackson} converges quickly and accurate
approximations can be obtained with relatively few terms.
In the electrostatic counterpart of \eqref{eq:multipole_expansion_jackson},~\ie,
the multipole expansion for the Poisson equation
(\eqref{eq:scalar_helmholtz_equation} for $k \to 0$) the series terms correspond
to the individual fields of a monopole, dipole, quadrupole,
and so forth, hence this kind of expansion is called multipole expansion.

Towards the form of \eqref{eq:multipole_expansion_jackson} which is used within
the \ac{FMM} it is useful to express the cosine of the angle enclosed by
$\robs$ and $\rsrc$ as
\begin{equation}\label{eq:cos_gamma_sph_coords}
	\uv{r} \cdot \uv{r}^\prime =
	\cos \left(\vartheta\right) \cos \vartheta^\prime +
	\sin \left(\vartheta\right) \sin \left(\vartheta^\prime\right)
	\cos \left(\varphi - \varphi^\prime\right)
	\, .
\end{equation}
With the addition theorem for the spherical harmonics
\cite[(14.30.9)]{Olver2010} and \eqref{eq:cos_gamma_sph_coords} the multipole
series \eqref{eq:multipole_expansion_jackson} can be written
as\footnote{A ground up derivation of \eqref{eq:multiple_expansion_fmm} is
shown in the textbook by \textcite[414]{Stratton2007}}
\begin{equation}\label{eq:multiple_expansion_fmm}
	\frac{\exp{-\im k \rdiffNorm}}{\rdiffNorm} =
	-\im k \sum\limits_{l=0}^{\infty}
	\left(2l + 1\right)
	\sphbesselj{l}    \left( k r^\prime \right)
	\sphbesselh{2}{l} \left( k r        \right)
	\legendrepl{l} \left( \uv{r} \cdot \uv{r^\prime} \right)
	\qquad
	r > r^\prime
	\, .
\end{equation}
The form \eqref{eq:multiple_expansion_fmm} is sometimes called \enquote{addition
theorem for spherical wave functions} \cite[362]{Jin2015} as it expands the
Green's function of the Helmholtz equation in terms of spherical waves for the
off-centered case $\rsrc$.

Now \eqref{eq:multiple_expansion_fmm} is almost the first major \ac{FMM}
identity, as by only flipping the sign of $\rsrc$ we obtain
\begin{lemma}[Gegenbauer's addition theorem]
	Let $\pvec{X}, \pvec{d} \in \R^3$ be two vectors with
	$d < X$ and assume $0 < k \in \R$.
	Then Gegenbauer's addition reads
	\begin{equation}\label{eq:fmm_std_gegenbauer}
		\frac{\exp{-\im k \norm{\pvec{X} + \pvec{d}}}}{\norm{\pvec{X} + \pvec{d}}} = 
		-\im k \sum\limits_{l=0}^{\infty}
		\left( -1 \right)^l
		\left( 2l + 1 \right) \,
		\sphbesselj{l} \left( k d  \right) \,
		\sphbesselh{2}{l} \left( k X \right) \, 
		\legendrepl{l} \left( \uv{X} \cdot  \uv{d} \right)
		\, .
	\end{equation}
\end{lemma} 
\begin{proof}
	By inspection of the respective left-hand sides of
	\eqref{eq:multiple_expansion_fmm} and
	\eqref{eq:fmm_std_gegenbauer} it is observed that $\robs = \pvec{X}$
	and $-\rsrc = \pvec{d}$.
	From the reflection formula of Legendre polynomials
	\cite[(14.7.17)]{Olver2010}
	\begin{equation}\label{eq:legendre_pol_reflection_formula}
		\legendrepl{l} \left( \uv{X} \cdot \uv{d} \right) =
		\legendrepl{l} \left( \uv{r} \cdot \left(-\uv{r}^\prime\right) \right) =
		\legendrepl{l} \left( -\uv{r} \cdot \uv{r}^\prime \right) =
		\left(-1\right)^l \legendrepl{l} \left( \uv{r} \cdot \uv{r}^\prime \right)
	\end{equation}
	it is known that $\legendrepl{l}$ is even (odd) for even (odd) degree $l$.
	As $\uv{X} \cdot \uv{d} = -\uv{r} \cdot \uv{r^\prime} $
	the factor $\left(-1\right)^l$ in \eqref{eq:fmm_std_gegenbauer} follows
	directly from \eqref{eq:legendre_pol_reflection_formula}.
\end{proof}

The second major identity towards \ac{FMM} expands the product 
$\sphbesselj{l} \left( k d \right) \legendrepl{l} \left( \uv{X} \cdot \uv{d} \right)$
into an integral of weighted propagating plane waves. For compact notation, it
is useful to introduce
\begin{definition}[Ewald spheren integration]\label{def:ewald_sphere}
	Let $\unitSphereSymbol$ denote the unit sphere in $\R^3$. Then
	integrals of the form
	\begin{equation}\label{eq:ewald_sphere_integral}
		\ewaldintegral f \left(\uv{k}\right) 
		\coloneqq
		\int\limits_{\varphi = 0}^{2\pi} \dd \varphi \, 
		\int\limits_{\vartheta = 0}^{\pi} \dd \vartheta  \, 
		\sin\left(\vartheta \right)
		f \left(\uv{k}\right)
		\, ,
	\end{equation}
	where
	\begin{equation}
		\uv{k} =
		\uv{x} \sin \left(\vartheta\right) \cos \varphi +
		\uv{y} \sin \left(\vartheta\right) \sin \varphi +
		\uv{z} \cos \vartheta \, ,
	\end{equation}
	are said to be an integration over the \emph{Ewald sphere} of propagating
	plane waves.
\end{definition}

\begin{lemma}[Plane wave expansion]
	Let $\pvec{X}, \pvec{d} \in \R^3$ be two vectors with
	$d < X$ and assume $0 < k \in \R$.
	Then we have \cite[410]{Stratton2007}
	\begin{equation}\label{eq:fmm_jP_expansion_plane_waves}
		\sphbesselj{l} \left( k d \right) \,
		\legendrepl{l} \left( \uv{X} \cdot \uv{d} \right) = 
		\frac{\im^l}{4\pi}	
		\ewaldintegral
		\exp{-\im \pvec{k} \cdot \pvec{d}}
		\legendrepl{l} \left( \uv{k} \cdot \uv{X} \right)
		\, .
	\end{equation}
\end{lemma}

Substituting \eqref{eq:fmm_jP_expansion_plane_waves} into
\eqref{eq:fmm_std_gegenbauer} yields
\begin{equation}\label{eq:fmm_before_interchange}
	\frac{\exp{-\im k \norm{\pvec{X} + \pvec{d}}}}{\norm{\pvec{X} + \pvec{d}}} = 
	\frac{-\im k}{4\pi}
	\sum\limits_{l=0}^{\infty}
	\left( -\im \right)^l
	\left( 2l + 1 \right) \,
	\sphbesselh{2}{l} \left( k X \right) 
	\ewaldintegral
	\exp{-\im \pvec{k} \cdot \pvec{d}}
	\legendrepl{l} \left( \uv{k} \cdot \uv{X} \right)
	\, .
\end{equation}
If the multipole expansion is truncated at finite $l$ summation and integration
in \eqref{eq:fmm_before_interchange} can be interchanged
\cite{Rokhlin1993,Coifman1993} to obtain
\begin{equation}\label{eq:fmm_std}
	\frac{\exp{-\im k \norm{\pvec{X} + \pvec{d}}}}{\norm{\pvec{X} + \pvec{d}}}
	\approx 
	\frac{-\im k}{4\pi}
	\ewaldintegral
	\exp{-\im \pvec{k} \cdot \pvec{d}} \,
	\mathcal{T}_L
	\left( \uv{k}, \pvec{X} \right)
	\, ,
\end{equation}
where the quantity
\begin{equation}
	\mathcal{T}_L
	\left( \uv{k}, \pvec{X} \right)
	\coloneqq
	\sum\limits_{l=0}^{L}
	\left( -\im \right)^l
	\left( 2l + 1 \right) \,
	\sphbesselh{2}{l} \left( k X \right) 
	\legendrepl{l} \left( \uv{k} \cdot \uv{X} \right)
	\, ,
\end{equation}
is called \emph{translation operator}.





