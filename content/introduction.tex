\chapter{Introduction}
\label{ch:introduction}






\section{Historical Background}

The references at the end of this document thematically are all part of a
thematic area which could be enveloped by
\emph{electromagnetic theory and practical field computation.}
The overall contribution of some of these publications to the area might be
considered marginal.
Some might be helpful towards an understanding or the actual solution of certain 
electromagnetic field problems \cite{Michalski2016b}.
Few are seminal \cite{Sommerfeld1909}.
One---without doubt---\emph{is} epochal
\cite{maxwell1873}\footnote{Maxwell's famous monograph \cite{maxwell1873} as
well as his original 1865 paper are nowadays under public domain license
and can be found at various locations online.}.

Although it is very unlikely these days that anybody will ever actually consider
the original set of twenty equations published by the great man himself in 1865
\cite{maxwell1865} when using the term
\enquote{Maxwell's equations}---it was to the Scottish mathematician and
physicist to first bring together the pieces of insight gained by other major
names during the early 19th century and to supplement the fragments to a theory
of utmost elegance and predictive power.

In defiance of the elegance and apparent simplicity of Maxwell's \emph{theory
of electricity and magnetism}, it turns out that the electromagnetic field
problem can only be solved analytically for a small set of canonical problems.
Even most of those highly idealized problems have motivated past generations to
apply or---in some cases---to develop at first sophisticated mathematical
formalisms \cite{Sommerfeld1964,Felsen1994}.
In modern times, however, advances in powerful digital computers enable the use
of numerical methods to solve the field problem for more real-world scenarios.
Some of those methods are able to achieve an accuracy down to machine precision,
at least in principle.
Although important numerical methods have been postulated and prescribed many
decades ago these techniques had to await practical applicability until
noteworthy computational power became available \cite{Harrington1993}.

A particularly pleasant circumstance, however, is that many ancestral
analytical efforts have by no means become obsolete in the advent of
\ac{CE}.
In fact, some of these methods were the central motivation in the development of 
the most powerful numerical techniques.
The example which is subject to this thesis is the use of fundamental
solutions---so-called Green's functions---in integral equation technique within
the framework of the \ac{MoM} \cite{Harrington1993}.








\section{The Sommerfeld Half-Space Problem and Multilayered Media}

An outstanding example both for the use of advanced analytical techniques in
electromagnetic theory and for utilization of so obtained results in numerical
techniques is the Green's function of the Sommerfeld half-space problem.

The rigorous mathematical treatment of the problem of dipole radiation over
plane lossy dielectric ground has its roots in a seminal publication by
Arnold Sommerfeld in the early days of antennas and wave propagation
\cite{Sommerfeld1909}.
Later, the central equation on which Sommerfeld's approach is built
\cite[eq.~(9),~p.~683]{Sommerfeld1909} became known as Sommerfeld
identity.
It expands a spherical scalar wave into a continuous spectrum of products
of cylindrical waves (in radial direction) with propagating and evanescent
plane waves (in vertical direction).
Another way to think about the Sommerfeld identity is to interpret it
as a two-dimensional Fourier transform with respect to the radial coordinate.
This view is sometimes---after a paper by Hermann Weyl \cite{Weyl1919}---called
Weyl identity \cite[65]{Chew1999}.
However, as the half-space Green's function problem is of azimuthal symmetry,
the two Fourier integrals are not independent.
Hence, the integral transform can be simplified to the so-called Hankel
transform representation---which involves only integration with respect to a
single variable.
It turns out that what mathematicians call inverse Hankel transform is
precisely the kind of integral transform used by Sommerfeld.
In recognition of Sommerfeld's work, inverse Hankel transforms are, thus,
almost exclusively referred to as Sommerfeld integrals within the
context of electromagnetic theory \cite{Mosig2021}.

Using his identity, Sommerfeld first considered a vertically oriented
\ac{HD}, \ie, an infinitesimally small vertical current element, which resides
at the interface separating an upper half-space filled with air from the lower
ground half-space of lossy dielectric properties\footnote{
This setup is frequently referred to as \ac{VED} nowadays, while a \ac{HD}
oriented in parallel to the interface is called \ac{HED}.
}.
He mathematically verified the existence of a special kind of surface
wave which was postulated earlier by \textcite{Zenneck1907} and examined how the
separate constituents of the total wave field correspond to mathematical
properties of the spectral integrand in the underlying formalism.
Namely, this spectral domain function has two branch points and respective
branch cuts as well a pole in case of the \ac{VED}.
Apart from these features, the integrand is holomorphic on
the complex plane onto which the spectral integration variable can be
analytically continued.
Noting this enables application of major results from complex analysis such as
Cauchy's theorem, Jordan's lemma and the residue theorem.
Furthermore, a broad set o asymptotic methods for Sommerfeld integrals has been
developed or adapted to this use case \cite[\S2.5]{Chew1999}.

By virtuous application of these tools, Sommerfeld identified the branch points
corresponding to the wavenumbers of air and ground as the driving force behind
radiating wave constituents (\enquote{Raumwellen}) while to the contribution
of the later so-called Sommerfeld pole \cite{Michalski2016b} manifests itself
in Zenneck's surface wave.
Due to the applicability of such a broad set of mathematical tools, Sommerfeld
regarded the subject as especially appealing for educational purposes and
granted it significant space in his later famous monograph
\cite{Sommerfeld1964}.
Later, he elaborated more on the subject \cite{Sommerfeld1926},
generalizing the formalism to the \ac{HED} case and to a situation where the
dipole may be located \emph{above} and not \emph{at} the interface.
This also slightly simplifies the mathematical discussion.
An essentially minor but nevertheless controversially discussed
\cite{Wait1998,Michalski2016b} sign error in the original paper was fixed at
least with the 1926 publication \cite{Sommerfeld1926} which carries the same
title as the one from 1909.

Later, Sommerfeld's formalism was extended by others to ground half-spaces
consisting of more than one layer \cite{Felsen1994,Wait1998} as well as to
solution domains with Dirichlet or Impedance boundary condition on one or both
sides \cite{Michalski1990}.
The latter case enabled the use of the method in the analysis of printed
antennas and planar microwave circuits \cite{Hsu1993,Ho1994}.
Further applications of Sommerfeld integrals can be found in the study of ground
penetrating radar \cite{cross2015} and even in plasmonics \cite{nevels2014}.

While Sommerfeld originally worked with a potential formulation which is rarely
used nowadays, Green's functions for all field components of
arbitrarily oriented dipoles have been derived in the following decades 
\cite{Michalski2005}.
As these dyadic Green's functions exhibit strong singularities both in 
spectral and spatial domain, it has become common to use potential formulations
in most numerical techniques based on integral equations.
These are less singular, yet exhibit some certain arbitrariness in formulation 
as the used vector and scalar potentials are not unique
\cite{Michalski1990,Michalski1990a,Eibert1997,Michalski1997}.

In the broad variety of practical applications certainly lies the reason why
Sommerfeld's century-old and originally purely analytical considerations not
only are rewarded as pioneering but still are subject of active research to
this day.
This seems rather astonishing for a subject whose origins have become a textbook
subject yet decades ago \cite{Michalski2015, Michalski2016b, Mosig2021,koh2021}.








\section{Numerical Evaluation of Sommerfeld Integrals}

From a fundamentalist physicist's point of view the problem of dipole radiation
over ground or in plane stratified media is exhaustively studied by writing
down the solution in terms of Sommerfeld integrals.
However, a multitude of contributions continuous to be published to this very
day which addresses the problem \emph{how} to actually evaluate these integrals.
Closed form solutions are not known to exist for virtually any case of practical
interest.
Methods which proved useful in the numerical evaluation of Sommerfeld integrals
in computational practice can roughly be classified to belong to one of the 
approaches sketched in the following subsections.





\subsection{Numerical Integration}
Numerical integration to date is considered as the most rigorous way to evaluate
Sommerfeld integrals, yet in most cases it is also the computationally most
expensive way to do so.
In principle, all tools from complex analysis which may be used in
analytical considerations can also be implemented in numerical algorithms.
Especially Cauchy's theorem proofs valuable here, as the original
\ac{SIP} can be readily continued analytically onto the complex plane.

The most straightforward numerical integration scheme might be built directly
onto the \ac{SIP}, \ie, integrate along the non-negative real axis of the
spectral integration variable.
As it turns out, the integrand may exhibit singularities near the 
real axis for certain geometries, whose real parts, however are known to lie
inside a finite-width strip parallel to the imaginary axis.
Therefore, the semi-infinite \ac{SIP} is commonly split up into a finite
sub-interval starting at zero and containing all singularities and a
semi-infinite \emph{tail} region in which the integrand function is well-behaved
but possibly oscillatory and slowly converging
\cite{mosig1982,Michalski1998,Michalski2016a}.
For this latter region the term \emph{Sommerfeld tail} is indeed established in
the literature.

\subsubsection{Finite Sub-Interval}

To deal with the singularities in this finite sub-interval of the
semi-infinite \ac{SIP}, mainly two major approaches are studied in the
literature.
\begin{itemize}
	\item In case only the quadrants of the complex plane in which the integrand
	singularities lie are known, the real axis path can be detoured into a 
	quadrant free of singularities. The suitable quadrant depends on the
	chosen time convention, yet it is known that the integrand function is
	well-behaved if the detour path is chosen appropriately.
	This technique essentially employs a corollary to Cauchy's theorem which
	stated that the result of a path integral is independent of a specific path
	as long as the path does not \enquote{capture} any singularities during the
	process of detour.
	In numerical practice, the specific choice of detour path is not critical
	either.
	Common choices are a rooftop contour \cite{Michalski2015a} or an
	elliptical \cite{GayBalmaz1997} path.
	The choice of quadrature rule on the detour path is not critical either, yet
	it is observed that the use of an adaptive rule providing error estimates
	is advisable \cite{Michalski2016a}.
	\item If branch points (straightforward) and poles (potentially expensive
	in the multilayer case) can be localized in the complex plane the
	integration path can be split up into further sub-intervals in between the
	singularities.
	The sub-interval integrals are then integrated along the real axis using 
	quadrature methods with allow the integration of function with endpoint
	singularities.
	Suitable quadrature rules are the Gauss-Jacobi quadrature \cite{press2007}
	and especially the  $\tanh$-$\sinh$ \ac{DE} rule
	\cite{takahasi1973,golubovicniciforovic2011,Michalski2016a}.
\end{itemize}






\subsubsection{Sommerfeld Tail}

The semi-infinite Sommerfeld tail is typically considered much more challenging
as the finite sub-intervals containing singularities.
This comes from the fact that the integrand function is modulated by
oscillations of a first-kind Bessel function in the case of close vertical
proximity of the source point and the location at which the Green's function
is observed.
Furthermore, the frequency of these oscillations rises with increasing lateral 
distance between source and observation point.
In case of zero lateral offset the oscillations vanish and the integrand
is dominated by exponential decal for large values of the integration variable.
The latter case is, however, rarely in the focus of interest which is why
it has been said that \enquote{evaluating Sommerfeld integrals used to be a
standard nightmare for many electromagnetic engineers due to the singular,
oscillating and divergent behavior of their integrands} \cite{jimenez1996}.


In fact, it is observed that naive application of standard quadrature rules to
Sommerfeld tails may either fail entirely or is at least prohibitively
expensive.
Thus, several methods have been developed to accelerate convergence of this 
integration.
The most extensively studied methods can be summarized under the term 
\ac{PE} methods \cite{Michalski1998}.
The notion of all of these techniques is to split up the semi-infinte integral
into finite-length sub-interval integrals and to evaluate these using standard
low-order quadrature rules.
Then a suitable series extrapolation algorithm \cite{brezinski2013} is applied
to the so-obtained sequence of values.
Regarding extrapolation methods, two main categories can be distinguished.
The first category uses numerical reminder estimates obtained directly from
the sequence of partial integral values.
The second approach utilizes analytically known asymptotic properties of the 
integrand function.

\Ac{PE} algorithms for Sommerfeld integral tails have been extensively studied
over the last almost four decades
\cite{Michalski1998,Mosig2012,mosig2013,Michalski2016a,Golubovic2012},
by which two schemes have turned out most appropriate in the evaluation of
integrals arising in Green's functions in plane stratified media\footnote{Note
that the cited publication almost exclusively consider Green's functions
for potentials. It is demonstrated, however, at least through the results given in
\cref{ch:numerical_results} of the present thesis that these methods are also
applicable to Green's functions for the fields.}.
\begin{description}
	\item[Levin-Sidi \ac{PE} scheme] This scheme uses numerical reminder
	estimates and requires no information about the asymptotic behavior of the 
	integrand function.
	The name comes from the used extrapolation method, namely the generalized 
	Levin transformation \cite{Levin1972}, where several variants of this 
	method exist \cite{Michalski2016a}.
	\item[Mosig-Michalski \ac{PE} scheme] Here two parameters are involved to
	estimate the exponential decay of the integrand and the power of the
	occurrence of the integration variable in the integrand's denominator,
	respectively.
	These parameters have to be obtained by analytical asymptotic analysis of 
	the integrand function.
	This \ac{PE} scheme is termed after the variant of the weighted-averages
	method by Mosig and Michalski \cite{mosig1983,Michalski1998,Michalski2016a}.
\end{description}

Yet another proposal of an extrapolation method is the \ac{MPM}.
The idea here is to apply a straightforward function fitting routine to the
spectral integrand of a Sommerfeld integral.
The fitting is done by a series of elementary exponential functions which can
be integrated in closed for, hence the Sommerfeld tail is approximated by a
sum of so-obtained terms directly in the spatial domain \cite{MengtaoYuan2006a}.
This method has, however, not found widespread application as the results
deteriorate for larger lateral distances between source and observation point.
For near range approximation, in turn, the method has been successfully been
tested, also in the course of the present thesis, where its computational
performance is superior to the more sophisticated \ac{PE} methods described in
the above discussion.




\subsubsection{Limitations of \acs{SIP} integration}

Although numerical integration algorithms incorporating \ac{PE} schemes provide
an effective yet accurate methodology for the evaluation of Sommerfeld integrals
the \ac{SIP}-approach still has downsides.
The problem lies, again, in the rapid oscillations of the integrand function
for large lateral observation distances.
With \ac{PE}, it is now not the tail which renders \ac{SIP} expensive but the
high-frequently modulation in the finite sub-integral containing
the integrand singularities.
For large lateral observation distances, exceeding a couple of hundreds of
wavelengths, the requirement for extremely narrow sampling arises in
the adaptive quadrature applied to this part of the integral.
Therefore, for large lateral distances numerical integration along the \ac{SIP} 
becomes again prohibitive, even if most effective \ac{PE} schemes are used
\cite[14]{Michalski2016b}.






\subsubsection{Path Deformation}

As discussed in the preceding point, numerical integration along the \ac{SIP}
suffers from fundamental problems or at least from difficulties unresolved to
date.
For large lateral observation distances one can, however, resort to other
integration paths, whose common property is \emph{massive} path deformation.
Compared to those methods the discussed path detour aiming avoid singularities
near or on the \ac{SIP} is just a mere detail.
In contrast to this, methods tailored towards large lateral observation
distances usually follow a different notion.
The aim of such methods is to make the full power of complex analysis available
by deforming the path of integration in a way that it either wraps around
certain appropriately defined branch cuts \cite{Michalski2016a} or even becomes
the \ac{SDP} \cite{Michalski1987,TieJunCui1999,wu2008,hochman2010}.
Combinations might also be possible \cite{Michalski1985a}.

Even though an infinite number of possibilities exists to define such methods,
they always aim to perform numerical integration along paths on which the
integrand decays rapidly.
This approach, however, also suffers from weaknesses.
First, such methods generally not applicable for zero lateral observation
distance and, hence, cannot provide a general purpose algorithm on their own
\cite{Michalski2016a}.
Furthermore, all the referenced methods depend on the geometry of the 
solution domain.
For example the \ac{SDP} is only known analytically for the case of two
semi-infinte half spaces \cite[\S2.5.2]{Chew1999}.
The same applies for the locations of poles in the complex plane.
The only cases in which the location of these poles is known is again
the Sommerfeld case, and even here this only holds for a ground half-space of
either dielectric \emph{or} magnetic properties \cite{Michalski2016b}.
In the case of general multilayered media the locations of poles have to be
determined by numerical searching algorithms \cite{rodriguez-berral2004}
which can, again, be expensive.

In contrast to the case of near and medium lateral observation distances,
no clear consent can be observed in the literature regarding the question of
which numerical integration technique is best for large lateral distances.










\section{Complex Image Principle}

The notion of enforcing boundary conditions in electrostatic problems
involving conducting bodies by replacement of the bodies by certain
\emph{image charges} is known for a long time \cite[pp.~69]{Jackson2013}.
In fact, the idea can be traced back all the way through the history of
classical electrodynamics right to Maxwell himself
\cite[Chapter~XI]{maxwell1873}.
This so-called image principle is also available in an exact form for the
case of time-harmonic currents radiating above a \ac{PEC} half-space
\cite[243]{Sommerfeld1964}\cite[pp.~94]{Jin2015}.
For the case of dielectric or finite-loss ground, however, no such simple and
elegant principle is available.
Clearly inspired by the \ac{PEC} image principle, several attempts have been
made to establish a similar concept for the dielectric case.

Noteworthy is, once again, \textcite[250]{Sommerfeld1964}, who used a single
symmetric real image source plus an \enquote{imaginary continuous converging
ray} to obtain an approximate representation of the ground-reflected
contribution in the half-space Green's function of the \ac{VED} Hertz potential.

In the 1980s, Lindell and Alanen developed the \ac{EIT} 
\cite{Lindell1984,Lindell1984a,Lindell1984b}, both for \ac{VED} and \ac{HED}.
The method claims just what its name suggests.
The idea is, in principle, similar to Sommerfeld's imaginary ray in the sense
that the \ac{EIT} also assumes a continuous image current flowing in complex
space.
Thus, the \ac{EIT} is no means to evaluate Sommerfeld integrals in closed
form---like the \ac{PEC} image principle allows to---but essentially
replaces one integral by another, where it is claimed that the complex-space
current shows better convergence.
Although the \ac{EIT} might provide some theoretical insights, the concept
has not found widespread use in the field of half-space and multilayered medium 
Green's functions, not even after it was published in textbook form
\cite{Lindell2000}.

By contrast to the \emph{continuous} image constructions of Sommerfeld and the
\ac{EIT} the \ac{DCIM} aims to represent the reflected contribution to
multilayered media Green's functions solely by means a small set
of \emph{discrete}, \ie, point-like image source points.
Similar to the continuous methods, these points are assumed to reside 
at complex spatial positions.
Technically, the \ac{DCIM} approximates the spectral integrand of a Sommerfeld
integral by a series of exponential functions.
Each term of this series can then be integrated in closed form---where it is
tacitly assumed that the Sommerfeld identity remains valid for complex spatial
coordinates.

A paper by \textcite{Fang1988} is typically considered to be the first
publication towards the \ac{DCIM}.
This original method, however, suffered from several issues regarding the
geometrical range of validity and the reliability of the used function fitting
algorithm.
As a solution to the range problem it was proposed to use the actual \ac{DCIM}
only up to a certain lateral observation distance and to resort to
the contributions of the pole residues for larger distances.
This approach became known as the \enquote{relay race} method.
As it turned out in the following \cite{Chow1991,Yang1991,Yang1992,Aksun1992},
the accuracy of the \ac{DCIM} is significantly in creased if the poles
(termed \acp{SWP} in the following) as well as the so-called quasistatic terms
for large values of the integration variable are extracted from the spectral
integrand prior to application of the \ac{DCIM}.
A first major breakthrough was achieved with the introduction of the so-called
two-level algorithm and by the replacement of the original fitting algorithm
by the \ac{GPOF} \cite{Dural1995,Aksun1995,Aksun1996,Hua1989,Sarkar1995}.
The two-level approximation liberated the method of the need to extract 
quasistatic terms as the second sampling level is claimed to account for
the integral tail appropriately \cite{IrsadiAksun2003,Aksun2005}.
However, the two-level \ac{DCIM} still suffered from a range of validity
limited to just a few wavelengths.
This limitation restricted application of the \ac{DCIM} to electrically small
structures.

In the 2000s, a renaissance of research interest in the \ac{DCIM} can be 
observed \cite{Aksun2009}.
A major breakthrough in terms of lateral range of validity was achieved
by introduction of several variants of a three-level sampling scheme
\cite{Michalski2007a}.
The claim is that the splitting of the part of the sampling path in the
two-level algorithm which is used to sample the region containing the
integrand's singularities into two parts allows to properly capture the effect
of one of the branch points.
A paper by \textcite{Alparslan2010} finally refines the three-level scheme and
eventually aims to prove the central assumption on which the whole concept of
the \ac{DCIM} is built: all wave constituents in multilayered media Green's
functions can be represented by linear superposition of spherical
waves\footnote{
	Within this context it is not mentioned that the scalar Green's function of 
	free space looses its spherical symmetry if evaluated for source points in 
	complex space.
}.
With the three-level algorithm the range of lateral validity is extended 
up to several hundreds of wavelengths, as demonstrated by the paper.

Apart from the long-term issues with concerning the range of validity of the 
approximation, the \ac{DCIM} historically struggled with another major
sketchiness regarding the reliability of the method.
It took until 2011 \cite{Karabulut2011,Karabulut2011b} till serious attempts
were made to give an error criterion for the Green's function in the
spatial domain.
With that, one more of the long-time issues of the \ac{DCIM} seems to be
resolved.

Another critical point within the \ac{DCIM} is the selection of the model order,
\ie, of the number of exponential function by which to approximate the
integrand of a Sommerfeld integral.
Traditionally, this was done directly within the \ac{GPOF} method, most
frequently based on the rate of decrease of the singular values obtained by
the singular value decomposition of a special matrix.
There is, however, no formal proof that this methodology justifiable from a
mathematical point of view.
A paper by \textcite{Karabulut2011a} can be considered as a first step
towards that direction.

Finally, a paper by \textcite{Chen2011} shall not remain unmentioned.
Here, the \ac{DCIM} sampling path is chosen as the \ac{SDP}, both for the case
of a medium shielded on one side and for the half-space case.
As the idea is essentially the same as for the corresponding numerical
integration methods, this version of the \ac{DCIM} is especially well-suited
for far-field computations.







\section{Fast Integral Equation Techniques}

\cite{Harrington1993}

Integral equations arising from boundary value problems in \ac{CE} can be
discretized by subdomain basis functions, \eg, the popular \ac{RWG} functions
\cite{Rao1982}.

Direct solver: $N^3$
Iterative solver: $N^2$

\subsection{Motivation}

Due to the global nature of the involved Green's functions the discretization
of \ac{MoM}-based discretization of integral equations lead to a dense \ac{LSE}.
These systems are most commonly solved using iterative solvers in which the
system matrix is applied to a several, recursively generated, excitation
vectors until the solution has converged to the desired accuracy.
Popular examples for iterative solvers are multiple versions of the \ac{CG}
or the \ac{GMRES} \cite{Strang2010}.

If now, in a Galerkin-type \ac{MoM} scheme, $N$ denotes the number of expansion
and testing functions, each single matrix-vector multiplication exhibits a
complexity of $\landau{N^2}$ in terms of operations as well as in terms of
memory. Since this becomes prohibitive for large $N$ as occurring in
field computations of many real-world problems, an extensive set of fast
algorithms has been developed which all aim to accelerate matrix-vector
multiplication \cite[chapter 11]{Jin2015}.

One such fast method is the \ac{FMM} and, as an extension of the latter, the
\ac{MLFMA}. In principle these algorithms are capable to reduce the complexity
to $\landau{N^{3/2}}$ and even $\landau{N \log N}$, respectively.
As opposed to some other fast algorithms, the \ac{FMM} is problem
specific. 
Nevertheless, 2D \cite{Rokhlin1990} and 3D \cite{Rokhlin1993, Coifman1993}
versions of the \ac{FMM} have been developed for the major equation in
full-wave \ac{CE}, the Helmholtz equation.
Today the use of the \ac{MLFMA} is state of the art in the treatment of
large-scale problems with integral equation techniques\footnote{Interestingly,
in the early days of the \ac{FMM} even its creators assumed that it would not be
beneficial to improve the method to a $\landau{N \log N}$ algorithm by
applying the scheme recursively several times. The reason is they assumed
\enquote{problems of practicable size} to be not larger than
$N \le \num{1000000}$ \cite{Rokhlin1993}.}
The involved algorithms, data structures and the choice of important
parameters have been extensively studied and  are well-documented
\cite{Chew2001}.

\subsection{Principle}

The starting point in the development of the \ac{FMM} is the Green's function
of free space.
The core idea, interpreted in terms of electrodynamics, is as follows.
In order to solve the field problem for a general distribution of $N$ sources
of radiation --- we may assume $N$ \acp{HD} radiating into free space ---
one has to evaluate the corresponding Green's function $N^2$ times.
This is due to the interaction of every \ac{HD} with every other one.
If now the \acp{HD} are not distributed equally in space but somewhat are
\emph{clustered} the idea of a multipole expansion 
\cite[9.7]{Jackson2013} \cite[7.10]{vanBladel2007} comes into place.
The claim is that in a cluster of \acp{HD} each individual \ac{HD} will not
\enquote{see} every single \ac{HD} in a cluster of \acp{HD} which is far away.
Instead, it will be sufficient to consider only bigger entities, namely the
whole clusters, in terms of far interaction while the near interactions
between individual \acp{HD} need to be considered only within the clusters.
Concisely formulated the \ac{FMM} consists of the following three steps. 
\begin{enumerate}
	\item The effects of all individual \acp{HD} within a cluster of sources
	are \emph{aggregated} to a common center within the respective group. 
	\item The aggregated effect is \emph{translated} to the common reference
	point of a far-away group of, likewise clustered, observing \acp{HD}.
	\item Within the group of observing \acp{HD} the translated quantity is
	redistributed or \emph{disaggregated} to all individual receiving \acp{HD}.
\end{enumerate}

These steps somewhat correspond to a factorization of the Green's function
into a product of three factors.

The same principle sketched here for point-like sources can easily be extended
to arbitrary basis and testing functions within the \ac{MoM} by invoking
the linearity of Maxwell's equations and the superposition principle.

Since the described approach only works for far-interactions of properly
clustered groups of \acp{HD} or --- more general --- subdomain basis functions 
of local support, all the possible near-interactions need to be treated
separately.
This can be done applying the conventional \ac{MoM} approach to compute all
nearby interactions.
The effect here is, that the \ac{FMM} removes all entries in the system matrix
which would not be centered around its diagonal within the standard \ac{MoM}.
The result is a sparse and banded matrix, similar to those resulting from
techniques based on differential equations, such as the \ac{FEM} or certain
forms of \acp{FDM}.
This resulting sparse matrix is then much easier to treat than the corresponding
full \ac{MoM} matrix. At the same time the obtained algorithm benefits from the
reduced number of unknowns as compared to differential equation techniques.

\subsection{Extension to Source Points in Complex Space}

The use of complex vectors \cite[Chapter 1]{Lindell2000} is omnipresent within
the study of time-harmonic electromagnetic fields.
However, vectors in $\C^3$ are usually \emph{electromagnetic} quantities like
vector potentials and the fields themselves.
In contrast, (arbitrary) complex spatial coordinates are rather uncommon so
far\footnote{Counterexamples are found, \eg, within the context of Lorentz
transforms between moving frames of reference, where angles of rotation may be
imaginary \cite[Chapter~11]{Jackson2013}.}.
An example use case in which the concept of complex space plays a prominent role
is given in a paper by \textcite{Hansen2009}, where a new perspective on the
classical Huygens principle based on complex source locations is presented. 

It is well-known that if the Green's function of the scalar Helmholtz equation
for the free-space case describes a spherical wave for the usual case where
the distance between source and observation point is a real number.
This pattern changes if this distance is complex.
In this case the magnitude of the wave field becomes dependent on direction.
This kind of wave field is commonly called Gaussian beam or \ac{CSB}.
Albeit the concept of \emph{complex space} is somewhat abstract
\cite[Chapter~1]{Lindell2000}, an intuitive and commonly employed definition of
\emph{complex length} is, that such a quantity should have a positive real part
\cite{Hansen2009, Hansen2013}.

Concerning the combination of the \ac{FMM} with sources situated in complex
space, it appears obvious that this kind of application was not what the
creators originally had in mind.
The popular review paper by \textcite{Coifman1993}, for example, does not make
any indications towards this direction.
Interestingly enough, in the mathematically rigorous treatment of the 3D
\ac{FMM} for the Helmholtz equation \cite{Rokhlin1993}, the essential
Theorem~2.2 is formulated in terms of complex spatial coordinates and even
complex angles.
However, these assumptions are dropped as early in the following as in
Theorem~2.3, whose requirements assume real spatial quantities and leave only
the wavenumber in the complex domain.
The same assumptions underlie the mathematically oriented publication Concerning
the 2D \ac{FMM} \cite{Rokhlin1990}.

From these observations it appears obvious, that the \ac{FMM} development
made no efforts towards an applicability to sources (or observation points)
situated in whatever form of complex space.
Actually in most cases of application even the wavenumber is simply the one of
free space and is therefore real quantity.

Nevertheless, a combination of the concept of \acp{CSB} with the \ac{FMM} can
provide benefits.
Employing some earlier results \cite{Hansen2009}, it was shown by
\textcite{Hansen2013}, that the introduction of a well-defined
\emph{imaginary shift} applied to the basis functions in a \ac{FMM} setup
results in a modified \ac{FMM} translation operator which shows a significantly
directive pattern.
This so-called Gaussian translation operator allows to neglect some plane wave
directions involved in the expansion throughout the translation step
and therefore renders the resulting algorithm computationally more effective
than a \ac{FMM} using the standard translation operator.

It should be noted that the requirements in the derivation of the Gaussian
translation operator and also the corresponding proof 
\cite[Appendix]{Hansen2013} do not assume general source points located in
complex space defined in a sense that all three spatial coordinates might
be arbitrary complex numbers.
The imaginary part of the source position vector is instead selected by a given
intention regarding the sharpness of the resulting \ac{CSB}.
Consequently, the parameter controlling the imaginary shift of source points
is labeled \emph{beam parameter} by the author.

\fxnote{\cite{Borries2014}}
\fxnote{\cite{eibert2021}}

In the course of the literature research for this thesis no thoroughly and 
mathematically rigorous treatment was found concerning the combination
of the \ac{FMM} principle with actual complex source points located at
\emph{arbitrary} \enquote{positions} in a complex version of Euclidean space.

However, there are records of some attempts to do so using a standard \ac{FMM}
implementation and without the aim of extending the underlying theorems and
proofs \cite{Rokhlin1993}.
A rather heuristic discussion of this topic is given in a paper by
\textcite{Geng2001}.
It is empirically shown that the use of complex source points drastically
deteriorates the convergence of the central addition theorem on which the
\ac{FMM} is based.
The number of terms in the corresponding series expansion is closely
related to the number of quadrature points required to numerically integrate
the plane-wave expansion --- the second main identity within the
\ac{FMM}.
For this reason the authors did not pursue the approach of using complex images
further and instead directed their attention to approximate forms of the
Green's function using a single real image source for all far interaction
computed using the \ac{FMM} \cite{Geng1999, Geng2000}.

\subsection{Adaption to Half-Space Green's Functions}

\cite{Geng2000}
\cite{Liu2002}
\cite{Eibert2018}
\cite{Eibert2018a}
\cite{Eibert2019}
\cite[Chapter~8.13.2]{parini2020}


\section{Scope of this Thesis}
\label{sec:scope_of_this_thesis}

The particular problem motivating this thesis is to find a combination of
different numerical methods which are all based on analytical results.
These are, namely, the Green's function of the so-called Sommerfeld half-space
problem and a fast algorithm which is state of the art in large-scale \ac{MoM}
solvers, the \ac{FMM}.
To this end a generalized version of the classical image source principle is
examined towards its compatibility with the \ac{FMM}.
For reference computation of the improper integrals used to represent the
half-space Green's functions sophisticated numerical algorithms are implemented.
